{"version":3,"file":"jet.js","sources":["../../sources/errors.ts","../../sources/JetBase.ts","../../sources/helpers.ts","../../sources/Route.ts","../../sources/JetView.ts","../../sources/JetViewRaw.ts","../../sources/routers/SubRouter.ts","../../sources/JetAppBase.ts","../../sources/routers/HashRouter.ts","../../sources/patch.ts","../../sources/JetApp.ts","../../sources/routers/StoreRouter.ts","../../sources/routers/UrlRouter.ts","../../sources/routers/EmptyRouter.ts","../../sources/plugins/Guard.ts","../../node_modules/webix-polyglot/index.js","../../sources/plugins/Locale.ts","../../sources/plugins/Menu.ts","../../sources/plugins/Status.ts","../../sources/plugins/Theme.ts","../../sources/plugins/UrlParam.ts","../../sources/plugins/User.ts","../../sources/index.ts"],"sourcesContent":["export class NavigationBlocked {}","import { IBaseView, IJetApp, IJetURL, IJetView,\n\tIRoute, ISubView, ISubViewInfo, IWebixFacade, IHash } from \"./interfaces\";\n\nexport abstract class JetBase implements IJetView{\n\tpublic app: IJetApp;\n\tpublic webix: IWebixFacade;\n\tpublic webixJet = true;\n\n\tprotected _name: string;\n\tprotected _parent: IJetView;\n\tprotected _container: HTMLElement | ISubView;\n\tprotected _root: IBaseView;\n\tprotected _events:{ id:string, obj: any }[];\n\tprotected _subs:{[name:string]:ISubView};\n\tprotected _initUrl:IJetURL;\n\tprotected _segment: IRoute;\n\n\tprivate _data:{[name:string]:any};\n\t\n\n\tconstructor(webix:IWebixFacade, config?:any){\n\t\tthis.webix = webix;\n\t\tthis._events = [];\n\t\tthis._subs = {};\n\t\tthis._data = {};\n\n\t\tif (config && config.params) \n\t\t\twebix.extend(this._data, config.params);\n\t}\n\n\tgetRoot(): IBaseView {\n\t\treturn this._root;\n\t}\n\n\tdestructor() {\n\t\tthis._detachEvents();\n\t\tthis._destroySubs();\n\t\tthis._events = this._container = this.app = this._parent = this._root = null;\n\t}\n\tsetParam(id:string, value:any, url?:boolean):void|Promise<any>{\n\t\tif (this._data[id] !== value){\n\t\t\tthis._data[id] = value;\n\t\t\tthis._segment.update(id, value, 0);\n\t\t\tif (url){\n\t\t\t\treturn this.show(null);\n\t\t\t}\n\t\t}\n\t}\n\tgetParam(id:string, parent:boolean):any{\n\t\tconst value = this._data[id];\n\t\tif (typeof value !== \"undefined\" || !parent){\n\t\t\treturn value;\n\t\t}\n\n\t\tconst view = this.getParentView();\n\t\tif (view){\n\t\t\treturn view.getParam(id, parent);\n\t\t}\n\t}\n\tgetUrl():IJetURL{\n\t\treturn this._segment.suburl();\n\t}\n\tgetUrlString():string{\n\t\treturn this._segment.toString();\n\t}\n\n\tgetParentView() : IJetView{\n\t\treturn this._parent;\n\t}\n\n\t$$(id:string | IBaseView):IBaseView{\n\t\tif (typeof id === \"string\"){\n\t\t\tconst root = this.getRoot() as any;\n\t\t\treturn root.queryView(\n\t\t\t\t(obj => (obj.config.id === id || obj.config.localId === id) &&\n\t\t\t\t\t\t(obj.$scope === root.$scope)\n\t\t\t\t),\n\t\t\t\t\"self\");\n\t\t} else {\n\t\t\treturn id;\n\t\t}\n\t}\n\n\ton(obj, name, code){\n\t\tconst id = obj.attachEvent(name, code);\n\t\tthis._events.push({ obj, id });\n\t\treturn id;\n\t}\n\n\tcontains(view: IJetView){\n\t\tfor (const key in this._subs){\n\t\t\tconst kid = this._subs[key].view;\n\t\t\tif (kid === view || kid.contains(view)){\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\n\tgetSubView(name?:string):IJetView{\n\t\tconst sub = this.getSubViewInfo(name);\n\t\tif (sub){\n\t\t\treturn sub.subview.view;\n\t\t}\n\t}\n\n\tgetSubViewInfo(name?:string):ISubViewInfo{\n\t\tconst sub = this._subs[name || \"default\"];\n\t\tif (sub){\n\t\t\treturn { subview:sub, parent:this };\n\t\t}\n\n\t\tif (name === \"_top\"){\n\t\t\tthis._subs[name] = { url:\"\", id:null, popup:true };\n\t\t\treturn this.getSubViewInfo(name);\n\t\t}\n\n\t\t// when called from a child view, searches for nearest parent with subview\n\t\tif (this._parent){\n\t\t\treturn this._parent.getSubViewInfo(name);\n\t\t}\n\t\treturn null;\n\t}\n\n\tpublic abstract refresh();\n\tpublic abstract show(path:any, config?:any);\n\tpublic abstract render(\n\t\troot?: string | HTMLElement | ISubView,\n\t\turl?: IRoute, parent?: IJetView): Promise<IBaseView>;\n\n\tprotected _detachEvents(){\n\t\tconst events = this._events;\n\t\tfor (let i = events.length - 1; i >= 0; i--){\n\t\t\tevents[i].obj.detachEvent(events[i].id);\n\t\t}\n\t}\n\tprotected _destroySubs(){\n\t\t// destroy sub views\n\t\tfor (const key in this._subs){\n\t\t\tconst subView = this._subs[key].view;\n\t\t\t// it possible that subview was not loaded with any content yet\n\t\t\t// so check on null\n\t\t\tif (subView){\n\t\t\t\tsubView.destructor();\n\t\t\t}\n\t\t}\n\n\t\t// reset to prevent memory leaks\n\t\tthis._subs = {};\n\t}\n\tprotected _init_url_data(){\n\t\tconst url = this._segment.current();\n\t\tthis._data = {};\n\t\tthis.webix.extend(this._data, url.params, true);\n\t}\n\n\tprotected _getDefaultSub(){\n\t\tif (this._subs.default){\n\t\t\treturn this._subs.default;\n\t\t}\n\t\tfor (const key in this._subs){\n\t\t\tconst sub = this._subs[key];\n\t\t\tif (!sub.branch && sub.view && key !== \"_top\"){\n\t\t\t\tconst child = (sub.view as JetBase)._getDefaultSub();\n\t\t\t\tif (child){\n\t\t\t\t\treturn child;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected _routed_view() {\n\t\tconst parent = this.getParentView() as JetBase;\n\t\tif (!parent){\n\t\t\treturn true;\n\t\t}\n\n\t\tconst sub = parent._getDefaultSub();\n\t\tif (!sub && sub !== this){\n\t\t\treturn false;\n\t\t}\n\n\t\treturn parent._routed_view();\n\t}\n\n\t\n}\n","import {IJetURLChunk} from \"./interfaces\";\n\n\nexport function parse(url:string):IJetURLChunk[]{\n\t// remove starting /\n\tif (url[0] === \"/\"){\n\t\turl = url.substr(1);\n\t}\n\n\t// split url by \"/\"\n\tconst parts = url.split(\"/\");\n\tconst chunks:IJetURLChunk[] = [];\n\n\t// for each page in url\n\tfor (let i = 0; i < parts.length; i++){\n\t\tconst test = parts[i];\n\t\tconst result = {};\n\n\t\t// detect params\n\t\t// support old \t\t\tsome:a=b:c=d\n\t\t// and new notation\t\tsome?a=b&c=d\n\t\tlet pos = test.indexOf(\":\");\n\t\tif (pos === -1){\n\t\t\tpos = test.indexOf(\"?\");\n\t\t}\n\n\t\tif (pos !== -1){\n\t\t\tconst params = test.substr(pos+1).split(/[\\:\\?\\&]/g);\n\t\t\t// create hash of named params\n\t\t\tfor (const param of params) {\n\t\t\t\tconst dchunk = param.split(\"=\");\n\t\t\t\tresult[dchunk[0]] = decodeURIComponent(dchunk[1]);\n\t\t\t}\n\t\t}\n\n\t\t// store parsed values\n\t\tchunks[i] = {\n\t\t\tpage: (pos > -1 ? test.substr(0, pos) : test),\n\t\t\tparams:result,\n\t\t\tisNew:true\n\t\t};\n\t}\n\n\t// return array of page objects\n\treturn chunks;\n}\n\nexport function url2str(stack:IJetURLChunk[]):string{\n\tconst url = [];\n\n\tfor (const chunk of stack){\n\t\turl.push(\"/\"+chunk.page);\n\t\tconst params = obj2str(chunk.params);\n\t\tif (params){\n\t\t\turl.push(\"?\"+params);\n\t\t}\n\t}\n\n\treturn url.join(\"\");\n}\n\nfunction obj2str(obj){\n\tconst str = [];\n\tfor (const key in obj){\n\t\tif (typeof obj[key] === \"object\") continue;\n\t\tif (str.length){\n\t\t\tstr.push(\"&\");\n\t\t}\n\t\tstr.push(key+\"=\"+encodeURIComponent(obj[key]));\n\t}\n\n\treturn str.join(\"\");\n}","import { IJetURL, IJetView, IPath, IRoute, IJetURLChunk, IJetUrlTarget } from \"./interfaces\";\nimport {NavigationBlocked} from \"./errors\";\n\nimport {parse, url2str} from \"./helpers\";\n\nexport class Route implements IRoute{\n\tpublic route: IPath;\n\tprivate index: number;\n\tprivate _next: number = 1;\n\n\tconstructor(route: string|IPath, index: number){\n\t\tif (typeof route === \"string\"){\n\t\t\tthis.route = {\n\t\t\t\turl:parse(route),\n\t\t\t\tpath: route\n\t\t\t};\n\t\t} else {\n\t\t\tthis.route = route;\n\t\t}\n\n\t\tthis.index = index;\n\t}\n\tcurrent():IJetURLChunk{\n\t\treturn this.route.url[this.index];\n\t}\n\tnext():IJetURLChunk{\n\t\treturn this.route.url[this.index + this._next];\n\t}\n\n\tsuburl():IJetURL{\n\t\treturn this.route.url.slice(this.index);\n\t}\n\tshift(params) {\n\t\tconst route = new Route(this.route, this.index + this._next);\n\t\troute.setParams(route.route.url, params, route.index);\n\t\treturn route;\n\t}\n\tsetParams(url, params, index) {\n\t\tif (params) {\n\t\t\tconst old = url[index].params;\n\t\t\tfor (var key in params) old[key] = params[key];\n\t\t}\n\t}\n\trefresh(){\n\t\tconst url = this.route.url;\n\t\tfor (let i=this.index+1; i<url.length; i++){\n\t\t\turl[i].isNew = true;\n\t\t}\n\t}\n\ttoString(){\n\t\tconst str = url2str(this.suburl());\n\t\treturn str ? str.substr(1) : \"\";\n\t}\n\t_join(path: string, kids?: boolean){\n\t\tlet url = this.route.url;\n\t\tif (path === null){ // change of parameters, route elements are not affected\n\t\t\treturn url;\n\t\t}\n\n\t\tconst old = this.route.url;\n\t\tlet reset = true;\n\t\turl = old.slice(0, this.index+(kids?this._next:0));\n\t\tif (path){\n\t\t\turl = url.concat(parse(path));\n\n\t\t\tfor (let i=0; i<url.length; i++){\n\t\t\t\tif (old[i]){\n\t\t\t\t\turl[i].view = old[i].view;\n\t\t\t\t}\n\t\t\t\tif (reset && old[i] && url[i].page === old[i].page) {\n\t\t\t\t\turl[i].isNew = false;\n\t\t\t\t} else if (url[i].isNew) {\n\t\t\t\t\t// if some segment was marked as new, all subsegments must be updated as well\n\t\t\t\t\treset = false;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn url;\n\t}\n\n\tappend(path:string):string{\n\t\tconst url = this._join(path, true);\n\t\tthis.route.path = url2str(url);\n\t\tthis.route.url = url;\n\n\t\treturn this.route.path;\n\t}\n\n\tshow(path:IJetUrlTarget, view:IJetView, kids?: boolean):Promise<void>{\n\t\tconst url = this._join(path.url, kids);\n\t\tthis.setParams(url, path.params, this.index + (kids ? this._next : 0));\n\t\t\n\n\t\treturn new Promise((res, rej) => {\n\t\t\tconst redirect = url2str(url);\n\t\t\tconst obj = {\n\t\t\t\turl,\n\t\t\t\tredirect,\n\t\t\t\tconfirm: Promise.resolve()\n\t\t\t};\n\n\t\t\tconst app = view ? view.app : null;\n\t\t\t// when creating a new route, it possible that it will not have any content\n\t\t\t// guard is not necessary in such case\n\t\t\tif (app){\n\t\t\t\tconst result = app.callEvent(\"app:guard\", [obj.redirect, view, obj]);\n\t\t\t\tif (!result){\n\t\t\t\t\trej(new NavigationBlocked());\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tlet err;\n\t\t\tobj.confirm.catch(err => rej(err)).then(() => {\n\t\t\t\tif (obj.redirect === null){\n\t\t\t\t\trej(new NavigationBlocked());\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (obj.redirect !== redirect){\n\t\t\t\t\tapp.show(obj.redirect);\n\t\t\t\t\trej(new NavigationBlocked());\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tthis.route.path = redirect;\n\t\t\t\tthis.route.url = url;\n\t\t\t\tres();\n\t\t\t});\n\t\t});\n\t}\n\tsize(n:number){\n\t\tthis._next = n;\n\t}\n\tsplit():IRoute{\n\t\tconst route = {\n\t\t\turl: this.route.url.slice(this.index+1),\n\t\t\tpath:\"\"\n\t\t};\n\n\t\tif (route.url.length){\n\t\t\troute.path = url2str(route.url);\n\t\t}\n\n\t\treturn new Route(route, 0);\n\t}\n\tupdate(name:string, value: string, index?:number){\n\t\tconst chunk = this.route.url[this.index + (index || 0)];\n\t\tif (!chunk){\n\t\t\tthis.route.url.push({ page:\"\", params:{} });\n\t\t\treturn this.update(name, value, index);\n\t\t}\n\n\t\tif (name === \"\"){\n\t\t\tchunk.page = value;\n\t\t} else {\n\t\t\tchunk.params[name] = value;\n\t\t}\n\n\t\tthis.route.path = url2str(this.route.url);\n\t}\n}","import {JetBase} from \"./JetBase\";\n\nimport {\n\tIBaseConfig, IBaseView, IJetApp, IJetURL,\n\tIJetView, IJetViewFactory, ISubView, IUIConfig, IRoute, IJetUrlTarget } from \"./interfaces\";\nimport { Route } from \"./Route\";\n\n\nexport class JetView extends JetBase{\n\tprivate _children:IJetView[];\n\n\tconstructor(app : IJetApp, config : any){\n\t\tsuper(app.webix);\n\n\t\tthis.app = app;\n\t\t//this.$config = config;\n\n\t\tthis._children = [];\n\t}\n\n\tui(\n\t\tui:IBaseConfig|IJetViewFactory,\n\t\tconfig?: IUIConfig\n\t) : IBaseView | IJetView{\n\t\tconfig = config || {};\n\t\tconst container = config.container || (ui as IBaseConfig).container;\n\n\t\tconst jetview = this.app.createView(ui);\n\t\tthis._children.push(jetview);\n\n\t\tjetview.render(container, this._segment, this);\n\n\t\tif (typeof ui !== \"object\" || (ui instanceof JetBase)){\n\t\t\t// raw webix UI\n\t\t\treturn jetview;\n\t\t} else {\n\t\t\treturn jetview.getRoot();\n\t\t}\n\t}\n\n\tshow(path:any, config?:any):Promise<any>{\n\t\tconfig = config || {};\n\n\t\t// convert parameters object to url\n\t\tif (typeof path === \"object\"){\n\t\t\tfor (const key in path){\n\t\t\t\tthis.setParam(key, path[key]);\n\t\t\t}\n\t\t\tpath = null;\n\t\t} else {\n\n\t\t\t// deligate to app in case of root prefix\n\t\t\tif (path.substr(0,1) === \"/\"){\n\t\t\t\treturn this.app.show(path, config);\n\t\t\t}\n\n\t\t\t// local path, do nothing\n\t\t\tif (path.indexOf(\"./\") === 0){\n\t\t\t\tpath = path.substr(2);\n\t\t\t}\n\n\t\t\t// parent path, call parent view\n\t\t\tif (path.indexOf(\"../\") === 0){\n\t\t\t\tconst parent = this.getParentView();\n\t\t\t\tif (parent){\n\t\t\t\t\treturn parent.show(path.substr(3), config);\n\t\t\t\t} else {\n\t\t\t\t\treturn this.app.show(\"/\"+path.substr(3));\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst sub = this.getSubViewInfo(config.target);\n\t\t\tif (sub){\n\t\t\t\tif (sub.parent !== this){\n\t\t\t\t\treturn sub.parent.show(path, config);\n\t\t\t\t} else if (config.target && config.target !== \"default\"){\n\t\t\t\t\treturn this._renderFrameLock(config.target, sub.subview, {\n\t\t\t\t\t\turl: path,\n\t\t\t\t\t\tparams: config.params,\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif (path){\n\t\t\t\t\treturn this.app.show(\"/\" + path, config);\n\t\t\t\t} \n\t\t\t}\n\n\t\t}\n\n\t\treturn this._show(\n\t\t\tthis._segment,\n\t\t\t{ url: path, params: config.params },\n\t\t\tthis\n\t\t);\n\t}\n\n\t_show(segment:IRoute, path:IJetUrlTarget, view:IJetView){\n\t\treturn segment.show(path, view, true).then(() => {\n\t\t\tthis._init_url_data();\n\t\t\treturn this._urlChange();\n\t\t}).then(() => {\n\t\t\tif (segment.route.linkRouter){\n\t\t\t\tthis.app.getRouter().set(segment.route.path, { silent: true });\n\t\t\t\tthis.app.callEvent(\"app:route\", [segment.route.path]);\n\t\t\t}\n\t\t});\n\t}\n\n\tinit(_$view:IBaseView, _$: IJetURL){\n\t\t// stub\n\t}\n\tready(_$view:IBaseView, _$url: IJetURL){\n\t\t// stub\n\t}\n\tconfig() : any {\n\t\tthis.app.webix.message(\"View:Config is not implemented\");\n\t}\n\turlChange(_$view: IBaseView, _$url : IJetURL){\n\t\t// stub\n\t}\n\n\tdestroy(){\n\t\t// stub\n\t}\n\n\tdestructor(){\n\t\tthis.destroy();\n\t\tthis._destroyKids();\n\n\t\t// destroy actual UI\n\t\tif (this._root) {\n\t\t\tthis._root.destructor();\n\t\t\tsuper.destructor();\n\t\t}\n\t}\n\n\tuse(plugin, config){\n\t\tplugin(this.app, this, config);\n\t}\n\n\trefresh(){\n\t\tconst url = this.getUrl();\n\t\tthis.destroy();\n\t\tthis._destroyKids();\n\t\tthis._destroySubs();\n\t\tthis._detachEvents();\n\n\t\tif ((this._container as any).tagName){\n\t\t\tthis._root.destructor();\n\t\t}\n\n\t\tthis._segment.refresh();\n\t\treturn this._render(this._segment);\n\t}\n\n\trender(\n\t\troot: string | HTMLElement | ISubView,\n\t\turl: IRoute, parent?: IJetView): Promise<IBaseView> {\n\n\t\tif (typeof url === \"string\"){\n\t\t\turl = new Route(url, 0);\n\t\t}\n\n\t\tthis._segment = url;\n\n\t\tthis._parent = parent;\n\t\tthis._init_url_data();\n\n\t\troot = root || document.body;\n\t\tconst _container = (typeof root === \"string\") ? this.webix.toNode(root) : root;\n\n\t\tif (this._container !== _container) {\n\t\t\tthis._container = _container;\n\t\t\treturn this._render(url);\n\t\t} else {\n\t\t\treturn this._urlChange().then(() => this.getRoot());\n\t\t}\n\t}\n\n\tprotected _render(url: IRoute):Promise<IBaseView>{\n\t\tconst config = this.config();\n\t\tif (config.then){\n\t\t\treturn config.then(cfg => this._render_final(cfg, url));\n\t\t} else {\n\t\t\treturn this._render_final(config, url);\n\t\t}\n\t}\n\n\tprotected _render_final(config:any, url:IRoute):Promise<any>{\n\t\t// get previous view in the same slot\n\t\tlet slot:ISubView = null;\n\t\tlet container:string|HTMLElement|IBaseView = null;\n\t\tlet show = false;\n\t\tif (!(this._container as HTMLElement).tagName){\n\t\t\tslot = (this._container as ISubView);\n\t\t\tif (slot.popup){\n\t\t\t\tcontainer = document.body;\n\t\t\t\tshow = true;\n\t\t\t} else {\n\t\t\t\tcontainer = this.webix.$$(slot.id);\n\t\t\t}\n\t\t} else {\n\t\t\tcontainer = this._container as HTMLElement;\n\t\t}\n\n\t\t// view already destroyed\n\t\tif (!this.app || !container){\n\t\t\treturn Promise.reject(null);\n\t\t}\n\n\t\tlet response:Promise<any>;\n\t\tconst current = this._segment.current();\n\n\t\t// using wrapper object, so ui can be changed from app:render event\n\t\tconst result:any = { ui: {} };\n\t\tthis.app.copyConfig(config, result.ui, this._subs);\n\t\tthis.app.callEvent(\"app:render\", [this, url, result]);\n\t\tresult.ui.$scope = this;\n\n\t\t/* destroy old HTML attached views before creating new one */\n\t\tif (!slot && current.isNew && current.view){\n\t\t\tcurrent.view.destructor();\n\t\t}\n\n\t\ttry {\n\t\t\t// special handling for adding inside of multiview - preserve old id\n\t\t\tif (slot && !show){\n\t\t\t\tconst oldui = container as IBaseView;\n\t\t\t\tconst parent = oldui.getParentView();\n\t\t\t\tif (parent && parent.name === \"multiview\" && !result.ui.id){\n\t\t\t\t\tresult.ui.id = oldui.config.id;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis._root = this.app.webix.ui(result.ui, container);\n\t\t\tconst asWin = this._root as any;\n\t\t\t// check for url added to ignore this.ui calls\n\t\t\tif (show && asWin.setPosition && !asWin.isVisible()){\n\t\t\t\tasWin.show();\n\t\t\t}\n\n\t\t\t// check, if we are replacing some older view\n\t\t\tif (slot){\n\t\t\t\tif (slot.view && slot.view !== this && slot.view !== this.app){\n\t\t\t\t\tslot.view.destructor();\n\t\t\t\t}\n\n\t\t\t\tslot.id = this._root.config.id as string;\n\t\t\t\tif (this.getParentView() || !this.app.app)\n\t\t\t\t\tslot.view = this;\n\t\t\t\telse {\n\t\t\t\t\t// when we have subapp, set whole app as a view\n\t\t\t\t\t// so on destruction, the whole app will be destroyed\n\t\t\t\t\tslot.view = this.app as any;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (current.isNew){\n\t\t\t\tcurrent.view = this;\n\t\t\t\tcurrent.isNew = false;\n\t\t\t}\n\n\t\t\tresponse = Promise.resolve(this._init(this._root, url)).then(() => {\n\t\t\t\treturn this._urlChange().then(() => {\n\t\t\t\t\tthis._initUrl = null;\n\t\t\t\t\treturn this.ready(this._root, url.suburl());\n\t\t\t\t});\n\t\t\t});\n\t\t} catch(e){\n\t\t\tresponse = Promise.reject(e);\n\t\t}\n\n\t\treturn response.catch(err => this._initError(this, err));\n\t}\n\n\tprotected _init(view:IBaseView, url: IRoute){\n\t\treturn this.init(view, url.suburl());\n\t}\n\n\tprotected _urlChange():Promise<any>{\n\t\tthis.app.callEvent(\"app:urlchange\", [this, this._segment]);\n\n\t\tconst waits = [];\n\t\tfor (const key in this._subs){\n\t\t\tconst frame = this._subs[key];\n\t\t\tconst wait = this._renderFrameLock(key, frame, null);\n\t\t\tif (wait){\n\t\t\t\twaits.push(wait);\n\t\t\t}\n\t\t}\n\n\t\treturn Promise.all(waits).then(() => {\n\t\t\treturn this.urlChange(this._root, this._segment.suburl());\n\t\t});\n\t}\n\n\tprotected  _renderFrameLock(key:string, frame:ISubView, path: IJetUrlTarget):Promise<any>{\n\t\t// if subview is not occupied by some rendering yet\n\t\tif (!frame.lock) {\n\t\t\t// retreive and store rendering end promise\n\t\t\tconst lock =  this._renderFrame(key, frame, path);\n\t\t\tif (lock){\n\t\t\t\t// clear lock after frame rendering\n\t\t\t\t// as promise.finally is not supported by  Webix lesser than 6.2\n\t\t\t\t// using a more verbose notation\n\t\t\t\tframe.lock = lock.then(() => frame.lock = null, () => frame.lock = null)\n\t\t\t}\n\t\t}\n\n\t\t// return rendering end promise\n\t\treturn frame.lock;\n\t}\n\n\tprotected _renderFrame(key:string, frame:ISubView, path: IJetUrlTarget):Promise<any>{\n\t\t//default route\n\t\tif (key === \"default\"){\n\t\t\tif (this._segment.next()){\n\t\t\t\t// we have a next segment in url, render it\n\t\t\t\tlet params = path ? path.params : null;\n\t\t\t\tif (frame.params) {\n\t\t\t\t\tparams = this.webix.extend(params || {}, frame.params);\n\t\t\t\t}\n\t\t\t\treturn this._createSubView(frame, this._segment.shift(params));\n\t\t\t} else if (frame.view && frame.popup) {\n\t\t\t\t// there is no next segment, delete the existing sub-view\n\t\t\t\tframe.view.destructor();\n\t\t\t\tframe.view = null;\n\t\t\t}\n\t\t}\n\t\t\n\t\t//if new path provided, set it to the frame\n\t\tif (path !== null){\n\t\t\tframe.url = path.url;\n\t\t\tif (frame.params) {\n\t\t\t\tpath.params = this.webix.extend(path.params || {}, frame.params);\n\t\t\t}\n\t\t}\n\n\t\t// in case of routed sub-view\n\t\tif (frame.route){\n\t\t\t// we have a new path for sub-view\n\t\t\tif (path !== null){\n\t\t\t\treturn frame.route.show(path, frame.view).then(() => {\n\t\t\t\t\treturn this._createSubView(frame, frame.route);\n\t\t\t\t});\n\t\t\t}\n\n\t\t\t// do not trigger onChange for isolated sub-views\n\t\t\tif (frame.branch){\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tlet view = frame.view;\n\t\t// if view doesn't exists yet, init it\n\t\tif (!view && frame.url){\n\t\t\tif (typeof frame.url === \"string\"){\n\t\t\t\t// string, so we have isolated subview url\n\t\t\t\tframe.route = new Route(frame.url, 0);\n\t\t\t\tif (path) frame.route.setParams(frame.route.route.url, path.params, 0);\n\t\t\t\tif (frame.params)\n\t\t\t\t\tframe.route.setParams(frame.route.route.url, frame.params, 0);\n\t\t\t\treturn this._createSubView(frame, frame.route);\n\t\t\t} else {\n\t\t\t\t// object, so we have an embeded subview\n\t\t\t\tif (typeof frame.url === \"function\" && !(view instanceof frame.url)){\n\t\t\t\t\tview = new ((this.app as any)._override(frame.url))(this.app, \"\");\n\t\t\t\t}\n\t\t\t\tif (!view){\n\t\t\t\t\tview = frame.url as any;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// trigger onChange for already existed view\n\t\tif (view){\n\t\t\treturn view.render(frame, (frame.route || this._segment), this);\n\t\t}\n\t}\n\n\tprivate _initError(view: any, err: any){\n\t\t/*\n\t\t\tif view is destroyed, ignore any view related errors\n\t\t*/\n\t\tif (this.app){\n\t\t\tthis.app.error(\"app:error:initview\", [err, view]);\n\t\t}\n\t\treturn true;\n\t}\n\n\tprivate _createSubView(\n\t\t\t\t\tsub:ISubView,\n\t\t\t\t\tsuburl:IRoute):Promise<IBaseView>{\n\t\treturn this.app.createFromURL(suburl.current()).then(view => {\n\t\t\treturn view.render(sub, suburl, this);\n\t\t});\n\t}\n\n\tprivate _destroyKids(){\n\t\t// destroy child views\n\t\tconst uis = this._children;\n\t\tfor (let i = uis.length - 1; i >= 0; i--){\n\t\t\tif (uis[i] && uis[i].destructor){\n\t\t\t\tuis[i].destructor();\n\t\t\t}\n\t\t}\n\n\t\t// reset vars for better GC processing\n\t\tthis._children = [];\n\t}\n}","import {IJetApp} from \"./interfaces\";\nimport {JetView} from \"./JetView\";\n\n\n// wrapper for raw objects and Jet 1.x structs\nexport class JetViewRaw extends JetView{\n\tprivate _ui:any;\n\n\tconstructor(app:IJetApp, config:any){\n\t\tsuper(app, config);\n\t\tthis._ui = config.ui;\n\t}\n\n\tconfig(){\n\t\treturn this._ui;\n\t}\n}","import {IJetApp, IJetRouter, IJetRouterCallback, IJetRouterOptions} from \"../interfaces\";\n\nimport {url2str} from \"../helpers\";\n\nexport class SubRouter implements IJetRouter{\n\tprivate app: IJetApp;\n\tprivate path: string;\n\tprivate prefix: string;\n\n\tconstructor(cb: IJetRouterCallback, config:any, app:IJetApp){\n\t\tthis.path = \"\";\n\t\tthis.app = app;\n\t}\n\tset(path:string, config?:IJetRouterOptions){\n\t\tthis.path = path;\n\t\tconst a = this.app as any;\n\t\ta.app.getRouter().set(a._segment.append(this.path), { silent:true });\n\t}\n\tget(){\n\t\treturn this.path;\n\t}\n}","import { JetBase } from \"./JetBase\";\nimport { JetViewRaw } from \"./JetViewRaw\";\nimport { JetView } from \"./JetView\";\nimport {SubRouter} from \"./routers/SubRouter\";\nimport {NavigationBlocked} from \"./errors\";\n\nimport {\n\tIBaseView, IJetApp, IJetConfig, IJetRouter,\n\tIJetURL, IJetURLChunk, IHash,\n\tIJetView, IRoute, ISubView, IViewConfig } from \"./interfaces\";\n\nimport { Route } from \"./Route\";\n\nlet _once = true;\n\nexport class JetAppBase extends JetBase implements IJetView {\n\tpublic config: IJetConfig;\n\tpublic app: IJetApp;\n\tpublic ready: Promise<any>;\n\n\tcallEvent: (name: string, parameters: any[]) => boolean;\n\tattachEvent: (name: string, handler: any) => void;\n\n\tprivate $router: IJetRouter;\n\tprivate _services: { [name: string]: any };\n\tprivate _subSegment: IRoute;\n\n\tconstructor(config?: any) {\n\t\tconst webix = (config || {}).webix || (window as any).webix;\n\t\tconfig = webix.extend({\n\t\t\tname: \"App\",\n\t\t\tversion: \"1.0\",\n\t\t\tstart: \"/home\"\n\t\t}, config, true);\n\n\t\tsuper(webix, config);\n\n\t\tthis.config = config;\n\t\tthis.app = this.config.app;\n\t\tthis.ready = Promise.resolve();\n\t\tthis._services = {};\n\n\t\tthis.webix.extend(this, this.webix.EventSystem);\n\t}\n\tgetUrl():IJetURL{\n\t\treturn this._subSegment.suburl();\n\t}\n\tgetUrlString(){\n\t\treturn this._subSegment.toString();\n\t}\n\tgetService(name: string) {\n\t\tlet obj = this._services[name];\n\t\tif (typeof obj === \"function\") {\n\t\t\tobj = this._services[name] = obj(this);\n\t\t}\n\t\treturn obj;\n\t}\n\tsetService(name: string, handler: any) {\n\t\tthis._services[name] = handler;\n\t}\n\tdestructor(){\n\t\tthis.getSubView().destructor();\n\t\tsuper.destructor();\n\t}\n\t// copy object and collect extra handlers\n\tcopyConfig(obj: any, target: any, config: IViewConfig) {\n\t\t// raw ui config\n\t\tif (obj instanceof JetBase ||\n\t\t\t(typeof obj === \"function\" && obj.prototype instanceof JetBase)){\n\t\t\tobj = { $subview: obj };\n\t\t}\n\n\t\t// subview placeholder\n\t\tif (typeof obj.$subview != \"undefined\") {\n\t\t\treturn this.addSubView(obj, target, config);\n\t\t}\n\n\t\t// process sub-properties\n\t\tconst isArray = obj instanceof Array;\n\t\ttarget = target || (isArray ? [] : {});\n\t\tfor (const method in obj) {\n\t\t\tlet point = obj[method];\n\n\t\t\t// view class\n\t\t\tif (typeof point === \"function\" && point.prototype instanceof JetBase) {\n\t\t\t\tpoint = { $subview : point };\n\t\t\t}\n\n\t\t\tif (point && typeof point === \"object\" &&\n\t\t\t\t!(point instanceof this.webix.DataCollection) && !(point instanceof RegExp) && !(point instanceof Map)) {\n\t\t\t\tif (point instanceof Date) {\n\t\t\t\t\ttarget[method] = new Date(point);\n\t\t\t\t} else {\n\t\t\t\t\tconst copy = this.copyConfig(\n\t\t\t\t\t\tpoint,\n\t\t\t\t\t\t(point instanceof Array ? [] : {}),\n\t\t\t\t\t\tconfig);\n\t\t\t\t\tif (copy !== null){\n\t\t\t\t\t\tif (isArray) target.push(copy);\n\t\t\t\t\t\telse target[method] = copy;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\ttarget[method] = point;\n\t\t\t}\n\t\t}\n\n\t\treturn target;\n\t}\n\n\tgetRouter() {\n\t\treturn this.$router;\n\t}\n\n\tclickHandler(e: Event, target?: HTMLElement) {\n\t\tif (e) {\n\t\t\ttarget = target || (e.target || e.srcElement) as HTMLElement;\n\t\t\tif (target && target.getAttribute) {\n\t\t\t\tconst trigger: string = target.getAttribute(\"trigger\");\n\t\t\t\tif (trigger) {\n\t\t\t\t\tthis._forView(target, view => view.app.trigger(trigger));\n\t\t\t\t\te.cancelBubble = true;\n\t\t\t\t\treturn e.preventDefault();\n\t\t\t\t}\n\t\t\t\tconst route: string = target.getAttribute(\"route\");\n\t\t\t\tif (route) {\n\t\t\t\t\tthis._forView(target, view => view.show(route));\n\t\t\t\t\te.cancelBubble = true;\n\t\t\t\t\treturn e.preventDefault();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tconst parent = target.parentNode as HTMLElement;\n\t\tif (parent){\n\t\t\tthis.clickHandler(e, parent);\n\t\t}\n\t}\n\n\tgetRoot(){\n\t\treturn this.getSubView().getRoot();\n\t}\n\n\trefresh(){\n\t\tif (!this._subSegment){\n\t\t\treturn Promise.resolve(null);\n\t\t}\n\n\t\treturn this.getSubView().refresh().then(view => {\n\t\t\tthis.callEvent(\"app:route\", [this.getUrl()]);\n\t\t\treturn view;\n\t\t});\n\t}\n\n\tloadView(url:string): Promise<IJetView> {\n\t\tconst views = this.config.views;\n\t\tlet result = null;\n\n\t\tif (url === \"\"){\n\t\t\treturn Promise.resolve(\n\t\t\t\tthis._loadError(\"\", new Error(\"Webix Jet: Empty url segment\"))\n\t\t\t);\n\t\t}\n\n\t\ttry {\n\t\t\tif (views) {\n\t\t\t\tif (typeof views === \"function\") {\n\t\t\t\t\t// custom loading strategy\n\t\t\t\t\tresult = views(url);\n\t\t\t\t} else {\n\t\t\t\t\t// predefined hash\n\t\t\t\t\tresult = views[url];\n\t\t\t\t}\n\t\t\t\tif (typeof result === \"string\"){\n\t\t\t\t\turl = result;\n\t\t\t\t\tresult = null;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (!result){\n\t\t\t\tif (url === \"_hidden\"){\n\t\t\t\t\tresult = { hidden:true };\n\t\t\t\t} else if (url === \"_blank\"){\n\t\t\t\t\tresult = {};\n\t\t\t\t} else {\n\t\t\t\t\turl = url.replace(/\\./g, \"/\");\n\t\t\t\t\tresult = this.require(\"jet-views\", url);\n\t\t\t\t}\n\t\t\t}\n\t\t} catch(e){\n\t\t\tresult = this._loadError(url, e);\n\t\t}\n\n\t\t// custom handler can return view or its promise\n\t\tif (!result.then){\n\t\t\tresult = Promise.resolve(result);\n\t\t}\n\n\t\t// set error handler\n\t\tresult = result\n\t\t\t.then(module => module.__esModule ? module.default : module)\n\t\t\t.catch(err => this._loadError(url, err));\n\n\t\treturn result;\n\t}\n\n\t_forView(target: HTMLElement, handler){\n\t\tconst view = this.webix.$$(target as any);\n\t\tif (view) {\n\t\t\thandler((view as any).$scope)\n\t\t}\n\t}\n\n\t_loadViewDynamic(url){\n\t\treturn null;\n\t}\n\n\tcreateFromURL(chunk: IJetURLChunk): Promise<IJetView> {\n\t\tlet view:Promise<IJetView>;\n\n\t\tif (chunk.isNew || !chunk.view) {\n\t\t\tview = this.loadView(chunk.page)\n\t\t\t\t.then(ui => this.createView(ui, name, chunk.params));\n\t\t} else {\n\t\t\tview = Promise.resolve(chunk.view);\n\t\t}\n\n\t\treturn view;\n\t}\n\n\t_override(ui) {\n\t\tconst over = this.config.override;\n\t\tif (over){\n\t\t\tlet dv;\n\t\t\twhile(ui){\n\t\t\t\tdv = ui;\n\t\t\t\tui = over.get(ui);\n\t\t\t}\n\t\t\treturn dv;\n\t\t}\n\t\treturn ui;\n\t}\n\tcreateView(ui:any, name?:string, params?:IHash){\n\t\tui = this._override(ui);\n\n\t\tlet obj;\n\t\tif (typeof ui === \"function\") {\n\t\t\tif (ui.prototype instanceof JetAppBase) {\n\t\t\t\t// UI class\n\t\t\t\treturn new ui({ app: this, name, params, router:SubRouter });\n\t\t\t} else if (ui.prototype instanceof JetBase) {\n\t\t\t\t// UI class\n\t\t\t\treturn new ui(this, { name, params });\n\t\t\t} else {\n\t\t\t\t// UI factory functions\n\t\t\t\tui = ui(this);\n\t\t\t}\n\t\t}\n\n\t\tif (ui instanceof JetBase){\n\t\t\tobj = ui;\n\t\t} else {\n\t\t\t// UI object\n\t\t\tobj = new JetViewRaw(this, { name, ui });\n\t\t}\n\t\treturn obj;\n\t}\n\n\t// show view path\n\tshow(url: string, config?:any) : Promise<any> {\n\t\tif (url && this.app && url.indexOf(\"//\") == 0)\n\t\t\treturn this.app.show(url.substr(1), config);\n\n\t\treturn this.render(this._container, url || this.config.start, config);\n\t}\n\n\t// event helpers\n\ttrigger(name: string, ...rest: any[]) {\n\t\tthis.apply(name, rest);\n\t}\n\tapply(name: string, data: any[]) {\n\t\tthis.callEvent(name, data);\n\t}\n\taction(name: string) {\n\t\treturn this.webix.bind(function(...rest: any[]) {\n\t\t\tthis.apply(name, rest);\n\t\t}, this);\n\t}\n\ton(name: string, handler) {\n\t\tthis.attachEvent(name, handler);\n\t}\n\n\tuse(plugin, config){\n\t\tplugin(this, null, config);\n\t}\n\n\terror(name:string, er:any[]){\n\t\tthis.callEvent(name, er);\n\t\tthis.callEvent(\"app:error\", er);\n\n\t\t/* tslint:disable */\n\t\tif (this.config.debug){\n\t\t\tfor (var i=0; i<er.length; i++){\n\t\t\t\tconsole.error(er[i]);\n\t\t\t\tif (er[i] instanceof Error){\n\t\t\t\t\tlet text = er[i].message;\n\t\t\t\t\tif (text.indexOf(\"Module build failed\") === 0){\n\t\t\t\t\t\ttext = text.replace(/\\x1b\\[[0-9;]*m/g,\"\");\n\t\t\t\t\t\tdocument.body.innerHTML = `<pre style='font-size:16px; background-color: #ec6873; color: #000; padding:10px;'>${text}</pre>`;\n\t\t\t\t\t} else {\n\t\t\t\t\t\ttext += \"<br><br>Check console for more details\";\n\t\t\t\t\t\tthis.webix.message({ type:\"error\", text:text, expire:-1 });\n\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t}\n\t\t\t}\n\t\t\tdebugger;\n\t\t}\n\t\t/* tslint:enable */\n\t}\n\n\t// renders top view\n\trender(\n\t\troot?: string | HTMLElement | ISubView,\n\t\turl?: IRoute | string,\n\t\tconfig?:any): Promise<IBaseView> {\n\n\t\tthis._container = (typeof root === \"string\") ?\n\t\t\tthis.webix.toNode(root):\n\t\t\t(root || document.body);\n\n\t\tconst firstInit = !this.$router;\n\t\tlet path:string = null;\n\t\tif (firstInit){\n\t\t\tif (_once && \"tagName\" in this._container){\n\t\t\t\tthis.webix.event(document.body, \"click\", e => this.clickHandler(e));\n\t\t\t\t_once = false;\n\t\t\t}\n\n\t\t\tif (typeof url === \"string\"){\n\t\t\t\turl = new Route(url, 0);\n\t\t\t}\n\t\t\tthis._subSegment = this._first_start(url);\n\t\t\tthis._subSegment.route.linkRouter = true;\n\t\t} else {\n\t\t\tif (typeof url === \"string\"){\n\t\t\t\tpath = url;\n\t\t\t} else {\n\t\t\t\tif (this.app){\n\t\t\t\t\tpath = url.split().route.path || this.config.start;\n\t\t\t\t} else {\n\t\t\t\t\tpath = url.toString();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tconst params = config ? config.params : this.config.params || null;\n\t\tconst top = this.getSubView();\n\t\tconst segment = this._subSegment;\n\t\tconst ready = segment\n\t\t\t.show({ url: path, params }, top)\n\t\t\t.then(() => this.createFromURL(segment.current()))\n\t\t\t.then(view => view.render(root, segment))\n\t\t\t.then(base => {\n\t\t\t\tthis.$router.set(segment.route.path, { silent:true });\n\t\t\t\tthis.callEvent(\"app:route\", [this.getUrl()]);\n\t\t\t\treturn base;\n\t\t\t});\n\n\t\tthis.ready = this.ready.then(() => ready);\n\t\treturn ready;\n\t}\n\n\tgetSubView():IJetView{\n\t\tif (this._subSegment){\n\t\t\tconst view = this._subSegment.current().view;\n\t\t\tif (view)\n\t\t\t\treturn view;\n\t\t}\n\t\treturn new JetView(this, {});\n\t}\n\n\trequire(type:string, url:string):any{ return null; }\n\n\tprivate _first_start(route: IRoute) : IRoute{\n\t\tthis._segment = route;\n\n\t\tconst cb = (a:string) => setTimeout(() => {\n\t\t\t(this as JetAppBase).show(a).catch(e => {\n\t\t\t\tif (!(e instanceof NavigationBlocked))\n\t\t\t\t\tthrow e;\n\t\t\t});\n\t\t},1);\n\t\tthis.$router = new (this.config.router)(cb, this.config, this);\n\n\t\t// start animation for top-level app\n\t\tif (this._container === document.body && this.config.animation !== false) {\n\t\t\tconst node = this._container as HTMLElement;\n\t\t\tthis.webix.html.addCss(node, \"webixappstart\");\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis.webix.html.removeCss(node, \"webixappstart\");\n\t\t\t\tthis.webix.html.addCss(node, \"webixapp\");\n\t\t\t}, 10);\n\t\t}\n\n\t\tif (!route){\n\t\t\t// if no url defined, check router first\n\t\t\tlet urlString = this.$router.get();\n\t\t\tif (!urlString){\n\t\t\t\turlString = this.config.start;\n\t\t\t\tthis.$router.set(urlString, { silent: true });\n\t\t\t}\n\t\t\troute = new Route(urlString, 0);\n\t\t} else if (this.app) {\n\t\t\tconst now = route.current().view;\n\t\t\troute.current().view = this;\n\t\t\tif (route.next()){\n\t\t\t\troute.refresh();\n\t\t\t\troute = route.split();\n\t\t\t} else {\n\t\t\t\troute = new Route(this.config.start, 0);\n\t\t\t}\n\t\t\troute.current().view = now;\n\t\t}\n\n\t\treturn route;\n\t}\n\n\t// error during view resolving\n\tprivate _loadError(url: string, err: Error):any{\n\t\tthis.error(\"app:error:resolve\", [err, url]);\n\t\treturn { template:\" \" };\n\t}\n\n\tprivate addSubView(obj, target, config:IViewConfig) : ISubView {\n\t\tconst url = obj.$subview !== true ? obj.$subview : null;\n\t\tconst name: string = obj.name || (url ? this.webix.uid() : \"default\");\n\t\ttarget.id = obj.id || \"s\" + this.webix.uid();\n\n\t\tconst view : ISubView = config[name] = {\n\t\t\tid: target.id,\n\t\t\turl,\n\t\t\tbranch: obj.branch,\n\t\t\tpopup: obj.popup,\n\t\t\tparams: obj.params\n\t\t};\n\n\t\treturn view.popup ? null : target;\n\t}\n}\n","import {IJetRouter, IJetRouterCallback, IJetRouterOptions} from \"../interfaces\";\n\nexport class HashRouter implements IJetRouter{\n\tprotected config:any;\n\tprotected prefix:string;\n\tprotected sufix:string;\n\tprivate cb: IJetRouterCallback;\n\n\tconstructor(cb: IJetRouterCallback, config:any){\n\t\tthis.config = config || {};\n\t\tthis._detectPrefix();\n\t\tthis.cb = cb;\n\t\twindow.onpopstate = () => this.cb(this.get());\n\t}\n\n\tset(path:string, config?:IJetRouterOptions){\n\t\tif (this.config.routes){\n\t\t\tconst compare = path.split(\"?\",2);\n\t\t\tfor (const key in this.config.routes){\n\t\t\t\tif (this.config.routes[key] === compare[0]){\n\t\t\t\t\tpath = key+(compare.length > 1 ? \"?\"+compare[1] : \"\");\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (this.get() !== path){\n\t\t\twindow.history.pushState(null, null, this.prefix + this.sufix + path);\n\t\t}\n\t\tif (!config || !config.silent){\n\t\t\tsetTimeout(() => this.cb(path), 1);\n\t\t}\n\t}\n\tget(){\n\t\tlet path = this._getRaw().replace(this.prefix, \"\").replace(this.sufix, \"\");\n\t\tpath = (path !== \"/\" && path !== \"#\") ? path : \"\";\n\n\t\tif (this.config.routes){\n\t\t\tconst compare = path.split(\"?\",2);\n\t\t\tconst key = this.config.routes[compare[0]];\n\t\t\tif (key){\n\t\t\t\tpath = key+(compare.length > 1 ? \"?\"+compare[1] : \"\");\n\t\t\t}\n\t\t}\n\t\treturn path;\n\t}\n\tprotected _detectPrefix(){\n\t\t// use \"#!\" for backward compatibility\n\t\tconst sufix = this.config.routerPrefix;\n\t\tthis.sufix = \"#\" + ((typeof sufix === \"undefined\") ? \"!\" : sufix);\n\n\t\tthis.prefix = document.location.href.split(\"#\", 2)[0];\n\t}\n\n\tprotected _getRaw(){\n\t\treturn document.location.href;\n\t}\n}","let isPatched = false;\nexport default function patch(w: any){\n\tif (isPatched || !w){ return; }\n\tisPatched = true;\n\n\t// custom promise for IE8\n\tconst win = window as any;\n\tif (!win.Promise){\n\t\twin.Promise = w.promise;\n\t}\n\n\tconst version = w.version.split(\".\") as any[];\n\n\t// will be fixed in webix 5.3\n\tif (version[0]*10+version[1]*1 < 53) {\n\t\tw.ui.freeze = function(handler):any{\n\t\t\t// disabled because webix jet 5.0 can't handle resize of scrollview correctly\n\t\t\t// w.ui.$freeze = true;\n\t\t\tconst res = handler();\n\t\t\tif (res && res.then){\n\t\t\t\tres.then(function(some){\n\t\t\t\t\tw.ui.$freeze = false;\n\t\t\t\t\tw.ui.resize();\n\t\t\t\t\treturn some;\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tw.ui.$freeze = false;\n\t\t\t\tw.ui.resize();\n\t\t\t}\n\t\t\treturn res;\n\t\t};\n\t}\n\n\t// adding views as classes\n\tconst baseAdd = w.ui.baselayout.prototype.addView as any;\n\tconst baseRemove = w.ui.baselayout.prototype.removeView as any;\n\n\tconst config = {\n\t\taddView(view, index){\n\t\t\t// trigger logic only for widgets inside of jet-view\n\t\t\t// ignore case when addView used with already initialized widget\n\t\t\tif (this.$scope && this.$scope.webixJet && !view.queryView){\n\t\t\t\tconst jview = this.$scope;\n\t\t\t\tconst subs = {};\n\n\t\t\t\tview = jview.app.copyConfig(view, {}, subs);\n\t\t\t\tbaseAdd.apply(this, [view, index]);\n\n\t\t\t\tfor (const key in subs){\n\t\t\t\t\tjview._renderFrame(key, subs[key], null).then(() => {\n\t\t\t\t\t\tjview._subs[key] = subs[key];\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\treturn view.id;\n\t\t\t} else {\n\t\t\t\treturn baseAdd.apply(this, arguments);\n\t\t\t}\n\t\t},\n\t\tremoveView(){\n\t\t\tbaseRemove.apply(this, arguments);\n\t\t\tif (this.$scope && this.$scope.webixJet){\n\t\t\t\tconst subs = this.$scope._subs;\n\t\t\t\t// check all sub-views, destroy and clean the removed one\n\t\t\t\tfor(const key in subs){\n\t\t\t\t\tconst test = subs[key];\n\t\t\t\t\tif (!w.$$(test.id)){\n\t\t\t\t\t\ttest.view.destructor();\n\t\t\t\t\t\tdelete subs[key];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t};\n\n\tw.extend(w.ui.layout.prototype, config, true);\n\tw.extend(w.ui.baselayout.prototype, config, true);\n\n\t// wrapper for using Jet Apps as views\n\n\tw.protoUI({\n\t\tname:\"jetapp\",\n\t\t$init(cfg){\n\t\t\tthis.$app = new this.app(cfg);\n\n\t\t\tconst id = w.uid().toString();\n\t\t\tcfg.body = { id };\n\n\t\t\tthis.$ready.push(function(){\n\t\t\t\tthis.callEvent(\"onInit\", [this.$app]);\n\t\t\t\tthis.$app.render({ id });\n\t\t\t});\n\t\t}\n\t}, (w.ui as any).proxy, w.EventSystem);\n}","import { IJetApp } from \"./interfaces\";\nimport { JetAppBase } from \"./JetAppBase\";\nimport { HashRouter } from \"./routers/HashRouter\";\n\nimport patch from \"./patch\";\n\n// webpack require\ndeclare function require(_$url: string): any;\n\n// webpack require\ndeclare function require(_$url: string): any;\n\nexport class JetApp extends JetAppBase implements IJetApp {\n\tconstructor(config: any) {\n\t\tconfig.router = config.router || HashRouter;\n\t\tsuper(config);\n\t\tpatch(this.webix);\n\t}\n\trequire(type:string, url:string){\n\t\treturn require(type+\"/\"+url);\n\t}\n}\n","import {IJetApp, IJetRouter, IJetRouterCallback, IJetRouterOptions} from \"../interfaces\";\n\nexport class StoreRouter implements IJetRouter{\n\tprivate name:string;\n\tprivate storage: any;\n\tprivate cb: IJetRouterCallback;\n\n\tconstructor(cb: IJetRouterCallback, config:any, app: IJetApp){\n\t\tthis.storage = config.storage || app.webix.storage.session;\n\t\tthis.name = (config.storeName || config.id+\":route\");\n\t\tthis.cb = cb;\n\t}\n\tset(path:string, config?:IJetRouterOptions){\n\t\tthis.storage.put(this.name, path);\n\t\tif (!config || !config.silent){\n\t\t\tsetTimeout(() => this.cb(path), 1);\n\t\t}\n\t}\n\tget(){\n\t\treturn this.storage.get(this.name);\n\t}\n}","import {IJetRouter, IJetRouterCallback, IJetRouterOptions} from \"../interfaces\";\nimport { HashRouter } from \"./HashRouter\";\n\nexport class UrlRouter extends HashRouter implements IJetRouter{\n\tprotected _detectPrefix(){\n\t\tthis.prefix = \"\";\n\t\tthis.sufix = this.config.routerPrefix || \"\";\n\t}\n\tprotected _getRaw(){\n\t\treturn document.location.pathname + (document.location.search||\"\");\n\t}\n}","import {IJetRouter, IJetRouterCallback, IJetRouterOptions} from \"../interfaces\";\n\nexport class EmptyRouter implements IJetRouter{\n\tprivate path: string;\n\tprivate cb: IJetRouterCallback;\n\n\tconstructor(cb: IJetRouterCallback, _$config:any){\n\t\tthis.path = \"\";\n\t\tthis.cb = cb;\n\t}\n\tset(path:string, config?:IJetRouterOptions){\n\t\tthis.path = path;\n\t\tif (!config || !config.silent){\n\t\t\tsetTimeout(() => this.cb(path), 1);\n\t\t}\n\t}\n\tget(){\n\t\treturn this.path;\n\t}\n}","import {NavigationBlocked} from \"../errors\";\nimport {IJetApp, IJetURL, IJetView} from \"../interfaces\";\n\nexport function UnloadGuard(app: IJetApp, view: IJetView, config: any){\n\tview.on(app, `app:guard`, function(_$url:IJetURL, point:IJetView, promise:any){\n\t\tif (point === view || point.contains(view)){\n\t\t\tconst res = config();\n\t\t\tif (res === false){\n\t\t\t\tpromise.confirm = Promise.reject(new NavigationBlocked());\n\t\t\t} else {\n\t\t\t\tpromise.confirm = promise.confirm.then(() => res);\n\t\t\t}\n\t\t}\n\t});\n}","//     (c) 2012-2018 Airbnb, Inc.\n//\n//     polyglot.js may be freely distributed under the terms of the BSD\n//     license. For all licensing information, details, and documention:\n//     http://airbnb.github.com/polyglot.js\n//\n//\n// Polyglot.js is an I18n helper library written in JavaScript, made to\n// work both in the browser and in Node. It provides a simple solution for\n// interpolation and pluralization, based off of Airbnb's\n// experience adding I18n functionality to its Backbone.js and Node apps.\n//\n// Polylglot is agnostic to your translation backend. It doesn't perform any\n// translation; it simply gives you a way to manage translated phrases from\n// your client- or server-side JavaScript application.\n//\n\n'use strict';\n\n// var has = require('has');\nfunction has(store, key) {\n  return Object.prototype.hasOwnProperty.call(store, key);\n}\n// var forEach = require('for-each');\nfunction forEach(obj, handler, context) {\n  for (var key in obj) {\n    if (has(obj, key)) {\n      handler.call((context || obj), obj[key], key, obj);\n    }\n  }\n}\n// var trim = require('string.prototype.trim');\nfunction trim(str) {\n  return str.replace(/^[\\s\\uFEFF\\xA0]+|[\\s\\uFEFF\\xA0]+$/g, '');\n}\n// var warning = require('warning');\nfunction warn(message) {\n  message = 'Warning: ' + message;\n  if (typeof console !== 'undefined') {\n    console.error(message);\n  }\n\n  try { throw new Error(message); } catch (x) {}\n}\n\nvar replace = String.prototype.replace;\nvar split = String.prototype.split;\n\n// #### Pluralization methods\n// The string that separates the different phrase possibilities.\nvar delimiter = '||||';\n\nvar russianPluralGroups = function (n) {\n  var end = n % 10;\n  if (n !== 11 && end === 1) {\n    return 0;\n  }\n  if (2 <= end && end <= 4 && !(n >= 12 && n <= 14)) {\n    return 1;\n  }\n  return 2;\n};\n\n// Mapping from pluralization group plural logic.\nvar pluralTypes = {\n  arabic: function (n) {\n    // http://www.arabeyes.org/Plural_Forms\n    if (n < 3) { return n; }\n    var lastTwo = n % 100;\n    if (lastTwo >= 3 && lastTwo <= 10) return 3;\n    return lastTwo >= 11 ? 4 : 5;\n  },\n  bosnian_serbian: russianPluralGroups,\n  chinese: function () { return 0; },\n  croatian: russianPluralGroups,\n  french: function (n) { return n > 1 ? 1 : 0; },\n  german: function (n) { return n !== 1 ? 1 : 0; },\n  russian: russianPluralGroups,\n  lithuanian: function (n) {\n    if (n % 10 === 1 && n % 100 !== 11) { return 0; }\n    return n % 10 >= 2 && n % 10 <= 9 && (n % 100 < 11 || n % 100 > 19) ? 1 : 2;\n  },\n  czech: function (n) {\n    if (n === 1) { return 0; }\n    return (n >= 2 && n <= 4) ? 1 : 2;\n  },\n  polish: function (n) {\n    if (n === 1) { return 0; }\n    var end = n % 10;\n    return 2 <= end && end <= 4 && (n % 100 < 10 || n % 100 >= 20) ? 1 : 2;\n  },\n  icelandic: function (n) { return (n % 10 !== 1 || n % 100 === 11) ? 1 : 0; },\n  slovenian: function (n) {\n    var lastTwo = n % 100;\n    if (lastTwo === 1) {\n      return 0;\n    }\n    if (lastTwo === 2) {\n      return 1;\n    }\n    if (lastTwo === 3 || lastTwo === 4) {\n      return 2;\n    }\n    return 3;\n  }\n};\n\n\n// Mapping from pluralization group to individual language codes/locales.\n// Will look up based on exact match, if not found and it's a locale will parse the locale\n// for language code, and if that does not exist will default to 'en'\nvar pluralTypeToLanguages = {\n  arabic: ['ar'],\n  bosnian_serbian: ['bs-Latn-BA', 'bs-Cyrl-BA', 'srl-RS', 'sr-RS'],\n  chinese: ['id', 'id-ID', 'ja', 'ko', 'ko-KR', 'lo', 'ms', 'th', 'th-TH', 'zh'],\n  croatian: ['hr', 'hr-HR'],\n  german: ['fa', 'da', 'de', 'en', 'es', 'fi', 'el', 'he', 'hi-IN', 'hu', 'hu-HU', 'it', 'nl', 'no', 'pt', 'sv', 'tr'],\n  french: ['fr', 'tl', 'pt-br'],\n  russian: ['ru', 'ru-RU'],\n  lithuanian: ['lt'],\n  czech: ['cs', 'cs-CZ', 'sk'],\n  polish: ['pl'],\n  icelandic: ['is'],\n  slovenian: ['sl-SL']\n};\n\nfunction langToTypeMap(mapping) {\n  var ret = {};\n  forEach(mapping, function (langs, type) {\n    forEach(langs, function (lang) {\n      ret[lang] = type;\n    });\n  });\n  return ret;\n}\n\nfunction pluralTypeName(locale) {\n  var langToPluralType = langToTypeMap(pluralTypeToLanguages);\n  return langToPluralType[locale]\n    || langToPluralType[split.call(locale, /-/, 1)[0]]\n    || langToPluralType.en;\n}\n\nfunction pluralTypeIndex(locale, count) {\n  return pluralTypes[pluralTypeName(locale)](count);\n}\n\nfunction escape(token) {\n  return token.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&');\n}\n\nfunction constructTokenRegex(opts) {\n  var prefix = (opts && opts.prefix) || '%{';\n  var suffix = (opts && opts.suffix) || '}';\n\n  if (prefix === delimiter || suffix === delimiter) {\n    throw new RangeError('\"' + delimiter + '\" token is reserved for pluralization');\n  }\n\n  return new RegExp(escape(prefix) + '(.*?)' + escape(suffix), 'g');\n}\n\nvar dollarRegex = /\\$/g;\nvar dollarBillsYall = '$$';\nvar defaultTokenRegex = /%\\{(.*?)\\}/g;\n\n// ### transformPhrase(phrase, substitutions, locale)\n//\n// Takes a phrase string and transforms it by choosing the correct\n// plural form and interpolating it.\n//\n//     transformPhrase('Hello, %{name}!', {name: 'Spike'});\n//     // \"Hello, Spike!\"\n//\n// The correct plural form is selected if substitutions.smart_count\n// is set. You can pass in a number instead of an Object as `substitutions`\n// as a shortcut for `smart_count`.\n//\n//     transformPhrase('%{smart_count} new messages |||| 1 new message', {smart_count: 1}, 'en');\n//     // \"1 new message\"\n//\n//     transformPhrase('%{smart_count} new messages |||| 1 new message', {smart_count: 2}, 'en');\n//     // \"2 new messages\"\n//\n//     transformPhrase('%{smart_count} new messages |||| 1 new message', 5, 'en');\n//     // \"5 new messages\"\n//\n// You should pass in a third argument, the locale, to specify the correct plural type.\n// It defaults to `'en'` with 2 plural forms.\nfunction transformPhrase(phrase, substitutions, locale, tokenRegex) {\n  if (typeof phrase !== 'string') {\n    throw new TypeError('Polyglot.transformPhrase expects argument #1 to be string');\n  }\n\n  if (substitutions == null) {\n    return phrase;\n  }\n\n  var result = phrase;\n  var interpolationRegex = tokenRegex || defaultTokenRegex;\n\n  // allow number as a pluralization shortcut\n  var options = typeof substitutions === 'number' ? { smart_count: substitutions } : substitutions;\n\n  // Select plural form: based on a phrase text that contains `n`\n  // plural forms separated by `delimiter`, a `locale`, and a `substitutions.smart_count`,\n  // choose the correct plural form. This is only done if `count` is set.\n  if (options.smart_count != null && result) {\n    var texts = split.call(result, delimiter);\n    result = trim(texts[pluralTypeIndex(locale || 'en', options.smart_count)] || texts[0]);\n  }\n\n  // Interpolate: Creates a `RegExp` object for each interpolation placeholder.\n  result = replace.call(result, interpolationRegex, function (expression, argument) {\n    if (!has(options, argument) || options[argument] == null) { return expression; }\n    // Ensure replacement value is escaped to prevent special $-prefixed regex replace tokens.\n    return replace.call(options[argument], dollarRegex, dollarBillsYall);\n  });\n\n  return result;\n}\n\n// ### Polyglot class constructor\nfunction Polyglot(options) {\n  var opts = options || {};\n  this.phrases = {};\n  this.extend(opts.phrases || {});\n  this.currentLocale = opts.locale || 'en';\n  var allowMissing = opts.allowMissing ? transformPhrase : null;\n  this.onMissingKey = typeof opts.onMissingKey === 'function' ? opts.onMissingKey : allowMissing;\n  this.warn = opts.warn || warn;\n  this.tokenRegex = constructTokenRegex(opts.interpolation);\n}\n\n// ### polyglot.locale([locale])\n//\n// Get or set locale. Internally, Polyglot only uses locale for pluralization.\nPolyglot.prototype.locale = function (newLocale) {\n  if (newLocale) this.currentLocale = newLocale;\n  return this.currentLocale;\n};\n\n// ### polyglot.extend(phrases)\n//\n// Use `extend` to tell Polyglot how to translate a given key.\n//\n//     polyglot.extend({\n//       \"hello\": \"Hello\",\n//       \"hello_name\": \"Hello, %{name}\"\n//     });\n//\n// The key can be any string.  Feel free to call `extend` multiple times;\n// it will override any phrases with the same key, but leave existing phrases\n// untouched.\n//\n// It is also possible to pass nested phrase objects, which get flattened\n// into an object with the nested keys concatenated using dot notation.\n//\n//     polyglot.extend({\n//       \"nav\": {\n//         \"hello\": \"Hello\",\n//         \"hello_name\": \"Hello, %{name}\",\n//         \"sidebar\": {\n//           \"welcome\": \"Welcome\"\n//         }\n//       }\n//     });\n//\n//     console.log(polyglot.phrases);\n//     // {\n//     //   'nav.hello': 'Hello',\n//     //   'nav.hello_name': 'Hello, %{name}',\n//     //   'nav.sidebar.welcome': 'Welcome'\n//     // }\n//\n// `extend` accepts an optional second argument, `prefix`, which can be used\n// to prefix every key in the phrases object with some string, using dot\n// notation.\n//\n//     polyglot.extend({\n//       \"hello\": \"Hello\",\n//       \"hello_name\": \"Hello, %{name}\"\n//     }, \"nav\");\n//\n//     console.log(polyglot.phrases);\n//     // {\n//     //   'nav.hello': 'Hello',\n//     //   'nav.hello_name': 'Hello, %{name}'\n//     // }\n//\n// This feature is used internally to support nested phrase objects.\nPolyglot.prototype.extend = function (morePhrases, prefix) {\n  forEach(morePhrases, function (phrase, key) {\n    var prefixedKey = prefix ? prefix + '.' + key : key;\n    if (typeof phrase === 'object') {\n      this.extend(phrase, prefixedKey);\n    } else {\n      this.phrases[prefixedKey] = phrase;\n    }\n  }, this);\n};\n\n// ### polyglot.unset(phrases)\n// Use `unset` to selectively remove keys from a polyglot instance.\n//\n//     polyglot.unset(\"some_key\");\n//     polyglot.unset({\n//       \"hello\": \"Hello\",\n//       \"hello_name\": \"Hello, %{name}\"\n//     });\n//\n// The unset method can take either a string (for the key), or an object hash with\n// the keys that you would like to unset.\nPolyglot.prototype.unset = function (morePhrases, prefix) {\n  if (typeof morePhrases === 'string') {\n    delete this.phrases[morePhrases];\n  } else {\n    forEach(morePhrases, function (phrase, key) {\n      var prefixedKey = prefix ? prefix + '.' + key : key;\n      if (typeof phrase === 'object') {\n        this.unset(phrase, prefixedKey);\n      } else {\n        delete this.phrases[prefixedKey];\n      }\n    }, this);\n  }\n};\n\n// ### polyglot.clear()\n//\n// Clears all phrases. Useful for special cases, such as freeing\n// up memory if you have lots of phrases but no longer need to\n// perform any translation. Also used internally by `replace`.\nPolyglot.prototype.clear = function () {\n  this.phrases = {};\n};\n\n// ### polyglot.replace(phrases)\n//\n// Completely replace the existing phrases with a new set of phrases.\n// Normally, just use `extend` to add more phrases, but under certain\n// circumstances, you may want to make sure no old phrases are lying around.\nPolyglot.prototype.replace = function (newPhrases) {\n  this.clear();\n  this.extend(newPhrases);\n};\n\n\n// ### polyglot.t(key, options)\n//\n// The most-used method. Provide a key, and `t` will return the\n// phrase.\n//\n//     polyglot.t(\"hello\");\n//     => \"Hello\"\n//\n// The phrase value is provided first by a call to `polyglot.extend()` or\n// `polyglot.replace()`.\n//\n// Pass in an object as the second argument to perform interpolation.\n//\n//     polyglot.t(\"hello_name\", {name: \"Spike\"});\n//     => \"Hello, Spike\"\n//\n// If you like, you can provide a default value in case the phrase is missing.\n// Use the special option key \"_\" to specify a default.\n//\n//     polyglot.t(\"i_like_to_write_in_language\", {\n//       _: \"I like to write in %{language}.\",\n//       language: \"JavaScript\"\n//     });\n//     => \"I like to write in JavaScript.\"\n//\nPolyglot.prototype.t = function (key, options) {\n  var phrase, result;\n  var opts = options == null ? {} : options;\n  if (typeof this.phrases[key] === 'string') {\n    phrase = this.phrases[key];\n  } else if (typeof opts._ === 'string') {\n    phrase = opts._;\n  } else if (this.onMissingKey) {\n    var onMissingKey = this.onMissingKey;\n    result = onMissingKey(key, opts, this.currentLocale, this.tokenRegex);\n  } else {\n    this.warn('Missing translation for key: \"' + key + '\"');\n    result = key;\n  }\n  if (typeof phrase === 'string') {\n    result = transformPhrase(phrase, opts, this.currentLocale, this.tokenRegex);\n  }\n  return result;\n};\n\n\n// ### polyglot.has(key)\n//\n// Check if polyglot has a translation for given key\nPolyglot.prototype.has = function (key) {\n  return has(this.phrases, key);\n};\n\n// export transformPhrase\nPolyglot.transformPhrase = function transform(phrase, substitutions, locale) {\n  return transformPhrase(phrase, substitutions, locale);\n};\n\nmodule.exports = Polyglot;\n","import Polyglot from \"webix-polyglot\";\nimport {IJetApp, IJetView} from \"../interfaces\";\n\nexport function Locale(app: IJetApp, _view: IJetView, config: any){\n\tconfig = config || {};\n\tconst storage = config.storage;\n\tlet lang = storage ? (storage.get(\"lang\") || \"en\") : (config.lang || \"en\");\n\n\tfunction setLangData(name, data: any, silent?: boolean) : Promise<any>{\n\t\tif (data.__esModule) {\n\t\t\tdata = data.default;\n\t\t}\n\n\t\tconst pconfig = { phrases:data };\n\t\tif (config.polyglot){\n\t\t\tapp.webix.extend(pconfig, config.polyglot);\n\t\t}\n\n\t\tconst poly = service.polyglot = new Polyglot(pconfig);\n\t\tpoly.locale(name);\n\n\t\tservice._ = app.webix.bind(poly.t, poly);\n\t\tlang = name;\n\n\t\tif (storage){\n\t\t\tstorage.put(\"lang\", lang);\n\t\t}\n\n\t\tif (config.webix){\n\t\t\tconst locName = config.webix[name];\n\t\t\tif (locName){\n\t\t\t\tapp.webix.i18n.setLocale(locName);\n\t\t\t}\n\t\t}\n\n\t\tif (!silent){\n\t\t\treturn app.refresh();\n\t\t}\n\n\t\treturn Promise.resolve();\n\t}\n\tfunction getLang(){ return lang; }\n\tfunction setLang(name:string, silent? : boolean){\n\t\t// ignore setLang if loading by path is disabled\n\t\tif (config.path === false){\n\t\t\treturn;\n\t\t}\n\n\t\tconst path = (config.path ? config.path + \"/\" : \"\") + name;\n\t\tconst data = app.require(\"jet-locales\",path);\n\n\t\tsetLangData(name, data, silent);\n\t}\n\n\tconst service = {\n\t\tgetLang, setLang, setLangData, _:null, polyglot:null\n\t};\n\n\tapp.setService(\"locale\", service);\n\tsetLang(lang, true);\n}","import {IJetApp, IJetView} from \"../interfaces\";\n\nfunction show(view, config, value){\n\tif (config.urls){\n\t\tvalue = config.urls[value] || value;\n\t} else if (config.param){\n\t\tvalue = { [config.param]:value };\n\t}\n\n\tview.show(value);\n}\nexport function Menu(app: IJetApp, view: IJetView, config: any){\n\tconst frame = view.getSubViewInfo().parent;\n\tconst ui = view.$$(config.id || config) as any;\n\tlet silent = false;\n\n\tui.attachEvent(\"onchange\", function(){\n\t\tif (!silent){\n\t\t\tshow(frame, config, this.getValue());\n\t\t}\n\t});\n\tui.attachEvent(\"onafterselect\", function(){\n\t\tif (!silent){\n\t\t\tlet id = null;\n\t\t\tif (ui.setValue){\n\t\t\t\tid = this.getValue();\n\t\t\t} else if (ui.getSelectedId){\n\t\t\t\tid = ui.getSelectedId();\n\t\t\t}\n\t\t\tshow(frame, config, id);\n\t\t}\n\t});\n\n\tview.on(app, `app:route`, function(){\n\t\tlet name = \"\";\n\t\tif (config.param){\n\t\t\tname = view.getParam(config.param, true);\n\t\t} else {\n\t\t\tconst segment = frame.getUrl()[1];\n\t\t\tif (segment){\n\t\t\t\tname = segment.page;\n\t\t\t}\n\t\t}\n\n\t\tif (name){\n\t\t\tsilent = true;\n\t\t\tif (ui.setValue && ui.getValue() !== name){\n\t\t\t\tui.setValue(name);\n\t\t\t} else if (ui.select && ui.exists(name) && ui.getSelectedId() !== name){\n\t\t\t\tui.select(name);\n\t\t\t}\n\t\t\tsilent = false;\n\t\t}\n\t});\n}","import {IJetApp, IJetView, IWebixFacade} from \"../interfaces\";\n\nconst baseicons = {\n\tgood:\t\"check\",\n\terror: \"warning\",\n\tsaving: \"refresh fa-spin\"\n};\n\nconst basetext = {\n\tgood:\t\"Ok\",\n\terror: \"Error\",\n\tsaving: \"Connecting...\"\n};\n\nexport function Status(app: IJetApp, view: IJetView, config: any){\n\n\tlet status = \"good\";\n\tlet count = 0;\n\tlet iserror = false;\n\tlet expireDelay = config.expire;\n\tif (!expireDelay && expireDelay !== false){\n\t\texpireDelay = 2000;\n\t}\n\tconst texts = config.texts || basetext;\n\tconst icons = config.icons || baseicons;\n\n\tif (typeof config === \"string\"){\n\t\tconfig = { target:config };\n\t}\n\n\tfunction refresh(content? : string) {\n\t\tconst area = view.$$(config.target);\n\t\tif (area) {\n\t\t\tif (!content){\n\t\t\t\tcontent = \"<div class='status_\" +\n\t\t\t\t\tstatus +\n\t\t\t\t\t\"'><span class='webix_icon fa-\" +\n\t\t\t\t\ticons[status] + \"'></span> \" + texts[status] + \"</div>\";\n\t\t\t}\n\t\t\t(area as any).setHTML(content);\n\t\t}\n\t}\n\tfunction success(){\n\t\tcount--;\n\t\tsetStatus(\"good\");\n\t}\n\tfunction fail(err){\n\t\tcount--;\n\t\tsetStatus(\"error\", err);\n\t}\n\tfunction start(promise){\n\t\tcount++;\n\t\tsetStatus(\"saving\");\n\t\tif (promise && promise.then){\n\t\t\tpromise.then(success, fail);\n\t\t}\n\t}\n\tfunction getStatus(){\n\t\treturn status;\n\t}\n\tfunction hideStatus(){\n\t\tif (count === 0){\n\t\t\trefresh(\" \");\n\t\t}\n\t}\n\tfunction setStatus(mode, err?){\n\t\tif (count < 0){\n\t\t\tcount = 0;\n\t\t}\n\n\t\tif (mode === \"saving\"){\n\t\t\tstatus = \"saving\";\n\t\t\trefresh();\n\t\t} else {\n\t\t\tiserror = (mode === \"error\");\n\t\t\tif (count === 0){\n\t\t\t\tstatus = iserror ? \"error\" : \"good\";\n\t\t\t\tif (iserror){\n\t\t\t\t\tapp.error(\"app:error:server\", [err.responseText || err]);\n\t\t\t\t} else {\n\t\t\t\t\tif (expireDelay){\n\t\t\t\t\t\tsetTimeout(hideStatus, expireDelay);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\trefresh();\n\t\t\t}\n\t\t}\n\t}\n\tfunction track(data){\n\t\tconst dp = app.webix.dp(data);\n\t\tif (dp){\n\t\t\tview.on(dp, \"onAfterDataSend\", start);\n\t\t\tview.on(dp, \"onAfterSaveError\", (_id, _obj, response) => fail(response));\n\t\t\tview.on(dp, \"onAfterSave\", success);\n\t\t}\n\t}\n\n\tapp.setService(\"status\", {\n\t\tgetStatus,\n\t\tsetStatus,\n\t\ttrack\n\t});\n\n\tif (config.remote){\n\t\tview.on(app.webix, \"onRemoteCall\", start);\n\t}\n\n\tif (config.ajax){\n\t\tview.on(app.webix, \"onBeforeAjax\",\n\t\t\t(_mode, _url, _data, _request, _headers, _files, promise) => {\n\t\t\t\tstart(promise);\n\t\t});\n\t}\n\n\tif (config.data){\n\t\ttrack(config.data);\n\t}\n}","import {IJetApp, IJetView, IWebixFacade} from \"../interfaces\";\n\nexport function Theme(app: IJetApp, _view: IJetView, config: any){\n\tconfig = config || {};\n\tconst storage = config.storage;\n\tlet theme = storage ?\n\t\t(storage.get(\"theme\")||\"flat-default\")\n\t\t:\n\t\t(config.theme || \"flat-default\");\n\n\tconst service = {\n\t\tgetTheme(){ return theme; },\n\t\tsetTheme(name:string, silent?:boolean){\n\t\t\tconst parts = name.split(\"-\");\n\t\t\tconst links = document.getElementsByTagName(\"link\");\n\n\t\t\tfor (let i=0; i<links.length; i++){\n\t\t\t\tconst lname = links[i].getAttribute(\"title\");\n\t\t\t\tif (lname){\n\t\t\t\t\tif (lname === name || lname === parts[0]){\n\t\t\t\t\t\tlinks[i].disabled = false;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tlinks[i].disabled = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t(app.webix as any).skin.set(parts[0]);\n\t\t\t// remove old css\n\t\t\tapp.webix.html.removeCss(document.body, \"theme-\"+theme);\n\t\t\t// add new css\n\t\t\tapp.webix.html.addCss(document.body, \"theme-\"+name);\n\n\t\t\ttheme = name;\n\t\t\tif (storage){\n\t\t\t\tstorage.put(\"theme\", name);\n\t\t\t}\n\t\t\tif (!silent){\n\t\t\t\tapp.refresh();\n\t\t\t}\n\t\t}\n\t};\n\n\tapp.setService(\"theme\", service);\n\tservice.setTheme(theme, true);\n}","import {IJetApp, IJetURL, IJetView, IRoute, IWebixFacade} from \"../interfaces\";\n\nfunction copyParams(data: any, url:IJetURL, route:string[]){\n\tfor (let i = 0; i < route.length; i++){\n\t\tdata[route[i]] = url[i+1] ? url[i+1].page : \"\";\n\t}\n}\n\nexport function UrlParam(app: IJetApp, view: IJetView, config: any){\n\tconst route = config.route || config;\n\tconst data = {};\n\tconst seg = null;\n\n\tview.on(app, \"app:urlchange\", function(subview, segment:IRoute){\n\t\tif (view === subview){\n\t\t\tcopyParams(data, segment.suburl(), route);\n\t\t\tsegment.size(route.length+1);\n\t\t}\n\t});\n\n\tconst os = view.setParam;\n\tconst og = view.getParam;\n\n\tview.setParam = function(name, value, show){\n\t\tconst index = route.indexOf(name);\n\t\tif (index >= 0){\n\t\t\tdata[name] = value;\n\t\t\tthis._segment.update(\"\", value, index+1);\n\t\t\tif (show){\n\t\t\t\treturn view.show(null);\n\t\t\t}\n\t\t} else {\n\t\t\treturn os.call(this, name, value, show);\n\t\t}\n\t};\n\n\tview.getParam = function(key, mode){\n\t\tconst val = data[key];\n\t\tif (typeof val !== \"undefined\") { return val; }\n\t\treturn og.call(this, key, mode);\n\t};\n\n\tcopyParams(data, view.getUrl(), route);\n}\n","import {IJetApp, IJetView} from \"../interfaces\";\n\nexport function User(app: IJetApp, _view: IJetView, config: any){\n\tconfig = config || {};\n\n\tconst login = config.login || \"/login\";\n\tconst logout = config.logout || \"/logout\";\n\tconst afterLogin = config.afterLogin || app.config.start;\n\tconst afterLogout = config.afterLogout || \"/login\";\n\tconst ping = config.ping || 5*60*1000;\n\tconst model = config.model;\n\tlet user = config.user;\n\n\tconst service = {\n\t\tgetUser(){\n\t\t\treturn user;\n\t\t},\n\t\tgetStatus(server? : boolean){\n\t\t\tif (!server){\n\t\t\t\treturn user !== null;\n\t\t\t}\n\n\t\t\treturn model.status().catch(() => null).then(data => {\n\t\t\t\tuser = data;\n\t\t\t});\n\t\t},\n\t\tlogin(name:string, pass:string){\n\t\t\treturn model.login(name, pass).then(data => {\n\t\t\t\tuser = data;\n\t\t\t\tif (!data){\n\t\t\t\t\tthrow new Error(\"Access denied\");\n\t\t\t\t}\n\n\t\t\t\tapp.callEvent(\"app:user:login\", [ user ]);\n\t\t\t\tapp.show(afterLogin);\n\t\t\t});\n\t\t},\n\t\tlogout(){\n\t\t\tuser = null;\n\t\t\treturn model.logout().then(res => {\n\t\t\t\tapp.callEvent(\"app:user:logout\",[]);\n\t\t\t\treturn res;\n\t\t\t});\n\t\t}\n\t};\n\n\tfunction canNavigate(url, obj){\n\t\tif (url === logout){\n\t\t\tservice.logout();\n\t\t\tobj.redirect = afterLogout;\n\t\t} else if (url !== login && !service.getStatus()){\n\t\t\tobj.redirect = login;\n\t\t}\n\t}\n\n\tapp.setService(\"user\", service);\n\n\tapp.attachEvent(`app:guard`, function(url: string, _$root: any, obj:any){\n\t\tif (config.public && config.public(url)){\n\t\t\treturn true;\n\t\t}\n\n\t\tif (typeof user === \"undefined\"){\n\t\t\tobj.confirm = service.getStatus(true).then(() => canNavigate(url, obj));\n\t\t}\n\n\t\treturn canNavigate(url, obj);\n\t});\n\n\tif (ping){\n\t\tsetInterval(() => service.getStatus(true), ping);\n\t}\n}","/*\nMIT License\nCopyright (c) 2019 XB Software\n*/\n\nimport { IJetApp, IJetView } from \"./interfaces\";\nexport { IJetApp, IJetView };\n\nimport {NavigationBlocked} from \"./errors\";\n\nexport { JetApp } \t\tfrom \"./JetApp\";\nexport { JetView } \t\tfrom \"./JetView\";\n\nexport { HashRouter } \tfrom \"./routers/HashRouter\";\nexport { StoreRouter }\tfrom \"./routers/StoreRouter\";\nexport { UrlRouter } \tfrom \"./routers/UrlRouter\";\nexport { EmptyRouter } \tfrom \"./routers/EmptyRouter\";\nexport { SubRouter } \tfrom \"./routers/SubRouter\";\n\nimport {UnloadGuard} \tfrom \"./plugins/Guard\";\nimport {Locale} \t\tfrom \"./plugins/Locale\";\nimport {Menu} \t\t\tfrom \"./plugins/Menu\";\nimport {Status} \t\tfrom \"./plugins/Status\";\nimport {Theme} \t\t\tfrom \"./plugins/Theme\";\nimport {UrlParam}\t\tfrom \"./plugins/UrlParam\";\nimport {User} \t\t\tfrom \"./plugins/User\";\n\nimport patch from \"./patch\";\nlet webix = (window as any).webix;\nif (webix){\n\tpatch(webix);\n}\n\nexport const plugins = {\n\tUnloadGuard, Locale, Menu, Theme, User, Status, UrlParam\n};\n\nexport const errors = { NavigationBlocked };\n\nconst w = window as any;\nif (!w.Promise){\n\tw.Promise = w.webix.promise;\n}"],"names":["tslib_1.__extends","Polyglot"],"mappings":"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"}