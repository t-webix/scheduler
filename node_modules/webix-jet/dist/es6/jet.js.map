{"version":3,"file":"jet.js","sources":["../../sources/errors.ts","../../sources/JetBase.ts","../../sources/helpers.ts","../../sources/Route.ts","../../sources/JetView.ts","../../sources/JetViewRaw.ts","../../sources/routers/SubRouter.ts","../../sources/JetAppBase.ts","../../sources/routers/HashRouter.ts","../../sources/patch.ts","../../sources/JetApp.ts","../../sources/routers/StoreRouter.ts","../../sources/routers/UrlRouter.ts","../../sources/routers/EmptyRouter.ts","../../sources/plugins/Guard.ts","../../node_modules/webix-polyglot/index.js","../../sources/plugins/Locale.ts","../../sources/plugins/Menu.ts","../../sources/plugins/Status.ts","../../sources/plugins/Theme.ts","../../sources/plugins/UrlParam.ts","../../sources/plugins/User.ts","../../sources/index.ts"],"sourcesContent":["export class NavigationBlocked {}","import { IBaseView, IJetApp, IJetURL, IJetView,\n\tIRoute, ISubView, ISubViewInfo, IWebixFacade, IHash } from \"./interfaces\";\n\nexport abstract class JetBase implements IJetView{\n\tpublic app: IJetApp;\n\tpublic webix: IWebixFacade;\n\tpublic webixJet = true;\n\n\tprotected _name: string;\n\tprotected _parent: IJetView;\n\tprotected _container: HTMLElement | ISubView;\n\tprotected _root: IBaseView;\n\tprotected _events:{ id:string, obj: any }[];\n\tprotected _subs:{[name:string]:ISubView};\n\tprotected _initUrl:IJetURL;\n\tprotected _segment: IRoute;\n\n\tprivate _data:{[name:string]:any};\n\t\n\n\tconstructor(webix:IWebixFacade, config?:any){\n\t\tthis.webix = webix;\n\t\tthis._events = [];\n\t\tthis._subs = {};\n\t\tthis._data = {};\n\n\t\tif (config && config.params) \n\t\t\twebix.extend(this._data, config.params);\n\t}\n\n\tgetRoot(): IBaseView {\n\t\treturn this._root;\n\t}\n\n\tdestructor() {\n\t\tthis._detachEvents();\n\t\tthis._destroySubs();\n\t\tthis._events = this._container = this.app = this._parent = this._root = null;\n\t}\n\tsetParam(id:string, value:any, url?:boolean):void|Promise<any>{\n\t\tif (this._data[id] !== value){\n\t\t\tthis._data[id] = value;\n\t\t\tthis._segment.update(id, value, 0);\n\t\t\tif (url){\n\t\t\t\treturn this.show(null);\n\t\t\t}\n\t\t}\n\t}\n\tgetParam(id:string, parent:boolean):any{\n\t\tconst value = this._data[id];\n\t\tif (typeof value !== \"undefined\" || !parent){\n\t\t\treturn value;\n\t\t}\n\n\t\tconst view = this.getParentView();\n\t\tif (view){\n\t\t\treturn view.getParam(id, parent);\n\t\t}\n\t}\n\tgetUrl():IJetURL{\n\t\treturn this._segment.suburl();\n\t}\n\tgetUrlString():string{\n\t\treturn this._segment.toString();\n\t}\n\n\tgetParentView() : IJetView{\n\t\treturn this._parent;\n\t}\n\n\t$$(id:string | IBaseView):IBaseView{\n\t\tif (typeof id === \"string\"){\n\t\t\tconst root = this.getRoot() as any;\n\t\t\treturn root.queryView(\n\t\t\t\t(obj => (obj.config.id === id || obj.config.localId === id) &&\n\t\t\t\t\t\t(obj.$scope === root.$scope)\n\t\t\t\t),\n\t\t\t\t\"self\");\n\t\t} else {\n\t\t\treturn id;\n\t\t}\n\t}\n\n\ton(obj, name, code){\n\t\tconst id = obj.attachEvent(name, code);\n\t\tthis._events.push({ obj, id });\n\t\treturn id;\n\t}\n\n\tcontains(view: IJetView){\n\t\tfor (const key in this._subs){\n\t\t\tconst kid = this._subs[key].view;\n\t\t\tif (kid === view || kid.contains(view)){\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\n\tgetSubView(name?:string):IJetView{\n\t\tconst sub = this.getSubViewInfo(name);\n\t\tif (sub){\n\t\t\treturn sub.subview.view;\n\t\t}\n\t}\n\n\tgetSubViewInfo(name?:string):ISubViewInfo{\n\t\tconst sub = this._subs[name || \"default\"];\n\t\tif (sub){\n\t\t\treturn { subview:sub, parent:this };\n\t\t}\n\n\t\tif (name === \"_top\"){\n\t\t\tthis._subs[name] = { url:\"\", id:null, popup:true };\n\t\t\treturn this.getSubViewInfo(name);\n\t\t}\n\n\t\t// when called from a child view, searches for nearest parent with subview\n\t\tif (this._parent){\n\t\t\treturn this._parent.getSubViewInfo(name);\n\t\t}\n\t\treturn null;\n\t}\n\n\tpublic abstract refresh();\n\tpublic abstract show(path:any, config?:any);\n\tpublic abstract render(\n\t\troot?: string | HTMLElement | ISubView,\n\t\turl?: IRoute, parent?: IJetView): Promise<IBaseView>;\n\n\tprotected _detachEvents(){\n\t\tconst events = this._events;\n\t\tfor (let i = events.length - 1; i >= 0; i--){\n\t\t\tevents[i].obj.detachEvent(events[i].id);\n\t\t}\n\t}\n\tprotected _destroySubs(){\n\t\t// destroy sub views\n\t\tfor (const key in this._subs){\n\t\t\tconst subView = this._subs[key].view;\n\t\t\t// it possible that subview was not loaded with any content yet\n\t\t\t// so check on null\n\t\t\tif (subView){\n\t\t\t\tsubView.destructor();\n\t\t\t}\n\t\t}\n\n\t\t// reset to prevent memory leaks\n\t\tthis._subs = {};\n\t}\n\tprotected _init_url_data(){\n\t\tconst url = this._segment.current();\n\t\tthis._data = {};\n\t\tthis.webix.extend(this._data, url.params, true);\n\t}\n\n\tprotected _getDefaultSub(){\n\t\tif (this._subs.default){\n\t\t\treturn this._subs.default;\n\t\t}\n\t\tfor (const key in this._subs){\n\t\t\tconst sub = this._subs[key];\n\t\t\tif (!sub.branch && sub.view && key !== \"_top\"){\n\t\t\t\tconst child = (sub.view as JetBase)._getDefaultSub();\n\t\t\t\tif (child){\n\t\t\t\t\treturn child;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected _routed_view() {\n\t\tconst parent = this.getParentView() as JetBase;\n\t\tif (!parent){\n\t\t\treturn true;\n\t\t}\n\n\t\tconst sub = parent._getDefaultSub();\n\t\tif (!sub && sub !== this){\n\t\t\treturn false;\n\t\t}\n\n\t\treturn parent._routed_view();\n\t}\n\n\t\n}\n","import {IJetURLChunk} from \"./interfaces\";\n\n\nexport function parse(url:string):IJetURLChunk[]{\n\t// remove starting /\n\tif (url[0] === \"/\"){\n\t\turl = url.substr(1);\n\t}\n\n\t// split url by \"/\"\n\tconst parts = url.split(\"/\");\n\tconst chunks:IJetURLChunk[] = [];\n\n\t// for each page in url\n\tfor (let i = 0; i < parts.length; i++){\n\t\tconst test = parts[i];\n\t\tconst result = {};\n\n\t\t// detect params\n\t\t// support old \t\t\tsome:a=b:c=d\n\t\t// and new notation\t\tsome?a=b&c=d\n\t\tlet pos = test.indexOf(\":\");\n\t\tif (pos === -1){\n\t\t\tpos = test.indexOf(\"?\");\n\t\t}\n\n\t\tif (pos !== -1){\n\t\t\tconst params = test.substr(pos+1).split(/[\\:\\?\\&]/g);\n\t\t\t// create hash of named params\n\t\t\tfor (const param of params) {\n\t\t\t\tconst dchunk = param.split(\"=\");\n\t\t\t\tresult[dchunk[0]] = decodeURIComponent(dchunk[1]);\n\t\t\t}\n\t\t}\n\n\t\t// store parsed values\n\t\tchunks[i] = {\n\t\t\tpage: (pos > -1 ? test.substr(0, pos) : test),\n\t\t\tparams:result,\n\t\t\tisNew:true\n\t\t};\n\t}\n\n\t// return array of page objects\n\treturn chunks;\n}\n\nexport function url2str(stack:IJetURLChunk[]):string{\n\tconst url = [];\n\n\tfor (const chunk of stack){\n\t\turl.push(\"/\"+chunk.page);\n\t\tconst params = obj2str(chunk.params);\n\t\tif (params){\n\t\t\turl.push(\"?\"+params);\n\t\t}\n\t}\n\n\treturn url.join(\"\");\n}\n\nfunction obj2str(obj){\n\tconst str = [];\n\tfor (const key in obj){\n\t\tif (typeof obj[key] === \"object\") continue;\n\t\tif (str.length){\n\t\t\tstr.push(\"&\");\n\t\t}\n\t\tstr.push(key+\"=\"+encodeURIComponent(obj[key]));\n\t}\n\n\treturn str.join(\"\");\n}","import { IJetURL, IJetView, IPath, IRoute, IJetURLChunk, IJetUrlTarget } from \"./interfaces\";\nimport {NavigationBlocked} from \"./errors\";\n\nimport {parse, url2str} from \"./helpers\";\n\nexport class Route implements IRoute{\n\tpublic route: IPath;\n\tprivate index: number;\n\tprivate _next: number = 1;\n\n\tconstructor(route: string|IPath, index: number){\n\t\tif (typeof route === \"string\"){\n\t\t\tthis.route = {\n\t\t\t\turl:parse(route),\n\t\t\t\tpath: route\n\t\t\t};\n\t\t} else {\n\t\t\tthis.route = route;\n\t\t}\n\n\t\tthis.index = index;\n\t}\n\tcurrent():IJetURLChunk{\n\t\treturn this.route.url[this.index];\n\t}\n\tnext():IJetURLChunk{\n\t\treturn this.route.url[this.index + this._next];\n\t}\n\n\tsuburl():IJetURL{\n\t\treturn this.route.url.slice(this.index);\n\t}\n\tshift(params) {\n\t\tconst route = new Route(this.route, this.index + this._next);\n\t\troute.setParams(route.route.url, params, route.index);\n\t\treturn route;\n\t}\n\tsetParams(url, params, index) {\n\t\tif (params) {\n\t\t\tconst old = url[index].params;\n\t\t\tfor (var key in params) old[key] = params[key];\n\t\t}\n\t}\n\trefresh(){\n\t\tconst url = this.route.url;\n\t\tfor (let i=this.index+1; i<url.length; i++){\n\t\t\turl[i].isNew = true;\n\t\t}\n\t}\n\ttoString(){\n\t\tconst str = url2str(this.suburl());\n\t\treturn str ? str.substr(1) : \"\";\n\t}\n\t_join(path: string, kids?: boolean){\n\t\tlet url = this.route.url;\n\t\tif (path === null){ // change of parameters, route elements are not affected\n\t\t\treturn url;\n\t\t}\n\n\t\tconst old = this.route.url;\n\t\tlet reset = true;\n\t\turl = old.slice(0, this.index+(kids?this._next:0));\n\t\tif (path){\n\t\t\turl = url.concat(parse(path));\n\n\t\t\tfor (let i=0; i<url.length; i++){\n\t\t\t\tif (old[i]){\n\t\t\t\t\turl[i].view = old[i].view;\n\t\t\t\t}\n\t\t\t\tif (reset && old[i] && url[i].page === old[i].page) {\n\t\t\t\t\turl[i].isNew = false;\n\t\t\t\t} else if (url[i].isNew) {\n\t\t\t\t\t// if some segment was marked as new, all subsegments must be updated as well\n\t\t\t\t\treset = false;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn url;\n\t}\n\n\tappend(path:string):string{\n\t\tconst url = this._join(path, true);\n\t\tthis.route.path = url2str(url);\n\t\tthis.route.url = url;\n\n\t\treturn this.route.path;\n\t}\n\n\tshow(path:IJetUrlTarget, view:IJetView, kids?: boolean):Promise<void>{\n\t\tconst url = this._join(path.url, kids);\n\t\tthis.setParams(url, path.params, this.index + (kids ? this._next : 0));\n\t\t\n\n\t\treturn new Promise((res, rej) => {\n\t\t\tconst redirect = url2str(url);\n\t\t\tconst obj = {\n\t\t\t\turl,\n\t\t\t\tredirect,\n\t\t\t\tconfirm: Promise.resolve()\n\t\t\t};\n\n\t\t\tconst app = view ? view.app : null;\n\t\t\t// when creating a new route, it possible that it will not have any content\n\t\t\t// guard is not necessary in such case\n\t\t\tif (app){\n\t\t\t\tconst result = app.callEvent(\"app:guard\", [obj.redirect, view, obj]);\n\t\t\t\tif (!result){\n\t\t\t\t\trej(new NavigationBlocked());\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tlet err;\n\t\t\tobj.confirm.catch(err => rej(err)).then(() => {\n\t\t\t\tif (obj.redirect === null){\n\t\t\t\t\trej(new NavigationBlocked());\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (obj.redirect !== redirect){\n\t\t\t\t\tapp.show(obj.redirect);\n\t\t\t\t\trej(new NavigationBlocked());\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tthis.route.path = redirect;\n\t\t\t\tthis.route.url = url;\n\t\t\t\tres();\n\t\t\t});\n\t\t});\n\t}\n\tsize(n:number){\n\t\tthis._next = n;\n\t}\n\tsplit():IRoute{\n\t\tconst route = {\n\t\t\turl: this.route.url.slice(this.index+1),\n\t\t\tpath:\"\"\n\t\t};\n\n\t\tif (route.url.length){\n\t\t\troute.path = url2str(route.url);\n\t\t}\n\n\t\treturn new Route(route, 0);\n\t}\n\tupdate(name:string, value: string, index?:number){\n\t\tconst chunk = this.route.url[this.index + (index || 0)];\n\t\tif (!chunk){\n\t\t\tthis.route.url.push({ page:\"\", params:{} });\n\t\t\treturn this.update(name, value, index);\n\t\t}\n\n\t\tif (name === \"\"){\n\t\t\tchunk.page = value;\n\t\t} else {\n\t\t\tchunk.params[name] = value;\n\t\t}\n\n\t\tthis.route.path = url2str(this.route.url);\n\t}\n}","import {JetBase} from \"./JetBase\";\n\nimport {\n\tIBaseConfig, IBaseView, IJetApp, IJetURL,\n\tIJetView, IJetViewFactory, ISubView, IUIConfig, IRoute, IJetUrlTarget } from \"./interfaces\";\nimport { Route } from \"./Route\";\n\n\nexport class JetView extends JetBase{\n\tprivate _children:IJetView[];\n\n\tconstructor(app : IJetApp, config : any){\n\t\tsuper(app.webix);\n\n\t\tthis.app = app;\n\t\t//this.$config = config;\n\n\t\tthis._children = [];\n\t}\n\n\tui(\n\t\tui:IBaseConfig|IJetViewFactory,\n\t\tconfig?: IUIConfig\n\t) : IBaseView | IJetView{\n\t\tconfig = config || {};\n\t\tconst container = config.container || (ui as IBaseConfig).container;\n\n\t\tconst jetview = this.app.createView(ui);\n\t\tthis._children.push(jetview);\n\n\t\tjetview.render(container, this._segment, this);\n\n\t\tif (typeof ui !== \"object\" || (ui instanceof JetBase)){\n\t\t\t// raw webix UI\n\t\t\treturn jetview;\n\t\t} else {\n\t\t\treturn jetview.getRoot();\n\t\t}\n\t}\n\n\tshow(path:any, config?:any):Promise<any>{\n\t\tconfig = config || {};\n\n\t\t// convert parameters object to url\n\t\tif (typeof path === \"object\"){\n\t\t\tfor (const key in path){\n\t\t\t\tthis.setParam(key, path[key]);\n\t\t\t}\n\t\t\tpath = null;\n\t\t} else {\n\n\t\t\t// deligate to app in case of root prefix\n\t\t\tif (path.substr(0,1) === \"/\"){\n\t\t\t\treturn this.app.show(path, config);\n\t\t\t}\n\n\t\t\t// local path, do nothing\n\t\t\tif (path.indexOf(\"./\") === 0){\n\t\t\t\tpath = path.substr(2);\n\t\t\t}\n\n\t\t\t// parent path, call parent view\n\t\t\tif (path.indexOf(\"../\") === 0){\n\t\t\t\tconst parent = this.getParentView();\n\t\t\t\tif (parent){\n\t\t\t\t\treturn parent.show(path.substr(3), config);\n\t\t\t\t} else {\n\t\t\t\t\treturn this.app.show(\"/\"+path.substr(3));\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst sub = this.getSubViewInfo(config.target);\n\t\t\tif (sub){\n\t\t\t\tif (sub.parent !== this){\n\t\t\t\t\treturn sub.parent.show(path, config);\n\t\t\t\t} else if (config.target && config.target !== \"default\"){\n\t\t\t\t\treturn this._renderFrameLock(config.target, sub.subview, {\n\t\t\t\t\t\turl: path,\n\t\t\t\t\t\tparams: config.params,\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif (path){\n\t\t\t\t\treturn this.app.show(\"/\" + path, config);\n\t\t\t\t} \n\t\t\t}\n\n\t\t}\n\n\t\treturn this._show(\n\t\t\tthis._segment,\n\t\t\t{ url: path, params: config.params },\n\t\t\tthis\n\t\t);\n\t}\n\n\t_show(segment:IRoute, path:IJetUrlTarget, view:IJetView){\n\t\treturn segment.show(path, view, true).then(() => {\n\t\t\tthis._init_url_data();\n\t\t\treturn this._urlChange();\n\t\t}).then(() => {\n\t\t\tif (segment.route.linkRouter){\n\t\t\t\tthis.app.getRouter().set(segment.route.path, { silent: true });\n\t\t\t\tthis.app.callEvent(\"app:route\", [segment.route.path]);\n\t\t\t}\n\t\t});\n\t}\n\n\tinit(_$view:IBaseView, _$: IJetURL){\n\t\t// stub\n\t}\n\tready(_$view:IBaseView, _$url: IJetURL){\n\t\t// stub\n\t}\n\tconfig() : any {\n\t\tthis.app.webix.message(\"View:Config is not implemented\");\n\t}\n\turlChange(_$view: IBaseView, _$url : IJetURL){\n\t\t// stub\n\t}\n\n\tdestroy(){\n\t\t// stub\n\t}\n\n\tdestructor(){\n\t\tthis.destroy();\n\t\tthis._destroyKids();\n\n\t\t// destroy actual UI\n\t\tif (this._root) {\n\t\t\tthis._root.destructor();\n\t\t\tsuper.destructor();\n\t\t}\n\t}\n\n\tuse(plugin, config){\n\t\tplugin(this.app, this, config);\n\t}\n\n\trefresh(){\n\t\tconst url = this.getUrl();\n\t\tthis.destroy();\n\t\tthis._destroyKids();\n\t\tthis._destroySubs();\n\t\tthis._detachEvents();\n\n\t\tif ((this._container as any).tagName){\n\t\t\tthis._root.destructor();\n\t\t}\n\n\t\tthis._segment.refresh();\n\t\treturn this._render(this._segment);\n\t}\n\n\trender(\n\t\troot: string | HTMLElement | ISubView,\n\t\turl: IRoute, parent?: IJetView): Promise<IBaseView> {\n\n\t\tif (typeof url === \"string\"){\n\t\t\turl = new Route(url, 0);\n\t\t}\n\n\t\tthis._segment = url;\n\n\t\tthis._parent = parent;\n\t\tthis._init_url_data();\n\n\t\troot = root || document.body;\n\t\tconst _container = (typeof root === \"string\") ? this.webix.toNode(root) : root;\n\n\t\tif (this._container !== _container) {\n\t\t\tthis._container = _container;\n\t\t\treturn this._render(url);\n\t\t} else {\n\t\t\treturn this._urlChange().then(() => this.getRoot());\n\t\t}\n\t}\n\n\tprotected _render(url: IRoute):Promise<IBaseView>{\n\t\tconst config = this.config();\n\t\tif (config.then){\n\t\t\treturn config.then(cfg => this._render_final(cfg, url));\n\t\t} else {\n\t\t\treturn this._render_final(config, url);\n\t\t}\n\t}\n\n\tprotected _render_final(config:any, url:IRoute):Promise<any>{\n\t\t// get previous view in the same slot\n\t\tlet slot:ISubView = null;\n\t\tlet container:string|HTMLElement|IBaseView = null;\n\t\tlet show = false;\n\t\tif (!(this._container as HTMLElement).tagName){\n\t\t\tslot = (this._container as ISubView);\n\t\t\tif (slot.popup){\n\t\t\t\tcontainer = document.body;\n\t\t\t\tshow = true;\n\t\t\t} else {\n\t\t\t\tcontainer = this.webix.$$(slot.id);\n\t\t\t}\n\t\t} else {\n\t\t\tcontainer = this._container as HTMLElement;\n\t\t}\n\n\t\t// view already destroyed\n\t\tif (!this.app || !container){\n\t\t\treturn Promise.reject(null);\n\t\t}\n\n\t\tlet response:Promise<any>;\n\t\tconst current = this._segment.current();\n\n\t\t// using wrapper object, so ui can be changed from app:render event\n\t\tconst result:any = { ui: {} };\n\t\tthis.app.copyConfig(config, result.ui, this._subs);\n\t\tthis.app.callEvent(\"app:render\", [this, url, result]);\n\t\tresult.ui.$scope = this;\n\n\t\t/* destroy old HTML attached views before creating new one */\n\t\tif (!slot && current.isNew && current.view){\n\t\t\tcurrent.view.destructor();\n\t\t}\n\n\t\ttry {\n\t\t\t// special handling for adding inside of multiview - preserve old id\n\t\t\tif (slot && !show){\n\t\t\t\tconst oldui = container as IBaseView;\n\t\t\t\tconst parent = oldui.getParentView();\n\t\t\t\tif (parent && parent.name === \"multiview\" && !result.ui.id){\n\t\t\t\t\tresult.ui.id = oldui.config.id;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis._root = this.app.webix.ui(result.ui, container);\n\t\t\tconst asWin = this._root as any;\n\t\t\t// check for url added to ignore this.ui calls\n\t\t\tif (show && asWin.setPosition && !asWin.isVisible()){\n\t\t\t\tasWin.show();\n\t\t\t}\n\n\t\t\t// check, if we are replacing some older view\n\t\t\tif (slot){\n\t\t\t\tif (slot.view && slot.view !== this && slot.view !== this.app){\n\t\t\t\t\tslot.view.destructor();\n\t\t\t\t}\n\n\t\t\t\tslot.id = this._root.config.id as string;\n\t\t\t\tif (this.getParentView() || !this.app.app)\n\t\t\t\t\tslot.view = this;\n\t\t\t\telse {\n\t\t\t\t\t// when we have subapp, set whole app as a view\n\t\t\t\t\t// so on destruction, the whole app will be destroyed\n\t\t\t\t\tslot.view = this.app as any;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (current.isNew){\n\t\t\t\tcurrent.view = this;\n\t\t\t\tcurrent.isNew = false;\n\t\t\t}\n\n\t\t\tresponse = Promise.resolve(this._init(this._root, url)).then(() => {\n\t\t\t\treturn this._urlChange().then(() => {\n\t\t\t\t\tthis._initUrl = null;\n\t\t\t\t\treturn this.ready(this._root, url.suburl());\n\t\t\t\t});\n\t\t\t});\n\t\t} catch(e){\n\t\t\tresponse = Promise.reject(e);\n\t\t}\n\n\t\treturn response.catch(err => this._initError(this, err));\n\t}\n\n\tprotected _init(view:IBaseView, url: IRoute){\n\t\treturn this.init(view, url.suburl());\n\t}\n\n\tprotected _urlChange():Promise<any>{\n\t\tthis.app.callEvent(\"app:urlchange\", [this, this._segment]);\n\n\t\tconst waits = [];\n\t\tfor (const key in this._subs){\n\t\t\tconst frame = this._subs[key];\n\t\t\tconst wait = this._renderFrameLock(key, frame, null);\n\t\t\tif (wait){\n\t\t\t\twaits.push(wait);\n\t\t\t}\n\t\t}\n\n\t\treturn Promise.all(waits).then(() => {\n\t\t\treturn this.urlChange(this._root, this._segment.suburl());\n\t\t});\n\t}\n\n\tprotected  _renderFrameLock(key:string, frame:ISubView, path: IJetUrlTarget):Promise<any>{\n\t\t// if subview is not occupied by some rendering yet\n\t\tif (!frame.lock) {\n\t\t\t// retreive and store rendering end promise\n\t\t\tconst lock =  this._renderFrame(key, frame, path);\n\t\t\tif (lock){\n\t\t\t\t// clear lock after frame rendering\n\t\t\t\t// as promise.finally is not supported by  Webix lesser than 6.2\n\t\t\t\t// using a more verbose notation\n\t\t\t\tframe.lock = lock.then(() => frame.lock = null, () => frame.lock = null)\n\t\t\t}\n\t\t}\n\n\t\t// return rendering end promise\n\t\treturn frame.lock;\n\t}\n\n\tprotected _renderFrame(key:string, frame:ISubView, path: IJetUrlTarget):Promise<any>{\n\t\t//default route\n\t\tif (key === \"default\"){\n\t\t\tif (this._segment.next()){\n\t\t\t\t// we have a next segment in url, render it\n\t\t\t\tlet params = path ? path.params : null;\n\t\t\t\tif (frame.params) {\n\t\t\t\t\tparams = this.webix.extend(params || {}, frame.params);\n\t\t\t\t}\n\t\t\t\treturn this._createSubView(frame, this._segment.shift(params));\n\t\t\t} else if (frame.view && frame.popup) {\n\t\t\t\t// there is no next segment, delete the existing sub-view\n\t\t\t\tframe.view.destructor();\n\t\t\t\tframe.view = null;\n\t\t\t}\n\t\t}\n\t\t\n\t\t//if new path provided, set it to the frame\n\t\tif (path !== null){\n\t\t\tframe.url = path.url;\n\t\t\tif (frame.params) {\n\t\t\t\tpath.params = this.webix.extend(path.params || {}, frame.params);\n\t\t\t}\n\t\t}\n\n\t\t// in case of routed sub-view\n\t\tif (frame.route){\n\t\t\t// we have a new path for sub-view\n\t\t\tif (path !== null){\n\t\t\t\treturn frame.route.show(path, frame.view).then(() => {\n\t\t\t\t\treturn this._createSubView(frame, frame.route);\n\t\t\t\t});\n\t\t\t}\n\n\t\t\t// do not trigger onChange for isolated sub-views\n\t\t\tif (frame.branch){\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tlet view = frame.view;\n\t\t// if view doesn't exists yet, init it\n\t\tif (!view && frame.url){\n\t\t\tif (typeof frame.url === \"string\"){\n\t\t\t\t// string, so we have isolated subview url\n\t\t\t\tframe.route = new Route(frame.url, 0);\n\t\t\t\tif (path) frame.route.setParams(frame.route.route.url, path.params, 0);\n\t\t\t\tif (frame.params)\n\t\t\t\t\tframe.route.setParams(frame.route.route.url, frame.params, 0);\n\t\t\t\treturn this._createSubView(frame, frame.route);\n\t\t\t} else {\n\t\t\t\t// object, so we have an embeded subview\n\t\t\t\tif (typeof frame.url === \"function\" && !(view instanceof frame.url)){\n\t\t\t\t\tview = new ((this.app as any)._override(frame.url))(this.app, \"\");\n\t\t\t\t}\n\t\t\t\tif (!view){\n\t\t\t\t\tview = frame.url as any;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// trigger onChange for already existed view\n\t\tif (view){\n\t\t\treturn view.render(frame, (frame.route || this._segment), this);\n\t\t}\n\t}\n\n\tprivate _initError(view: any, err: any){\n\t\t/*\n\t\t\tif view is destroyed, ignore any view related errors\n\t\t*/\n\t\tif (this.app){\n\t\t\tthis.app.error(\"app:error:initview\", [err, view]);\n\t\t}\n\t\treturn true;\n\t}\n\n\tprivate _createSubView(\n\t\t\t\t\tsub:ISubView,\n\t\t\t\t\tsuburl:IRoute):Promise<IBaseView>{\n\t\treturn this.app.createFromURL(suburl.current()).then(view => {\n\t\t\treturn view.render(sub, suburl, this);\n\t\t});\n\t}\n\n\tprivate _destroyKids(){\n\t\t// destroy child views\n\t\tconst uis = this._children;\n\t\tfor (let i = uis.length - 1; i >= 0; i--){\n\t\t\tif (uis[i] && uis[i].destructor){\n\t\t\t\tuis[i].destructor();\n\t\t\t}\n\t\t}\n\n\t\t// reset vars for better GC processing\n\t\tthis._children = [];\n\t}\n}","import {IJetApp} from \"./interfaces\";\nimport {JetView} from \"./JetView\";\n\n\n// wrapper for raw objects and Jet 1.x structs\nexport class JetViewRaw extends JetView{\n\tprivate _ui:any;\n\n\tconstructor(app:IJetApp, config:any){\n\t\tsuper(app, config);\n\t\tthis._ui = config.ui;\n\t}\n\n\tconfig(){\n\t\treturn this._ui;\n\t}\n}","import {IJetApp, IJetRouter, IJetRouterCallback, IJetRouterOptions} from \"../interfaces\";\n\nimport {url2str} from \"../helpers\";\n\nexport class SubRouter implements IJetRouter{\n\tprivate app: IJetApp;\n\tprivate path: string;\n\tprivate prefix: string;\n\n\tconstructor(cb: IJetRouterCallback, config:any, app:IJetApp){\n\t\tthis.path = \"\";\n\t\tthis.app = app;\n\t}\n\tset(path:string, config?:IJetRouterOptions){\n\t\tthis.path = path;\n\t\tconst a = this.app as any;\n\t\ta.app.getRouter().set(a._segment.append(this.path), { silent:true });\n\t}\n\tget(){\n\t\treturn this.path;\n\t}\n}","import { JetBase } from \"./JetBase\";\nimport { JetViewRaw } from \"./JetViewRaw\";\nimport { JetView } from \"./JetView\";\nimport {SubRouter} from \"./routers/SubRouter\";\nimport {NavigationBlocked} from \"./errors\";\n\nimport {\n\tIBaseView, IJetApp, IJetConfig, IJetRouter,\n\tIJetURL, IJetURLChunk, IHash,\n\tIJetView, IRoute, ISubView, IViewConfig } from \"./interfaces\";\n\nimport { Route } from \"./Route\";\n\nlet _once = true;\n\nexport class JetAppBase extends JetBase implements IJetView {\n\tpublic config: IJetConfig;\n\tpublic app: IJetApp;\n\tpublic ready: Promise<any>;\n\n\tcallEvent: (name: string, parameters: any[]) => boolean;\n\tattachEvent: (name: string, handler: any) => void;\n\n\tprivate $router: IJetRouter;\n\tprivate _services: { [name: string]: any };\n\tprivate _subSegment: IRoute;\n\n\tconstructor(config?: any) {\n\t\tconst webix = (config || {}).webix || (window as any).webix;\n\t\tconfig = webix.extend({\n\t\t\tname: \"App\",\n\t\t\tversion: \"1.0\",\n\t\t\tstart: \"/home\"\n\t\t}, config, true);\n\n\t\tsuper(webix, config);\n\n\t\tthis.config = config;\n\t\tthis.app = this.config.app;\n\t\tthis.ready = Promise.resolve();\n\t\tthis._services = {};\n\n\t\tthis.webix.extend(this, this.webix.EventSystem);\n\t}\n\tgetUrl():IJetURL{\n\t\treturn this._subSegment.suburl();\n\t}\n\tgetUrlString(){\n\t\treturn this._subSegment.toString();\n\t}\n\tgetService(name: string) {\n\t\tlet obj = this._services[name];\n\t\tif (typeof obj === \"function\") {\n\t\t\tobj = this._services[name] = obj(this);\n\t\t}\n\t\treturn obj;\n\t}\n\tsetService(name: string, handler: any) {\n\t\tthis._services[name] = handler;\n\t}\n\tdestructor(){\n\t\tthis.getSubView().destructor();\n\t\tsuper.destructor();\n\t}\n\t// copy object and collect extra handlers\n\tcopyConfig(obj: any, target: any, config: IViewConfig) {\n\t\t// raw ui config\n\t\tif (obj instanceof JetBase ||\n\t\t\t(typeof obj === \"function\" && obj.prototype instanceof JetBase)){\n\t\t\tobj = { $subview: obj };\n\t\t}\n\n\t\t// subview placeholder\n\t\tif (typeof obj.$subview != \"undefined\") {\n\t\t\treturn this.addSubView(obj, target, config);\n\t\t}\n\n\t\t// process sub-properties\n\t\tconst isArray = obj instanceof Array;\n\t\ttarget = target || (isArray ? [] : {});\n\t\tfor (const method in obj) {\n\t\t\tlet point = obj[method];\n\n\t\t\t// view class\n\t\t\tif (typeof point === \"function\" && point.prototype instanceof JetBase) {\n\t\t\t\tpoint = { $subview : point };\n\t\t\t}\n\n\t\t\tif (point && typeof point === \"object\" &&\n\t\t\t\t!(point instanceof this.webix.DataCollection) && !(point instanceof RegExp) && !(point instanceof Map)) {\n\t\t\t\tif (point instanceof Date) {\n\t\t\t\t\ttarget[method] = new Date(point);\n\t\t\t\t} else {\n\t\t\t\t\tconst copy = this.copyConfig(\n\t\t\t\t\t\tpoint,\n\t\t\t\t\t\t(point instanceof Array ? [] : {}),\n\t\t\t\t\t\tconfig);\n\t\t\t\t\tif (copy !== null){\n\t\t\t\t\t\tif (isArray) target.push(copy);\n\t\t\t\t\t\telse target[method] = copy;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\ttarget[method] = point;\n\t\t\t}\n\t\t}\n\n\t\treturn target;\n\t}\n\n\tgetRouter() {\n\t\treturn this.$router;\n\t}\n\n\tclickHandler(e: Event, target?: HTMLElement) {\n\t\tif (e) {\n\t\t\ttarget = target || (e.target || e.srcElement) as HTMLElement;\n\t\t\tif (target && target.getAttribute) {\n\t\t\t\tconst trigger: string = target.getAttribute(\"trigger\");\n\t\t\t\tif (trigger) {\n\t\t\t\t\tthis._forView(target, view => view.app.trigger(trigger));\n\t\t\t\t\te.cancelBubble = true;\n\t\t\t\t\treturn e.preventDefault();\n\t\t\t\t}\n\t\t\t\tconst route: string = target.getAttribute(\"route\");\n\t\t\t\tif (route) {\n\t\t\t\t\tthis._forView(target, view => view.show(route));\n\t\t\t\t\te.cancelBubble = true;\n\t\t\t\t\treturn e.preventDefault();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tconst parent = target.parentNode as HTMLElement;\n\t\tif (parent){\n\t\t\tthis.clickHandler(e, parent);\n\t\t}\n\t}\n\n\tgetRoot(){\n\t\treturn this.getSubView().getRoot();\n\t}\n\n\trefresh(){\n\t\tif (!this._subSegment){\n\t\t\treturn Promise.resolve(null);\n\t\t}\n\n\t\treturn this.getSubView().refresh().then(view => {\n\t\t\tthis.callEvent(\"app:route\", [this.getUrl()]);\n\t\t\treturn view;\n\t\t});\n\t}\n\n\tloadView(url:string): Promise<IJetView> {\n\t\tconst views = this.config.views;\n\t\tlet result = null;\n\n\t\tif (url === \"\"){\n\t\t\treturn Promise.resolve(\n\t\t\t\tthis._loadError(\"\", new Error(\"Webix Jet: Empty url segment\"))\n\t\t\t);\n\t\t}\n\n\t\ttry {\n\t\t\tif (views) {\n\t\t\t\tif (typeof views === \"function\") {\n\t\t\t\t\t// custom loading strategy\n\t\t\t\t\tresult = views(url);\n\t\t\t\t} else {\n\t\t\t\t\t// predefined hash\n\t\t\t\t\tresult = views[url];\n\t\t\t\t}\n\t\t\t\tif (typeof result === \"string\"){\n\t\t\t\t\turl = result;\n\t\t\t\t\tresult = null;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (!result){\n\t\t\t\tif (url === \"_hidden\"){\n\t\t\t\t\tresult = { hidden:true };\n\t\t\t\t} else if (url === \"_blank\"){\n\t\t\t\t\tresult = {};\n\t\t\t\t} else {\n\t\t\t\t\turl = url.replace(/\\./g, \"/\");\n\t\t\t\t\tresult = this.require(\"jet-views\", url);\n\t\t\t\t}\n\t\t\t}\n\t\t} catch(e){\n\t\t\tresult = this._loadError(url, e);\n\t\t}\n\n\t\t// custom handler can return view or its promise\n\t\tif (!result.then){\n\t\t\tresult = Promise.resolve(result);\n\t\t}\n\n\t\t// set error handler\n\t\tresult = result\n\t\t\t.then(module => module.__esModule ? module.default : module)\n\t\t\t.catch(err => this._loadError(url, err));\n\n\t\treturn result;\n\t}\n\n\t_forView(target: HTMLElement, handler){\n\t\tconst view = this.webix.$$(target as any);\n\t\tif (view) {\n\t\t\thandler((view as any).$scope)\n\t\t}\n\t}\n\n\t_loadViewDynamic(url){\n\t\treturn null;\n\t}\n\n\tcreateFromURL(chunk: IJetURLChunk): Promise<IJetView> {\n\t\tlet view:Promise<IJetView>;\n\n\t\tif (chunk.isNew || !chunk.view) {\n\t\t\tview = this.loadView(chunk.page)\n\t\t\t\t.then(ui => this.createView(ui, name, chunk.params));\n\t\t} else {\n\t\t\tview = Promise.resolve(chunk.view);\n\t\t}\n\n\t\treturn view;\n\t}\n\n\t_override(ui) {\n\t\tconst over = this.config.override;\n\t\tif (over){\n\t\t\tlet dv;\n\t\t\twhile(ui){\n\t\t\t\tdv = ui;\n\t\t\t\tui = over.get(ui);\n\t\t\t}\n\t\t\treturn dv;\n\t\t}\n\t\treturn ui;\n\t}\n\tcreateView(ui:any, name?:string, params?:IHash){\n\t\tui = this._override(ui);\n\n\t\tlet obj;\n\t\tif (typeof ui === \"function\") {\n\t\t\tif (ui.prototype instanceof JetAppBase) {\n\t\t\t\t// UI class\n\t\t\t\treturn new ui({ app: this, name, params, router:SubRouter });\n\t\t\t} else if (ui.prototype instanceof JetBase) {\n\t\t\t\t// UI class\n\t\t\t\treturn new ui(this, { name, params });\n\t\t\t} else {\n\t\t\t\t// UI factory functions\n\t\t\t\tui = ui(this);\n\t\t\t}\n\t\t}\n\n\t\tif (ui instanceof JetBase){\n\t\t\tobj = ui;\n\t\t} else {\n\t\t\t// UI object\n\t\t\tobj = new JetViewRaw(this, { name, ui });\n\t\t}\n\t\treturn obj;\n\t}\n\n\t// show view path\n\tshow(url: string, config?:any) : Promise<any> {\n\t\tif (url && this.app && url.indexOf(\"//\") == 0)\n\t\t\treturn this.app.show(url.substr(1), config);\n\n\t\treturn this.render(this._container, url || this.config.start, config);\n\t}\n\n\t// event helpers\n\ttrigger(name: string, ...rest: any[]) {\n\t\tthis.apply(name, rest);\n\t}\n\tapply(name: string, data: any[]) {\n\t\tthis.callEvent(name, data);\n\t}\n\taction(name: string) {\n\t\treturn this.webix.bind(function(...rest: any[]) {\n\t\t\tthis.apply(name, rest);\n\t\t}, this);\n\t}\n\ton(name: string, handler) {\n\t\tthis.attachEvent(name, handler);\n\t}\n\n\tuse(plugin, config){\n\t\tplugin(this, null, config);\n\t}\n\n\terror(name:string, er:any[]){\n\t\tthis.callEvent(name, er);\n\t\tthis.callEvent(\"app:error\", er);\n\n\t\t/* tslint:disable */\n\t\tif (this.config.debug){\n\t\t\tfor (var i=0; i<er.length; i++){\n\t\t\t\tconsole.error(er[i]);\n\t\t\t\tif (er[i] instanceof Error){\n\t\t\t\t\tlet text = er[i].message;\n\t\t\t\t\tif (text.indexOf(\"Module build failed\") === 0){\n\t\t\t\t\t\ttext = text.replace(/\\x1b\\[[0-9;]*m/g,\"\");\n\t\t\t\t\t\tdocument.body.innerHTML = `<pre style='font-size:16px; background-color: #ec6873; color: #000; padding:10px;'>${text}</pre>`;\n\t\t\t\t\t} else {\n\t\t\t\t\t\ttext += \"<br><br>Check console for more details\";\n\t\t\t\t\t\tthis.webix.message({ type:\"error\", text:text, expire:-1 });\n\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t}\n\t\t\t}\n\t\t\tdebugger;\n\t\t}\n\t\t/* tslint:enable */\n\t}\n\n\t// renders top view\n\trender(\n\t\troot?: string | HTMLElement | ISubView,\n\t\turl?: IRoute | string,\n\t\tconfig?:any): Promise<IBaseView> {\n\n\t\tthis._container = (typeof root === \"string\") ?\n\t\t\tthis.webix.toNode(root):\n\t\t\t(root || document.body);\n\n\t\tconst firstInit = !this.$router;\n\t\tlet path:string = null;\n\t\tif (firstInit){\n\t\t\tif (_once && \"tagName\" in this._container){\n\t\t\t\tthis.webix.event(document.body, \"click\", e => this.clickHandler(e));\n\t\t\t\t_once = false;\n\t\t\t}\n\n\t\t\tif (typeof url === \"string\"){\n\t\t\t\turl = new Route(url, 0);\n\t\t\t}\n\t\t\tthis._subSegment = this._first_start(url);\n\t\t\tthis._subSegment.route.linkRouter = true;\n\t\t} else {\n\t\t\tif (typeof url === \"string\"){\n\t\t\t\tpath = url;\n\t\t\t} else {\n\t\t\t\tif (this.app){\n\t\t\t\t\tpath = url.split().route.path || this.config.start;\n\t\t\t\t} else {\n\t\t\t\t\tpath = url.toString();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tconst params = config ? config.params : this.config.params || null;\n\t\tconst top = this.getSubView();\n\t\tconst segment = this._subSegment;\n\t\tconst ready = segment\n\t\t\t.show({ url: path, params }, top)\n\t\t\t.then(() => this.createFromURL(segment.current()))\n\t\t\t.then(view => view.render(root, segment))\n\t\t\t.then(base => {\n\t\t\t\tthis.$router.set(segment.route.path, { silent:true });\n\t\t\t\tthis.callEvent(\"app:route\", [this.getUrl()]);\n\t\t\t\treturn base;\n\t\t\t});\n\n\t\tthis.ready = this.ready.then(() => ready);\n\t\treturn ready;\n\t}\n\n\tgetSubView():IJetView{\n\t\tif (this._subSegment){\n\t\t\tconst view = this._subSegment.current().view;\n\t\t\tif (view)\n\t\t\t\treturn view;\n\t\t}\n\t\treturn new JetView(this, {});\n\t}\n\n\trequire(type:string, url:string):any{ return null; }\n\n\tprivate _first_start(route: IRoute) : IRoute{\n\t\tthis._segment = route;\n\n\t\tconst cb = (a:string) => setTimeout(() => {\n\t\t\t(this as JetAppBase).show(a).catch(e => {\n\t\t\t\tif (!(e instanceof NavigationBlocked))\n\t\t\t\t\tthrow e;\n\t\t\t});\n\t\t},1);\n\t\tthis.$router = new (this.config.router)(cb, this.config, this);\n\n\t\t// start animation for top-level app\n\t\tif (this._container === document.body && this.config.animation !== false) {\n\t\t\tconst node = this._container as HTMLElement;\n\t\t\tthis.webix.html.addCss(node, \"webixappstart\");\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis.webix.html.removeCss(node, \"webixappstart\");\n\t\t\t\tthis.webix.html.addCss(node, \"webixapp\");\n\t\t\t}, 10);\n\t\t}\n\n\t\tif (!route){\n\t\t\t// if no url defined, check router first\n\t\t\tlet urlString = this.$router.get();\n\t\t\tif (!urlString){\n\t\t\t\turlString = this.config.start;\n\t\t\t\tthis.$router.set(urlString, { silent: true });\n\t\t\t}\n\t\t\troute = new Route(urlString, 0);\n\t\t} else if (this.app) {\n\t\t\tconst now = route.current().view;\n\t\t\troute.current().view = this;\n\t\t\tif (route.next()){\n\t\t\t\troute.refresh();\n\t\t\t\troute = route.split();\n\t\t\t} else {\n\t\t\t\troute = new Route(this.config.start, 0);\n\t\t\t}\n\t\t\troute.current().view = now;\n\t\t}\n\n\t\treturn route;\n\t}\n\n\t// error during view resolving\n\tprivate _loadError(url: string, err: Error):any{\n\t\tthis.error(\"app:error:resolve\", [err, url]);\n\t\treturn { template:\" \" };\n\t}\n\n\tprivate addSubView(obj, target, config:IViewConfig) : ISubView {\n\t\tconst url = obj.$subview !== true ? obj.$subview : null;\n\t\tconst name: string = obj.name || (url ? this.webix.uid() : \"default\");\n\t\ttarget.id = obj.id || \"s\" + this.webix.uid();\n\n\t\tconst view : ISubView = config[name] = {\n\t\t\tid: target.id,\n\t\t\turl,\n\t\t\tbranch: obj.branch,\n\t\t\tpopup: obj.popup,\n\t\t\tparams: obj.params\n\t\t};\n\n\t\treturn view.popup ? null : target;\n\t}\n}\n","import {IJetRouter, IJetRouterCallback, IJetRouterOptions} from \"../interfaces\";\n\nexport class HashRouter implements IJetRouter{\n\tprotected config:any;\n\tprotected prefix:string;\n\tprotected sufix:string;\n\tprivate cb: IJetRouterCallback;\n\n\tconstructor(cb: IJetRouterCallback, config:any){\n\t\tthis.config = config || {};\n\t\tthis._detectPrefix();\n\t\tthis.cb = cb;\n\t\twindow.onpopstate = () => this.cb(this.get());\n\t}\n\n\tset(path:string, config?:IJetRouterOptions){\n\t\tif (this.config.routes){\n\t\t\tconst compare = path.split(\"?\",2);\n\t\t\tfor (const key in this.config.routes){\n\t\t\t\tif (this.config.routes[key] === compare[0]){\n\t\t\t\t\tpath = key+(compare.length > 1 ? \"?\"+compare[1] : \"\");\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (this.get() !== path){\n\t\t\twindow.history.pushState(null, null, this.prefix + this.sufix + path);\n\t\t}\n\t\tif (!config || !config.silent){\n\t\t\tsetTimeout(() => this.cb(path), 1);\n\t\t}\n\t}\n\tget(){\n\t\tlet path = this._getRaw().replace(this.prefix, \"\").replace(this.sufix, \"\");\n\t\tpath = (path !== \"/\" && path !== \"#\") ? path : \"\";\n\n\t\tif (this.config.routes){\n\t\t\tconst compare = path.split(\"?\",2);\n\t\t\tconst key = this.config.routes[compare[0]];\n\t\t\tif (key){\n\t\t\t\tpath = key+(compare.length > 1 ? \"?\"+compare[1] : \"\");\n\t\t\t}\n\t\t}\n\t\treturn path;\n\t}\n\tprotected _detectPrefix(){\n\t\t// use \"#!\" for backward compatibility\n\t\tconst sufix = this.config.routerPrefix;\n\t\tthis.sufix = \"#\" + ((typeof sufix === \"undefined\") ? \"!\" : sufix);\n\n\t\tthis.prefix = document.location.href.split(\"#\", 2)[0];\n\t}\n\n\tprotected _getRaw(){\n\t\treturn document.location.href;\n\t}\n}","let isPatched = false;\nexport default function patch(w: any){\n\tif (isPatched || !w){ return; }\n\tisPatched = true;\n\n\t// custom promise for IE8\n\tconst win = window as any;\n\tif (!win.Promise){\n\t\twin.Promise = w.promise;\n\t}\n\n\tconst version = w.version.split(\".\") as any[];\n\n\t// will be fixed in webix 5.3\n\tif (version[0]*10+version[1]*1 < 53) {\n\t\tw.ui.freeze = function(handler):any{\n\t\t\t// disabled because webix jet 5.0 can't handle resize of scrollview correctly\n\t\t\t// w.ui.$freeze = true;\n\t\t\tconst res = handler();\n\t\t\tif (res && res.then){\n\t\t\t\tres.then(function(some){\n\t\t\t\t\tw.ui.$freeze = false;\n\t\t\t\t\tw.ui.resize();\n\t\t\t\t\treturn some;\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tw.ui.$freeze = false;\n\t\t\t\tw.ui.resize();\n\t\t\t}\n\t\t\treturn res;\n\t\t};\n\t}\n\n\t// adding views as classes\n\tconst baseAdd = w.ui.baselayout.prototype.addView as any;\n\tconst baseRemove = w.ui.baselayout.prototype.removeView as any;\n\n\tconst config = {\n\t\taddView(view, index){\n\t\t\t// trigger logic only for widgets inside of jet-view\n\t\t\t// ignore case when addView used with already initialized widget\n\t\t\tif (this.$scope && this.$scope.webixJet && !view.queryView){\n\t\t\t\tconst jview = this.$scope;\n\t\t\t\tconst subs = {};\n\n\t\t\t\tview = jview.app.copyConfig(view, {}, subs);\n\t\t\t\tbaseAdd.apply(this, [view, index]);\n\n\t\t\t\tfor (const key in subs){\n\t\t\t\t\tjview._renderFrame(key, subs[key], null).then(() => {\n\t\t\t\t\t\tjview._subs[key] = subs[key];\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\treturn view.id;\n\t\t\t} else {\n\t\t\t\treturn baseAdd.apply(this, arguments);\n\t\t\t}\n\t\t},\n\t\tremoveView(){\n\t\t\tbaseRemove.apply(this, arguments);\n\t\t\tif (this.$scope && this.$scope.webixJet){\n\t\t\t\tconst subs = this.$scope._subs;\n\t\t\t\t// check all sub-views, destroy and clean the removed one\n\t\t\t\tfor(const key in subs){\n\t\t\t\t\tconst test = subs[key];\n\t\t\t\t\tif (!w.$$(test.id)){\n\t\t\t\t\t\ttest.view.destructor();\n\t\t\t\t\t\tdelete subs[key];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t};\n\n\tw.extend(w.ui.layout.prototype, config, true);\n\tw.extend(w.ui.baselayout.prototype, config, true);\n\n\t// wrapper for using Jet Apps as views\n\n\tw.protoUI({\n\t\tname:\"jetapp\",\n\t\t$init(cfg){\n\t\t\tthis.$app = new this.app(cfg);\n\n\t\t\tconst id = w.uid().toString();\n\t\t\tcfg.body = { id };\n\n\t\t\tthis.$ready.push(function(){\n\t\t\t\tthis.callEvent(\"onInit\", [this.$app]);\n\t\t\t\tthis.$app.render({ id });\n\t\t\t});\n\t\t}\n\t}, (w.ui as any).proxy, w.EventSystem);\n}","import { IJetApp } from \"./interfaces\";\nimport { JetAppBase } from \"./JetAppBase\";\nimport { HashRouter } from \"./routers/HashRouter\";\n\nimport patch from \"./patch\";\n\n// webpack require\ndeclare function require(_$url: string): any;\n\n// webpack require\ndeclare function require(_$url: string): any;\n\nexport class JetApp extends JetAppBase implements IJetApp {\n\tconstructor(config: any) {\n\t\tconfig.router = config.router || HashRouter;\n\t\tsuper(config);\n\t\tpatch(this.webix);\n\t}\n\trequire(type:string, url:string){\n\t\treturn require(type+\"/\"+url);\n\t}\n}\n","import {IJetApp, IJetRouter, IJetRouterCallback, IJetRouterOptions} from \"../interfaces\";\n\nexport class StoreRouter implements IJetRouter{\n\tprivate name:string;\n\tprivate storage: any;\n\tprivate cb: IJetRouterCallback;\n\n\tconstructor(cb: IJetRouterCallback, config:any, app: IJetApp){\n\t\tthis.storage = config.storage || app.webix.storage.session;\n\t\tthis.name = (config.storeName || config.id+\":route\");\n\t\tthis.cb = cb;\n\t}\n\tset(path:string, config?:IJetRouterOptions){\n\t\tthis.storage.put(this.name, path);\n\t\tif (!config || !config.silent){\n\t\t\tsetTimeout(() => this.cb(path), 1);\n\t\t}\n\t}\n\tget(){\n\t\treturn this.storage.get(this.name);\n\t}\n}","import {IJetRouter, IJetRouterCallback, IJetRouterOptions} from \"../interfaces\";\nimport { HashRouter } from \"./HashRouter\";\n\nexport class UrlRouter extends HashRouter implements IJetRouter{\n\tprotected _detectPrefix(){\n\t\tthis.prefix = \"\";\n\t\tthis.sufix = this.config.routerPrefix || \"\";\n\t}\n\tprotected _getRaw(){\n\t\treturn document.location.pathname + (document.location.search||\"\");\n\t}\n}","import {IJetRouter, IJetRouterCallback, IJetRouterOptions} from \"../interfaces\";\n\nexport class EmptyRouter implements IJetRouter{\n\tprivate path: string;\n\tprivate cb: IJetRouterCallback;\n\n\tconstructor(cb: IJetRouterCallback, _$config:any){\n\t\tthis.path = \"\";\n\t\tthis.cb = cb;\n\t}\n\tset(path:string, config?:IJetRouterOptions){\n\t\tthis.path = path;\n\t\tif (!config || !config.silent){\n\t\t\tsetTimeout(() => this.cb(path), 1);\n\t\t}\n\t}\n\tget(){\n\t\treturn this.path;\n\t}\n}","import {NavigationBlocked} from \"../errors\";\nimport {IJetApp, IJetURL, IJetView} from \"../interfaces\";\n\nexport function UnloadGuard(app: IJetApp, view: IJetView, config: any){\n\tview.on(app, `app:guard`, function(_$url:IJetURL, point:IJetView, promise:any){\n\t\tif (point === view || point.contains(view)){\n\t\t\tconst res = config();\n\t\t\tif (res === false){\n\t\t\t\tpromise.confirm = Promise.reject(new NavigationBlocked());\n\t\t\t} else {\n\t\t\t\tpromise.confirm = promise.confirm.then(() => res);\n\t\t\t}\n\t\t}\n\t});\n}","//     (c) 2012-2018 Airbnb, Inc.\n//\n//     polyglot.js may be freely distributed under the terms of the BSD\n//     license. For all licensing information, details, and documention:\n//     http://airbnb.github.com/polyglot.js\n//\n//\n// Polyglot.js is an I18n helper library written in JavaScript, made to\n// work both in the browser and in Node. It provides a simple solution for\n// interpolation and pluralization, based off of Airbnb's\n// experience adding I18n functionality to its Backbone.js and Node apps.\n//\n// Polylglot is agnostic to your translation backend. It doesn't perform any\n// translation; it simply gives you a way to manage translated phrases from\n// your client- or server-side JavaScript application.\n//\n\n'use strict';\n\n// var has = require('has');\nfunction has(store, key) {\n  return Object.prototype.hasOwnProperty.call(store, key);\n}\n// var forEach = require('for-each');\nfunction forEach(obj, handler, context) {\n  for (var key in obj) {\n    if (has(obj, key)) {\n      handler.call((context || obj), obj[key], key, obj);\n    }\n  }\n}\n// var trim = require('string.prototype.trim');\nfunction trim(str) {\n  return str.replace(/^[\\s\\uFEFF\\xA0]+|[\\s\\uFEFF\\xA0]+$/g, '');\n}\n// var warning = require('warning');\nfunction warn(message) {\n  message = 'Warning: ' + message;\n  if (typeof console !== 'undefined') {\n    console.error(message);\n  }\n\n  try { throw new Error(message); } catch (x) {}\n}\n\nvar replace = String.prototype.replace;\nvar split = String.prototype.split;\n\n// #### Pluralization methods\n// The string that separates the different phrase possibilities.\nvar delimiter = '||||';\n\nvar russianPluralGroups = function (n) {\n  var end = n % 10;\n  if (n !== 11 && end === 1) {\n    return 0;\n  }\n  if (2 <= end && end <= 4 && !(n >= 12 && n <= 14)) {\n    return 1;\n  }\n  return 2;\n};\n\n// Mapping from pluralization group plural logic.\nvar pluralTypes = {\n  arabic: function (n) {\n    // http://www.arabeyes.org/Plural_Forms\n    if (n < 3) { return n; }\n    var lastTwo = n % 100;\n    if (lastTwo >= 3 && lastTwo <= 10) return 3;\n    return lastTwo >= 11 ? 4 : 5;\n  },\n  bosnian_serbian: russianPluralGroups,\n  chinese: function () { return 0; },\n  croatian: russianPluralGroups,\n  french: function (n) { return n > 1 ? 1 : 0; },\n  german: function (n) { return n !== 1 ? 1 : 0; },\n  russian: russianPluralGroups,\n  lithuanian: function (n) {\n    if (n % 10 === 1 && n % 100 !== 11) { return 0; }\n    return n % 10 >= 2 && n % 10 <= 9 && (n % 100 < 11 || n % 100 > 19) ? 1 : 2;\n  },\n  czech: function (n) {\n    if (n === 1) { return 0; }\n    return (n >= 2 && n <= 4) ? 1 : 2;\n  },\n  polish: function (n) {\n    if (n === 1) { return 0; }\n    var end = n % 10;\n    return 2 <= end && end <= 4 && (n % 100 < 10 || n % 100 >= 20) ? 1 : 2;\n  },\n  icelandic: function (n) { return (n % 10 !== 1 || n % 100 === 11) ? 1 : 0; },\n  slovenian: function (n) {\n    var lastTwo = n % 100;\n    if (lastTwo === 1) {\n      return 0;\n    }\n    if (lastTwo === 2) {\n      return 1;\n    }\n    if (lastTwo === 3 || lastTwo === 4) {\n      return 2;\n    }\n    return 3;\n  }\n};\n\n\n// Mapping from pluralization group to individual language codes/locales.\n// Will look up based on exact match, if not found and it's a locale will parse the locale\n// for language code, and if that does not exist will default to 'en'\nvar pluralTypeToLanguages = {\n  arabic: ['ar'],\n  bosnian_serbian: ['bs-Latn-BA', 'bs-Cyrl-BA', 'srl-RS', 'sr-RS'],\n  chinese: ['id', 'id-ID', 'ja', 'ko', 'ko-KR', 'lo', 'ms', 'th', 'th-TH', 'zh'],\n  croatian: ['hr', 'hr-HR'],\n  german: ['fa', 'da', 'de', 'en', 'es', 'fi', 'el', 'he', 'hi-IN', 'hu', 'hu-HU', 'it', 'nl', 'no', 'pt', 'sv', 'tr'],\n  french: ['fr', 'tl', 'pt-br'],\n  russian: ['ru', 'ru-RU'],\n  lithuanian: ['lt'],\n  czech: ['cs', 'cs-CZ', 'sk'],\n  polish: ['pl'],\n  icelandic: ['is'],\n  slovenian: ['sl-SL']\n};\n\nfunction langToTypeMap(mapping) {\n  var ret = {};\n  forEach(mapping, function (langs, type) {\n    forEach(langs, function (lang) {\n      ret[lang] = type;\n    });\n  });\n  return ret;\n}\n\nfunction pluralTypeName(locale) {\n  var langToPluralType = langToTypeMap(pluralTypeToLanguages);\n  return langToPluralType[locale]\n    || langToPluralType[split.call(locale, /-/, 1)[0]]\n    || langToPluralType.en;\n}\n\nfunction pluralTypeIndex(locale, count) {\n  return pluralTypes[pluralTypeName(locale)](count);\n}\n\nfunction escape(token) {\n  return token.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&');\n}\n\nfunction constructTokenRegex(opts) {\n  var prefix = (opts && opts.prefix) || '%{';\n  var suffix = (opts && opts.suffix) || '}';\n\n  if (prefix === delimiter || suffix === delimiter) {\n    throw new RangeError('\"' + delimiter + '\" token is reserved for pluralization');\n  }\n\n  return new RegExp(escape(prefix) + '(.*?)' + escape(suffix), 'g');\n}\n\nvar dollarRegex = /\\$/g;\nvar dollarBillsYall = '$$';\nvar defaultTokenRegex = /%\\{(.*?)\\}/g;\n\n// ### transformPhrase(phrase, substitutions, locale)\n//\n// Takes a phrase string and transforms it by choosing the correct\n// plural form and interpolating it.\n//\n//     transformPhrase('Hello, %{name}!', {name: 'Spike'});\n//     // \"Hello, Spike!\"\n//\n// The correct plural form is selected if substitutions.smart_count\n// is set. You can pass in a number instead of an Object as `substitutions`\n// as a shortcut for `smart_count`.\n//\n//     transformPhrase('%{smart_count} new messages |||| 1 new message', {smart_count: 1}, 'en');\n//     // \"1 new message\"\n//\n//     transformPhrase('%{smart_count} new messages |||| 1 new message', {smart_count: 2}, 'en');\n//     // \"2 new messages\"\n//\n//     transformPhrase('%{smart_count} new messages |||| 1 new message', 5, 'en');\n//     // \"5 new messages\"\n//\n// You should pass in a third argument, the locale, to specify the correct plural type.\n// It defaults to `'en'` with 2 plural forms.\nfunction transformPhrase(phrase, substitutions, locale, tokenRegex) {\n  if (typeof phrase !== 'string') {\n    throw new TypeError('Polyglot.transformPhrase expects argument #1 to be string');\n  }\n\n  if (substitutions == null) {\n    return phrase;\n  }\n\n  var result = phrase;\n  var interpolationRegex = tokenRegex || defaultTokenRegex;\n\n  // allow number as a pluralization shortcut\n  var options = typeof substitutions === 'number' ? { smart_count: substitutions } : substitutions;\n\n  // Select plural form: based on a phrase text that contains `n`\n  // plural forms separated by `delimiter`, a `locale`, and a `substitutions.smart_count`,\n  // choose the correct plural form. This is only done if `count` is set.\n  if (options.smart_count != null && result) {\n    var texts = split.call(result, delimiter);\n    result = trim(texts[pluralTypeIndex(locale || 'en', options.smart_count)] || texts[0]);\n  }\n\n  // Interpolate: Creates a `RegExp` object for each interpolation placeholder.\n  result = replace.call(result, interpolationRegex, function (expression, argument) {\n    if (!has(options, argument) || options[argument] == null) { return expression; }\n    // Ensure replacement value is escaped to prevent special $-prefixed regex replace tokens.\n    return replace.call(options[argument], dollarRegex, dollarBillsYall);\n  });\n\n  return result;\n}\n\n// ### Polyglot class constructor\nfunction Polyglot(options) {\n  var opts = options || {};\n  this.phrases = {};\n  this.extend(opts.phrases || {});\n  this.currentLocale = opts.locale || 'en';\n  var allowMissing = opts.allowMissing ? transformPhrase : null;\n  this.onMissingKey = typeof opts.onMissingKey === 'function' ? opts.onMissingKey : allowMissing;\n  this.warn = opts.warn || warn;\n  this.tokenRegex = constructTokenRegex(opts.interpolation);\n}\n\n// ### polyglot.locale([locale])\n//\n// Get or set locale. Internally, Polyglot only uses locale for pluralization.\nPolyglot.prototype.locale = function (newLocale) {\n  if (newLocale) this.currentLocale = newLocale;\n  return this.currentLocale;\n};\n\n// ### polyglot.extend(phrases)\n//\n// Use `extend` to tell Polyglot how to translate a given key.\n//\n//     polyglot.extend({\n//       \"hello\": \"Hello\",\n//       \"hello_name\": \"Hello, %{name}\"\n//     });\n//\n// The key can be any string.  Feel free to call `extend` multiple times;\n// it will override any phrases with the same key, but leave existing phrases\n// untouched.\n//\n// It is also possible to pass nested phrase objects, which get flattened\n// into an object with the nested keys concatenated using dot notation.\n//\n//     polyglot.extend({\n//       \"nav\": {\n//         \"hello\": \"Hello\",\n//         \"hello_name\": \"Hello, %{name}\",\n//         \"sidebar\": {\n//           \"welcome\": \"Welcome\"\n//         }\n//       }\n//     });\n//\n//     console.log(polyglot.phrases);\n//     // {\n//     //   'nav.hello': 'Hello',\n//     //   'nav.hello_name': 'Hello, %{name}',\n//     //   'nav.sidebar.welcome': 'Welcome'\n//     // }\n//\n// `extend` accepts an optional second argument, `prefix`, which can be used\n// to prefix every key in the phrases object with some string, using dot\n// notation.\n//\n//     polyglot.extend({\n//       \"hello\": \"Hello\",\n//       \"hello_name\": \"Hello, %{name}\"\n//     }, \"nav\");\n//\n//     console.log(polyglot.phrases);\n//     // {\n//     //   'nav.hello': 'Hello',\n//     //   'nav.hello_name': 'Hello, %{name}'\n//     // }\n//\n// This feature is used internally to support nested phrase objects.\nPolyglot.prototype.extend = function (morePhrases, prefix) {\n  forEach(morePhrases, function (phrase, key) {\n    var prefixedKey = prefix ? prefix + '.' + key : key;\n    if (typeof phrase === 'object') {\n      this.extend(phrase, prefixedKey);\n    } else {\n      this.phrases[prefixedKey] = phrase;\n    }\n  }, this);\n};\n\n// ### polyglot.unset(phrases)\n// Use `unset` to selectively remove keys from a polyglot instance.\n//\n//     polyglot.unset(\"some_key\");\n//     polyglot.unset({\n//       \"hello\": \"Hello\",\n//       \"hello_name\": \"Hello, %{name}\"\n//     });\n//\n// The unset method can take either a string (for the key), or an object hash with\n// the keys that you would like to unset.\nPolyglot.prototype.unset = function (morePhrases, prefix) {\n  if (typeof morePhrases === 'string') {\n    delete this.phrases[morePhrases];\n  } else {\n    forEach(morePhrases, function (phrase, key) {\n      var prefixedKey = prefix ? prefix + '.' + key : key;\n      if (typeof phrase === 'object') {\n        this.unset(phrase, prefixedKey);\n      } else {\n        delete this.phrases[prefixedKey];\n      }\n    }, this);\n  }\n};\n\n// ### polyglot.clear()\n//\n// Clears all phrases. Useful for special cases, such as freeing\n// up memory if you have lots of phrases but no longer need to\n// perform any translation. Also used internally by `replace`.\nPolyglot.prototype.clear = function () {\n  this.phrases = {};\n};\n\n// ### polyglot.replace(phrases)\n//\n// Completely replace the existing phrases with a new set of phrases.\n// Normally, just use `extend` to add more phrases, but under certain\n// circumstances, you may want to make sure no old phrases are lying around.\nPolyglot.prototype.replace = function (newPhrases) {\n  this.clear();\n  this.extend(newPhrases);\n};\n\n\n// ### polyglot.t(key, options)\n//\n// The most-used method. Provide a key, and `t` will return the\n// phrase.\n//\n//     polyglot.t(\"hello\");\n//     => \"Hello\"\n//\n// The phrase value is provided first by a call to `polyglot.extend()` or\n// `polyglot.replace()`.\n//\n// Pass in an object as the second argument to perform interpolation.\n//\n//     polyglot.t(\"hello_name\", {name: \"Spike\"});\n//     => \"Hello, Spike\"\n//\n// If you like, you can provide a default value in case the phrase is missing.\n// Use the special option key \"_\" to specify a default.\n//\n//     polyglot.t(\"i_like_to_write_in_language\", {\n//       _: \"I like to write in %{language}.\",\n//       language: \"JavaScript\"\n//     });\n//     => \"I like to write in JavaScript.\"\n//\nPolyglot.prototype.t = function (key, options) {\n  var phrase, result;\n  var opts = options == null ? {} : options;\n  if (typeof this.phrases[key] === 'string') {\n    phrase = this.phrases[key];\n  } else if (typeof opts._ === 'string') {\n    phrase = opts._;\n  } else if (this.onMissingKey) {\n    var onMissingKey = this.onMissingKey;\n    result = onMissingKey(key, opts, this.currentLocale, this.tokenRegex);\n  } else {\n    this.warn('Missing translation for key: \"' + key + '\"');\n    result = key;\n  }\n  if (typeof phrase === 'string') {\n    result = transformPhrase(phrase, opts, this.currentLocale, this.tokenRegex);\n  }\n  return result;\n};\n\n\n// ### polyglot.has(key)\n//\n// Check if polyglot has a translation for given key\nPolyglot.prototype.has = function (key) {\n  return has(this.phrases, key);\n};\n\n// export transformPhrase\nPolyglot.transformPhrase = function transform(phrase, substitutions, locale) {\n  return transformPhrase(phrase, substitutions, locale);\n};\n\nmodule.exports = Polyglot;\n","import Polyglot from \"webix-polyglot\";\nimport {IJetApp, IJetView} from \"../interfaces\";\n\nexport function Locale(app: IJetApp, _view: IJetView, config: any){\n\tconfig = config || {};\n\tconst storage = config.storage;\n\tlet lang = storage ? (storage.get(\"lang\") || \"en\") : (config.lang || \"en\");\n\n\tfunction setLangData(name, data: any, silent?: boolean) : Promise<any>{\n\t\tif (data.__esModule) {\n\t\t\tdata = data.default;\n\t\t}\n\n\t\tconst pconfig = { phrases:data };\n\t\tif (config.polyglot){\n\t\t\tapp.webix.extend(pconfig, config.polyglot);\n\t\t}\n\n\t\tconst poly = service.polyglot = new Polyglot(pconfig);\n\t\tpoly.locale(name);\n\n\t\tservice._ = app.webix.bind(poly.t, poly);\n\t\tlang = name;\n\n\t\tif (storage){\n\t\t\tstorage.put(\"lang\", lang);\n\t\t}\n\n\t\tif (config.webix){\n\t\t\tconst locName = config.webix[name];\n\t\t\tif (locName){\n\t\t\t\tapp.webix.i18n.setLocale(locName);\n\t\t\t}\n\t\t}\n\n\t\tif (!silent){\n\t\t\treturn app.refresh();\n\t\t}\n\n\t\treturn Promise.resolve();\n\t}\n\tfunction getLang(){ return lang; }\n\tfunction setLang(name:string, silent? : boolean){\n\t\t// ignore setLang if loading by path is disabled\n\t\tif (config.path === false){\n\t\t\treturn;\n\t\t}\n\n\t\tconst path = (config.path ? config.path + \"/\" : \"\") + name;\n\t\tconst data = app.require(\"jet-locales\",path);\n\n\t\tsetLangData(name, data, silent);\n\t}\n\n\tconst service = {\n\t\tgetLang, setLang, setLangData, _:null, polyglot:null\n\t};\n\n\tapp.setService(\"locale\", service);\n\tsetLang(lang, true);\n}","import {IJetApp, IJetView} from \"../interfaces\";\n\nfunction show(view, config, value){\n\tif (config.urls){\n\t\tvalue = config.urls[value] || value;\n\t} else if (config.param){\n\t\tvalue = { [config.param]:value };\n\t}\n\n\tview.show(value);\n}\nexport function Menu(app: IJetApp, view: IJetView, config: any){\n\tconst frame = view.getSubViewInfo().parent;\n\tconst ui = view.$$(config.id || config) as any;\n\tlet silent = false;\n\n\tui.attachEvent(\"onchange\", function(){\n\t\tif (!silent){\n\t\t\tshow(frame, config, this.getValue());\n\t\t}\n\t});\n\tui.attachEvent(\"onafterselect\", function(){\n\t\tif (!silent){\n\t\t\tlet id = null;\n\t\t\tif (ui.setValue){\n\t\t\t\tid = this.getValue();\n\t\t\t} else if (ui.getSelectedId){\n\t\t\t\tid = ui.getSelectedId();\n\t\t\t}\n\t\t\tshow(frame, config, id);\n\t\t}\n\t});\n\n\tview.on(app, `app:route`, function(){\n\t\tlet name = \"\";\n\t\tif (config.param){\n\t\t\tname = view.getParam(config.param, true);\n\t\t} else {\n\t\t\tconst segment = frame.getUrl()[1];\n\t\t\tif (segment){\n\t\t\t\tname = segment.page;\n\t\t\t}\n\t\t}\n\n\t\tif (name){\n\t\t\tsilent = true;\n\t\t\tif (ui.setValue && ui.getValue() !== name){\n\t\t\t\tui.setValue(name);\n\t\t\t} else if (ui.select && ui.exists(name) && ui.getSelectedId() !== name){\n\t\t\t\tui.select(name);\n\t\t\t}\n\t\t\tsilent = false;\n\t\t}\n\t});\n}","import {IJetApp, IJetView, IWebixFacade} from \"../interfaces\";\n\nconst baseicons = {\n\tgood:\t\"check\",\n\terror: \"warning\",\n\tsaving: \"refresh fa-spin\"\n};\n\nconst basetext = {\n\tgood:\t\"Ok\",\n\terror: \"Error\",\n\tsaving: \"Connecting...\"\n};\n\nexport function Status(app: IJetApp, view: IJetView, config: any){\n\n\tlet status = \"good\";\n\tlet count = 0;\n\tlet iserror = false;\n\tlet expireDelay = config.expire;\n\tif (!expireDelay && expireDelay !== false){\n\t\texpireDelay = 2000;\n\t}\n\tconst texts = config.texts || basetext;\n\tconst icons = config.icons || baseicons;\n\n\tif (typeof config === \"string\"){\n\t\tconfig = { target:config };\n\t}\n\n\tfunction refresh(content? : string) {\n\t\tconst area = view.$$(config.target);\n\t\tif (area) {\n\t\t\tif (!content){\n\t\t\t\tcontent = \"<div class='status_\" +\n\t\t\t\t\tstatus +\n\t\t\t\t\t\"'><span class='webix_icon fa-\" +\n\t\t\t\t\ticons[status] + \"'></span> \" + texts[status] + \"</div>\";\n\t\t\t}\n\t\t\t(area as any).setHTML(content);\n\t\t}\n\t}\n\tfunction success(){\n\t\tcount--;\n\t\tsetStatus(\"good\");\n\t}\n\tfunction fail(err){\n\t\tcount--;\n\t\tsetStatus(\"error\", err);\n\t}\n\tfunction start(promise){\n\t\tcount++;\n\t\tsetStatus(\"saving\");\n\t\tif (promise && promise.then){\n\t\t\tpromise.then(success, fail);\n\t\t}\n\t}\n\tfunction getStatus(){\n\t\treturn status;\n\t}\n\tfunction hideStatus(){\n\t\tif (count === 0){\n\t\t\trefresh(\" \");\n\t\t}\n\t}\n\tfunction setStatus(mode, err?){\n\t\tif (count < 0){\n\t\t\tcount = 0;\n\t\t}\n\n\t\tif (mode === \"saving\"){\n\t\t\tstatus = \"saving\";\n\t\t\trefresh();\n\t\t} else {\n\t\t\tiserror = (mode === \"error\");\n\t\t\tif (count === 0){\n\t\t\t\tstatus = iserror ? \"error\" : \"good\";\n\t\t\t\tif (iserror){\n\t\t\t\t\tapp.error(\"app:error:server\", [err.responseText || err]);\n\t\t\t\t} else {\n\t\t\t\t\tif (expireDelay){\n\t\t\t\t\t\tsetTimeout(hideStatus, expireDelay);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\trefresh();\n\t\t\t}\n\t\t}\n\t}\n\tfunction track(data){\n\t\tconst dp = app.webix.dp(data);\n\t\tif (dp){\n\t\t\tview.on(dp, \"onAfterDataSend\", start);\n\t\t\tview.on(dp, \"onAfterSaveError\", (_id, _obj, response) => fail(response));\n\t\t\tview.on(dp, \"onAfterSave\", success);\n\t\t}\n\t}\n\n\tapp.setService(\"status\", {\n\t\tgetStatus,\n\t\tsetStatus,\n\t\ttrack\n\t});\n\n\tif (config.remote){\n\t\tview.on(app.webix, \"onRemoteCall\", start);\n\t}\n\n\tif (config.ajax){\n\t\tview.on(app.webix, \"onBeforeAjax\",\n\t\t\t(_mode, _url, _data, _request, _headers, _files, promise) => {\n\t\t\t\tstart(promise);\n\t\t});\n\t}\n\n\tif (config.data){\n\t\ttrack(config.data);\n\t}\n}","import {IJetApp, IJetView, IWebixFacade} from \"../interfaces\";\n\nexport function Theme(app: IJetApp, _view: IJetView, config: any){\n\tconfig = config || {};\n\tconst storage = config.storage;\n\tlet theme = storage ?\n\t\t(storage.get(\"theme\")||\"flat-default\")\n\t\t:\n\t\t(config.theme || \"flat-default\");\n\n\tconst service = {\n\t\tgetTheme(){ return theme; },\n\t\tsetTheme(name:string, silent?:boolean){\n\t\t\tconst parts = name.split(\"-\");\n\t\t\tconst links = document.getElementsByTagName(\"link\");\n\n\t\t\tfor (let i=0; i<links.length; i++){\n\t\t\t\tconst lname = links[i].getAttribute(\"title\");\n\t\t\t\tif (lname){\n\t\t\t\t\tif (lname === name || lname === parts[0]){\n\t\t\t\t\t\tlinks[i].disabled = false;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tlinks[i].disabled = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t(app.webix as any).skin.set(parts[0]);\n\t\t\t// remove old css\n\t\t\tapp.webix.html.removeCss(document.body, \"theme-\"+theme);\n\t\t\t// add new css\n\t\t\tapp.webix.html.addCss(document.body, \"theme-\"+name);\n\n\t\t\ttheme = name;\n\t\t\tif (storage){\n\t\t\t\tstorage.put(\"theme\", name);\n\t\t\t}\n\t\t\tif (!silent){\n\t\t\t\tapp.refresh();\n\t\t\t}\n\t\t}\n\t};\n\n\tapp.setService(\"theme\", service);\n\tservice.setTheme(theme, true);\n}","import {IJetApp, IJetURL, IJetView, IRoute, IWebixFacade} from \"../interfaces\";\n\nfunction copyParams(data: any, url:IJetURL, route:string[]){\n\tfor (let i = 0; i < route.length; i++){\n\t\tdata[route[i]] = url[i+1] ? url[i+1].page : \"\";\n\t}\n}\n\nexport function UrlParam(app: IJetApp, view: IJetView, config: any){\n\tconst route = config.route || config;\n\tconst data = {};\n\tconst seg = null;\n\n\tview.on(app, \"app:urlchange\", function(subview, segment:IRoute){\n\t\tif (view === subview){\n\t\t\tcopyParams(data, segment.suburl(), route);\n\t\t\tsegment.size(route.length+1);\n\t\t}\n\t});\n\n\tconst os = view.setParam;\n\tconst og = view.getParam;\n\n\tview.setParam = function(name, value, show){\n\t\tconst index = route.indexOf(name);\n\t\tif (index >= 0){\n\t\t\tdata[name] = value;\n\t\t\tthis._segment.update(\"\", value, index+1);\n\t\t\tif (show){\n\t\t\t\treturn view.show(null);\n\t\t\t}\n\t\t} else {\n\t\t\treturn os.call(this, name, value, show);\n\t\t}\n\t};\n\n\tview.getParam = function(key, mode){\n\t\tconst val = data[key];\n\t\tif (typeof val !== \"undefined\") { return val; }\n\t\treturn og.call(this, key, mode);\n\t};\n\n\tcopyParams(data, view.getUrl(), route);\n}\n","import {IJetApp, IJetView} from \"../interfaces\";\n\nexport function User(app: IJetApp, _view: IJetView, config: any){\n\tconfig = config || {};\n\n\tconst login = config.login || \"/login\";\n\tconst logout = config.logout || \"/logout\";\n\tconst afterLogin = config.afterLogin || app.config.start;\n\tconst afterLogout = config.afterLogout || \"/login\";\n\tconst ping = config.ping || 5*60*1000;\n\tconst model = config.model;\n\tlet user = config.user;\n\n\tconst service = {\n\t\tgetUser(){\n\t\t\treturn user;\n\t\t},\n\t\tgetStatus(server? : boolean){\n\t\t\tif (!server){\n\t\t\t\treturn user !== null;\n\t\t\t}\n\n\t\t\treturn model.status().catch(() => null).then(data => {\n\t\t\t\tuser = data;\n\t\t\t});\n\t\t},\n\t\tlogin(name:string, pass:string){\n\t\t\treturn model.login(name, pass).then(data => {\n\t\t\t\tuser = data;\n\t\t\t\tif (!data){\n\t\t\t\t\tthrow new Error(\"Access denied\");\n\t\t\t\t}\n\n\t\t\t\tapp.callEvent(\"app:user:login\", [ user ]);\n\t\t\t\tapp.show(afterLogin);\n\t\t\t});\n\t\t},\n\t\tlogout(){\n\t\t\tuser = null;\n\t\t\treturn model.logout().then(res => {\n\t\t\t\tapp.callEvent(\"app:user:logout\",[]);\n\t\t\t\treturn res;\n\t\t\t});\n\t\t}\n\t};\n\n\tfunction canNavigate(url, obj){\n\t\tif (url === logout){\n\t\t\tservice.logout();\n\t\t\tobj.redirect = afterLogout;\n\t\t} else if (url !== login && !service.getStatus()){\n\t\t\tobj.redirect = login;\n\t\t}\n\t}\n\n\tapp.setService(\"user\", service);\n\n\tapp.attachEvent(`app:guard`, function(url: string, _$root: any, obj:any){\n\t\tif (config.public && config.public(url)){\n\t\t\treturn true;\n\t\t}\n\n\t\tif (typeof user === \"undefined\"){\n\t\t\tobj.confirm = service.getStatus(true).then(() => canNavigate(url, obj));\n\t\t}\n\n\t\treturn canNavigate(url, obj);\n\t});\n\n\tif (ping){\n\t\tsetInterval(() => service.getStatus(true), ping);\n\t}\n}","/*\nMIT License\nCopyright (c) 2019 XB Software\n*/\n\nimport { IJetApp, IJetView } from \"./interfaces\";\nexport { IJetApp, IJetView };\n\nimport {NavigationBlocked} from \"./errors\";\n\nexport { JetApp } \t\tfrom \"./JetApp\";\nexport { JetView } \t\tfrom \"./JetView\";\n\nexport { HashRouter } \tfrom \"./routers/HashRouter\";\nexport { StoreRouter }\tfrom \"./routers/StoreRouter\";\nexport { UrlRouter } \tfrom \"./routers/UrlRouter\";\nexport { EmptyRouter } \tfrom \"./routers/EmptyRouter\";\nexport { SubRouter } \tfrom \"./routers/SubRouter\";\n\nimport {UnloadGuard} \tfrom \"./plugins/Guard\";\nimport {Locale} \t\tfrom \"./plugins/Locale\";\nimport {Menu} \t\t\tfrom \"./plugins/Menu\";\nimport {Status} \t\tfrom \"./plugins/Status\";\nimport {Theme} \t\t\tfrom \"./plugins/Theme\";\nimport {UrlParam}\t\tfrom \"./plugins/UrlParam\";\nimport {User} \t\t\tfrom \"./plugins/User\";\n\nimport patch from \"./patch\";\nlet webix = (window as any).webix;\nif (webix){\n\tpatch(webix);\n}\n\nexport const plugins = {\n\tUnloadGuard, Locale, Menu, Theme, User, Status, UrlParam\n};\n\nexport const errors = { NavigationBlocked };\n\nconst w = window as any;\nif (!w.Promise){\n\tw.Promise = w.webix.promise;\n}"],"names":["Polyglot"],"mappings":"MAAa,iBAAiB;CAAG;;MCGX,OAAO;IAiB5B,YAAY,KAAkB,EAAE,MAAW;QAdpC,aAAQ,GAAG,IAAI,CAAC;QAetB,IAAI,CAAC,KAAK,GAAG,KAAK,CAAC;QACnB,IAAI,CAAC,OAAO,GAAG,EAAE,CAAC;QAClB,IAAI,CAAC,KAAK,GAAG,EAAE,CAAC;QAChB,IAAI,CAAC,KAAK,GAAG,EAAE,CAAC;QAEhB,IAAI,MAAM,IAAI,MAAM,CAAC,MAAM;YAC1B,KAAK,CAAC,MAAM,CAAC,IAAI,CAAC,KAAK,EAAE,MAAM,CAAC,MAAM,CAAC,CAAC;KACzC;IAED,OAAO;QACN,OAAO,IAAI,CAAC,KAAK,CAAC;KAClB;IAED,UAAU;QACT,IAAI,CAAC,aAAa,EAAE,CAAC;QACrB,IAAI,CAAC,YAAY,EAAE,CAAC;QACpB,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,GAAG,GAAG,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC;KAC7E;IACD,QAAQ,CAAC,EAAS,EAAE,KAAS,EAAE,GAAY;QAC1C,IAAI,IAAI,CAAC,KAAK,CAAC,EAAE,CAAC,KAAK,KAAK,EAAC;YAC5B,IAAI,CAAC,KAAK,CAAC,EAAE,CAAC,GAAG,KAAK,CAAC;YACvB,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,EAAE,EAAE,KAAK,EAAE,CAAC,CAAC,CAAC;YACnC,IAAI,GAAG,EAAC;gBACP,OAAO,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;aACvB;SACD;KACD;IACD,QAAQ,CAAC,EAAS,EAAE,MAAc;QACjC,MAAM,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC,EAAE,CAAC,CAAC;QAC7B,IAAI,OAAO,KAAK,KAAK,WAAW,IAAI,CAAC,MAAM,EAAC;YAC3C,OAAO,KAAK,CAAC;SACb;QAED,MAAM,IAAI,GAAG,IAAI,CAAC,aAAa,EAAE,CAAC;QAClC,IAAI,IAAI,EAAC;YACR,OAAO,IAAI,CAAC,QAAQ,CAAC,EAAE,EAAE,MAAM,CAAC,CAAC;SACjC;KACD;IACD,MAAM;QACL,OAAO,IAAI,CAAC,QAAQ,CAAC,MAAM,EAAE,CAAC;KAC9B;IACD,YAAY;QACX,OAAO,IAAI,CAAC,QAAQ,CAAC,QAAQ,EAAE,CAAC;KAChC;IAED,aAAa;QACZ,OAAO,IAAI,CAAC,OAAO,CAAC;KACpB;IAED,EAAE,CAAC,EAAqB;QACvB,IAAI,OAAO,EAAE,KAAK,QAAQ,EAAC;YAC1B,MAAM,IAAI,GAAG,IAAI,CAAC,OAAO,EAAS,CAAC;YACnC,OAAO,IAAI,CAAC,SAAS,EACnB,GAAG,IAAI,CAAC,GAAG,CAAC,MAAM,CAAC,EAAE,KAAK,EAAE,IAAI,GAAG,CAAC,MAAM,CAAC,OAAO,KAAK,EAAE;iBACvD,GAAG,CAAC,MAAM,KAAK,IAAI,CAAC,MAAM,CAAC,GAE9B,MAAM,CAAC,CAAC;SACT;aAAM;YACN,OAAO,EAAE,CAAC;SACV;KACD;IAED,EAAE,CAAC,GAAG,EAAE,IAAI,EAAE,IAAI;QACjB,MAAM,EAAE,GAAG,GAAG,CAAC,WAAW,CAAC,IAAI,EAAE,IAAI,CAAC,CAAC;QACvC,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,EAAE,GAAG,EAAE,EAAE,EAAE,CAAC,CAAC;QAC/B,OAAO,EAAE,CAAC;KACV;IAED,QAAQ,CAAC,IAAc;QACtB,KAAK,MAAM,GAAG,IAAI,IAAI,CAAC,KAAK,EAAC;YAC5B,MAAM,GAAG,GAAG,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC;YACjC,IAAI,GAAG,KAAK,IAAI,IAAI,GAAG,CAAC,QAAQ,CAAC,IAAI,CAAC,EAAC;gBACtC,OAAO,IAAI,CAAC;aACZ;SACD;QACD,OAAO,KAAK,CAAC;KACb;IAED,UAAU,CAAC,IAAY;QACtB,MAAM,GAAG,GAAG,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,CAAC;QACtC,IAAI,GAAG,EAAC;YACP,OAAO,GAAG,CAAC,OAAO,CAAC,IAAI,CAAC;SACxB;KACD;IAED,cAAc,CAAC,IAAY;QAC1B,MAAM,GAAG,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,IAAI,SAAS,CAAC,CAAC;QAC1C,IAAI,GAAG,EAAC;YACP,OAAO,EAAE,OAAO,EAAC,GAAG,EAAE,MAAM,EAAC,IAAI,EAAE,CAAC;SACpC;QAED,IAAI,IAAI,KAAK,MAAM,EAAC;YACnB,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,GAAG,EAAE,GAAG,EAAC,EAAE,EAAE,EAAE,EAAC,IAAI,EAAE,KAAK,EAAC,IAAI,EAAE,CAAC;YACnD,OAAO,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,CAAC;SACjC;;QAGD,IAAI,IAAI,CAAC,OAAO,EAAC;YAChB,OAAO,IAAI,CAAC,OAAO,CAAC,cAAc,CAAC,IAAI,CAAC,CAAC;SACzC;QACD,OAAO,IAAI,CAAC;KACZ;IAQS,aAAa;QACtB,MAAM,MAAM,GAAG,IAAI,CAAC,OAAO,CAAC;QAC5B,KAAK,IAAI,CAAC,GAAG,MAAM,CAAC,MAAM,GAAG,CAAC,EAAE,CAAC,IAAI,CAAC,EAAE,CAAC,EAAE,EAAC;YAC3C,MAAM,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,WAAW,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC;SACxC;KACD;IACS,YAAY;;QAErB,KAAK,MAAM,GAAG,IAAI,IAAI,CAAC,KAAK,EAAC;YAC5B,MAAM,OAAO,GAAG,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC;;;YAGrC,IAAI,OAAO,EAAC;gBACX,OAAO,CAAC,UAAU,EAAE,CAAC;aACrB;SACD;;QAGD,IAAI,CAAC,KAAK,GAAG,EAAE,CAAC;KAChB;IACS,cAAc;QACvB,MAAM,GAAG,GAAG,IAAI,CAAC,QAAQ,CAAC,OAAO,EAAE,CAAC;QACpC,IAAI,CAAC,KAAK,GAAG,EAAE,CAAC;QAChB,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,IAAI,CAAC,KAAK,EAAE,GAAG,CAAC,MAAM,EAAE,IAAI,CAAC,CAAC;KAChD;IAES,cAAc;QACvB,IAAI,IAAI,CAAC,KAAK,CAAC,OAAO,EAAC;YACtB,OAAO,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC;SAC1B;QACD,KAAK,MAAM,GAAG,IAAI,IAAI,CAAC,KAAK,EAAC;YAC5B,MAAM,GAAG,GAAG,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;YAC5B,IAAI,CAAC,GAAG,CAAC,MAAM,IAAI,GAAG,CAAC,IAAI,IAAI,GAAG,KAAK,MAAM,EAAC;gBAC7C,MAAM,KAAK,GAAI,GAAG,CAAC,IAAgB,CAAC,cAAc,EAAE,CAAC;gBACrD,IAAI,KAAK,EAAC;oBACT,OAAO,KAAK,CAAC;iBACb;aACD;SACD;KACD;IAES,YAAY;QACrB,MAAM,MAAM,GAAG,IAAI,CAAC,aAAa,EAAa,CAAC;QAC/C,IAAI,CAAC,MAAM,EAAC;YACX,OAAO,IAAI,CAAC;SACZ;QAED,MAAM,GAAG,GAAG,MAAM,CAAC,cAAc,EAAE,CAAC;QACpC,IAAI,CAAC,GAAG,IAAI,GAAG,KAAK,IAAI,EAAC;YACxB,OAAO,KAAK,CAAC;SACb;QAED,OAAO,MAAM,CAAC,YAAY,EAAE,CAAC;KAC7B;CAGD;;SCvLe,KAAK,CAAC,GAAU;;IAE/B,IAAI,GAAG,CAAC,CAAC,CAAC,KAAK,GAAG,EAAC;QAClB,GAAG,GAAG,GAAG,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC;KACpB;;IAGD,MAAM,KAAK,GAAG,GAAG,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;IAC7B,MAAM,MAAM,GAAkB,EAAE,CAAC;;IAGjC,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,KAAK,CAAC,MAAM,EAAE,CAAC,EAAE,EAAC;QACrC,MAAM,IAAI,GAAG,KAAK,CAAC,CAAC,CAAC,CAAC;QACtB,MAAM,MAAM,GAAG,EAAE,CAAC;;;;QAKlB,IAAI,GAAG,GAAG,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC;QAC5B,IAAI,GAAG,KAAK,CAAC,CAAC,EAAC;YACd,GAAG,GAAG,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC;SACxB;QAED,IAAI,GAAG,KAAK,CAAC,CAAC,EAAC;YACd,MAAM,MAAM,GAAG,IAAI,CAAC,MAAM,CAAC,GAAG,GAAC,CAAC,CAAC,CAAC,KAAK,CAAC,WAAW,CAAC,CAAC;;YAErD,KAAK,MAAM,KAAK,IAAI,MAAM,EAAE;gBAC3B,MAAM,MAAM,GAAG,KAAK,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;gBAChC,MAAM,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,GAAG,kBAAkB,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC;aAClD;SACD;;QAGD,MAAM,CAAC,CAAC,CAAC,GAAG;YACX,IAAI,GAAG,GAAG,GAAG,CAAC,CAAC,GAAG,IAAI,CAAC,MAAM,CAAC,CAAC,EAAE,GAAG,CAAC,GAAG,IAAI,CAAC;YAC7C,MAAM,EAAC,MAAM;YACb,KAAK,EAAC,IAAI;SACV,CAAC;KACF;;IAGD,OAAO,MAAM,CAAC;CACd;AAED,SAAgB,OAAO,CAAC,KAAoB;IAC3C,MAAM,GAAG,GAAG,EAAE,CAAC;IAEf,KAAK,MAAM,KAAK,IAAI,KAAK,EAAC;QACzB,GAAG,CAAC,IAAI,CAAC,GAAG,GAAC,KAAK,CAAC,IAAI,CAAC,CAAC;QACzB,MAAM,MAAM,GAAG,OAAO,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC;QACrC,IAAI,MAAM,EAAC;YACV,GAAG,CAAC,IAAI,CAAC,GAAG,GAAC,MAAM,CAAC,CAAC;SACrB;KACD;IAED,OAAO,GAAG,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;CACpB;AAED,SAAS,OAAO,CAAC,GAAG;IACnB,MAAM,GAAG,GAAG,EAAE,CAAC;IACf,KAAK,MAAM,GAAG,IAAI,GAAG,EAAC;QACrB,IAAI,OAAO,GAAG,CAAC,GAAG,CAAC,KAAK,QAAQ;YAAE,SAAS;QAC3C,IAAI,GAAG,CAAC,MAAM,EAAC;YACd,GAAG,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;SACd;QACD,GAAG,CAAC,IAAI,CAAC,GAAG,GAAC,GAAG,GAAC,kBAAkB,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;KAC/C;IAED,OAAO,GAAG,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;CACpB;;MCnEY,KAAK;IAKjB,YAAY,KAAmB,EAAE,KAAa;QAFtC,UAAK,GAAW,CAAC,CAAC;QAGzB,IAAI,OAAO,KAAK,KAAK,QAAQ,EAAC;YAC7B,IAAI,CAAC,KAAK,GAAG;gBACZ,GAAG,EAAC,KAAK,CAAC,KAAK,CAAC;gBAChB,IAAI,EAAE,KAAK;aACX,CAAC;SACF;aAAM;YACN,IAAI,CAAC,KAAK,GAAG,KAAK,CAAC;SACnB;QAED,IAAI,CAAC,KAAK,GAAG,KAAK,CAAC;KACnB;IACD,OAAO;QACN,OAAO,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;KAClC;IACD,IAAI;QACH,OAAO,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC,CAAC;KAC/C;IAED,MAAM;QACL,OAAO,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,KAAK,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;KACxC;IACD,KAAK,CAAC,MAAM;QACX,MAAM,KAAK,GAAG,IAAI,KAAK,CAAC,IAAI,CAAC,KAAK,EAAE,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC,CAAC;QAC7D,KAAK,CAAC,SAAS,CAAC,KAAK,CAAC,KAAK,CAAC,GAAG,EAAE,MAAM,EAAE,KAAK,CAAC,KAAK,CAAC,CAAC;QACtD,OAAO,KAAK,CAAC;KACb;IACD,SAAS,CAAC,GAAG,EAAE,MAAM,EAAE,KAAK;QAC3B,IAAI,MAAM,EAAE;YACX,MAAM,GAAG,GAAG,GAAG,CAAC,KAAK,CAAC,CAAC,MAAM,CAAC;YAC9B,KAAK,IAAI,GAAG,IAAI,MAAM;gBAAE,GAAG,CAAC,GAAG,CAAC,GAAG,MAAM,CAAC,GAAG,CAAC,CAAC;SAC/C;KACD;IACD,OAAO;QACN,MAAM,GAAG,GAAG,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC;QAC3B,KAAK,IAAI,CAAC,GAAC,IAAI,CAAC,KAAK,GAAC,CAAC,EAAE,CAAC,GAAC,GAAG,CAAC,MAAM,EAAE,CAAC,EAAE,EAAC;YAC1C,GAAG,CAAC,CAAC,CAAC,CAAC,KAAK,GAAG,IAAI,CAAC;SACpB;KACD;IACD,QAAQ;QACP,MAAM,GAAG,GAAG,OAAO,CAAC,IAAI,CAAC,MAAM,EAAE,CAAC,CAAC;QACnC,OAAO,GAAG,GAAG,GAAG,CAAC,MAAM,CAAC,CAAC,CAAC,GAAG,EAAE,CAAC;KAChC;IACD,KAAK,CAAC,IAAY,EAAE,IAAc;QACjC,IAAI,GAAG,GAAG,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC;QACzB,IAAI,IAAI,KAAK,IAAI,EAAC;YACjB,OAAO,GAAG,CAAC;SACX;QAED,MAAM,GAAG,GAAG,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC;QAC3B,IAAI,KAAK,GAAG,IAAI,CAAC;QACjB,GAAG,GAAG,GAAG,CAAC,KAAK,CAAC,CAAC,EAAE,IAAI,CAAC,KAAK,IAAE,IAAI,GAAC,IAAI,CAAC,KAAK,GAAC,CAAC,CAAC,CAAC,CAAC;QACnD,IAAI,IAAI,EAAC;YACR,GAAG,GAAG,GAAG,CAAC,MAAM,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC,CAAC;YAE9B,KAAK,IAAI,CAAC,GAAC,CAAC,EAAE,CAAC,GAAC,GAAG,CAAC,MAAM,EAAE,CAAC,EAAE,EAAC;gBAC/B,IAAI,GAAG,CAAC,CAAC,CAAC,EAAC;oBACV,GAAG,CAAC,CAAC,CAAC,CAAC,IAAI,GAAG,GAAG,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC;iBAC1B;gBACD,IAAI,KAAK,IAAI,GAAG,CAAC,CAAC,CAAC,IAAI,GAAG,CAAC,CAAC,CAAC,CAAC,IAAI,KAAK,GAAG,CAAC,CAAC,CAAC,CAAC,IAAI,EAAE;oBACnD,GAAG,CAAC,CAAC,CAAC,CAAC,KAAK,GAAG,KAAK,CAAC;iBACrB;qBAAM,IAAI,GAAG,CAAC,CAAC,CAAC,CAAC,KAAK,EAAE;;oBAExB,KAAK,GAAG,KAAK,CAAC;iBACd;aACD;SACD;QAED,OAAO,GAAG,CAAC;KACX;IAED,MAAM,CAAC,IAAW;QACjB,MAAM,GAAG,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,EAAE,IAAI,CAAC,CAAC;QACnC,IAAI,CAAC,KAAK,CAAC,IAAI,GAAG,OAAO,CAAC,GAAG,CAAC,CAAC;QAC/B,IAAI,CAAC,KAAK,CAAC,GAAG,GAAG,GAAG,CAAC;QAErB,OAAO,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC;KACvB;IAED,IAAI,CAAC,IAAkB,EAAE,IAAa,EAAE,IAAc;QACrD,MAAM,GAAG,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,GAAG,EAAE,IAAI,CAAC,CAAC;QACvC,IAAI,CAAC,SAAS,CAAC,GAAG,EAAE,IAAI,CAAC,MAAM,EAAE,IAAI,CAAC,KAAK,IAAI,IAAI,GAAG,IAAI,CAAC,KAAK,GAAG,CAAC,CAAC,CAAC,CAAC;QAGvE,OAAO,IAAI,OAAO,CAAC,CAAC,GAAG,EAAE,GAAG;YAC3B,MAAM,QAAQ,GAAG,OAAO,CAAC,GAAG,CAAC,CAAC;YAC9B,MAAM,GAAG,GAAG;gBACX,GAAG;gBACH,QAAQ;gBACR,OAAO,EAAE,OAAO,CAAC,OAAO,EAAE;aAC1B,CAAC;YAEF,MAAM,GAAG,GAAG,IAAI,GAAG,IAAI,CAAC,GAAG,GAAG,IAAI,CAAC;;;YAGnC,IAAI,GAAG,EAAC;gBACP,MAAM,MAAM,GAAG,GAAG,CAAC,SAAS,CAAC,WAAW,EAAE,CAAC,GAAG,CAAC,QAAQ,EAAE,IAAI,EAAE,GAAG,CAAC,CAAC,CAAC;gBACrE,IAAI,CAAC,MAAM,EAAC;oBACX,GAAG,CAAC,IAAI,iBAAiB,EAAE,CAAC,CAAC;oBAC7B,OAAO;iBACP;aACD;YAGD,GAAG,CAAC,OAAO,CAAC,KAAK,CAAC,GAAG,IAAI,GAAG,CAAC,GAAG,CAAC,CAAC,CAAC,IAAI,CAAC;gBACvC,IAAI,GAAG,CAAC,QAAQ,KAAK,IAAI,EAAC;oBACzB,GAAG,CAAC,IAAI,iBAAiB,EAAE,CAAC,CAAC;oBAC7B,OAAO;iBACP;gBAED,IAAI,GAAG,CAAC,QAAQ,KAAK,QAAQ,EAAC;oBAC7B,GAAG,CAAC,IAAI,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC;oBACvB,GAAG,CAAC,IAAI,iBAAiB,EAAE,CAAC,CAAC;oBAC7B,OAAO;iBACP;gBAED,IAAI,CAAC,KAAK,CAAC,IAAI,GAAG,QAAQ,CAAC;gBAC3B,IAAI,CAAC,KAAK,CAAC,GAAG,GAAG,GAAG,CAAC;gBACrB,GAAG,EAAE,CAAC;aACN,CAAC,CAAC;SACH,CAAC,CAAC;KACH;IACD,IAAI,CAAC,CAAQ;QACZ,IAAI,CAAC,KAAK,GAAG,CAAC,CAAC;KACf;IACD,KAAK;QACJ,MAAM,KAAK,GAAG;YACb,GAAG,EAAE,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,KAAK,CAAC,IAAI,CAAC,KAAK,GAAC,CAAC,CAAC;YACvC,IAAI,EAAC,EAAE;SACP,CAAC;QAEF,IAAI,KAAK,CAAC,GAAG,CAAC,MAAM,EAAC;YACpB,KAAK,CAAC,IAAI,GAAG,OAAO,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;SAChC;QAED,OAAO,IAAI,KAAK,CAAC,KAAK,EAAE,CAAC,CAAC,CAAC;KAC3B;IACD,MAAM,CAAC,IAAW,EAAE,KAAa,EAAE,KAAa;QAC/C,MAAM,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,IAAI,CAAC,KAAK,IAAI,KAAK,IAAI,CAAC,CAAC,CAAC,CAAC;QACxD,IAAI,CAAC,KAAK,EAAC;YACV,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,IAAI,CAAC,EAAE,IAAI,EAAC,EAAE,EAAE,MAAM,EAAC,EAAE,EAAE,CAAC,CAAC;YAC5C,OAAO,IAAI,CAAC,MAAM,CAAC,IAAI,EAAE,KAAK,EAAE,KAAK,CAAC,CAAC;SACvC;QAED,IAAI,IAAI,KAAK,EAAE,EAAC;YACf,KAAK,CAAC,IAAI,GAAG,KAAK,CAAC;SACnB;aAAM;YACN,KAAK,CAAC,MAAM,CAAC,IAAI,CAAC,GAAG,KAAK,CAAC;SAC3B;QAED,IAAI,CAAC,KAAK,CAAC,IAAI,GAAG,OAAO,CAAC,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;KAC1C;CACD;;MC1JY,OAAQ,SAAQ,OAAO;IAGnC,YAAY,GAAa,EAAE,MAAY;QACtC,KAAK,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC;QAEjB,IAAI,CAAC,GAAG,GAAG,GAAG,CAAC;;QAGf,IAAI,CAAC,SAAS,GAAG,EAAE,CAAC;KACpB;IAED,EAAE,CACD,EAA8B,EAC9B,MAAkB;QAElB,MAAM,GAAG,MAAM,IAAI,EAAE,CAAC;QACtB,MAAM,SAAS,GAAG,MAAM,CAAC,SAAS,IAAK,EAAkB,CAAC,SAAS,CAAC;QAEpE,MAAM,OAAO,GAAG,IAAI,CAAC,GAAG,CAAC,UAAU,CAAC,EAAE,CAAC,CAAC;QACxC,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;QAE7B,OAAO,CAAC,MAAM,CAAC,SAAS,EAAE,IAAI,CAAC,QAAQ,EAAE,IAAI,CAAC,CAAC;QAE/C,IAAI,OAAO,EAAE,KAAK,QAAQ,KAAK,EAAE,YAAY,OAAO,CAAC,EAAC;;YAErD,OAAO,OAAO,CAAC;SACf;aAAM;YACN,OAAO,OAAO,CAAC,OAAO,EAAE,CAAC;SACzB;KACD;IAED,IAAI,CAAC,IAAQ,EAAE,MAAW;QACzB,MAAM,GAAG,MAAM,IAAI,EAAE,CAAC;;QAGtB,IAAI,OAAO,IAAI,KAAK,QAAQ,EAAC;YAC5B,KAAK,MAAM,GAAG,IAAI,IAAI,EAAC;gBACtB,IAAI,CAAC,QAAQ,CAAC,GAAG,EAAE,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC;aAC9B;YACD,IAAI,GAAG,IAAI,CAAC;SACZ;aAAM;;YAGN,IAAI,IAAI,CAAC,MAAM,CAAC,CAAC,EAAC,CAAC,CAAC,KAAK,GAAG,EAAC;gBAC5B,OAAO,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,IAAI,EAAE,MAAM,CAAC,CAAC;aACnC;;YAGD,IAAI,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,KAAK,CAAC,EAAC;gBAC5B,IAAI,GAAG,IAAI,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC;aACtB;;YAGD,IAAI,IAAI,CAAC,OAAO,CAAC,KAAK,CAAC,KAAK,CAAC,EAAC;gBAC7B,MAAM,MAAM,GAAG,IAAI,CAAC,aAAa,EAAE,CAAC;gBACpC,IAAI,MAAM,EAAC;oBACV,OAAO,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,CAAC,EAAE,MAAM,CAAC,CAAC;iBAC3C;qBAAM;oBACN,OAAO,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,GAAG,GAAC,IAAI,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC;iBACzC;aACD;YAED,MAAM,GAAG,GAAG,IAAI,CAAC,cAAc,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC;YAC/C,IAAI,GAAG,EAAC;gBACP,IAAI,GAAG,CAAC,MAAM,KAAK,IAAI,EAAC;oBACvB,OAAO,GAAG,CAAC,MAAM,CAAC,IAAI,CAAC,IAAI,EAAE,MAAM,CAAC,CAAC;iBACrC;qBAAM,IAAI,MAAM,CAAC,MAAM,IAAI,MAAM,CAAC,MAAM,KAAK,SAAS,EAAC;oBACvD,OAAO,IAAI,CAAC,gBAAgB,CAAC,MAAM,CAAC,MAAM,EAAE,GAAG,CAAC,OAAO,EAAE;wBACxD,GAAG,EAAE,IAAI;wBACT,MAAM,EAAE,MAAM,CAAC,MAAM;qBACrB,CAAC,CAAC;iBACH;aACD;iBAAM;gBACN,IAAI,IAAI,EAAC;oBACR,OAAO,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,GAAG,GAAG,IAAI,EAAE,MAAM,CAAC,CAAC;iBACzC;aACD;SAED;QAED,OAAO,IAAI,CAAC,KAAK,CAChB,IAAI,CAAC,QAAQ,EACb,EAAE,GAAG,EAAE,IAAI,EAAE,MAAM,EAAE,MAAM,CAAC,MAAM,EAAE,EACpC,IAAI,CACJ,CAAC;KACF;IAED,KAAK,CAAC,OAAc,EAAE,IAAkB,EAAE,IAAa;QACtD,OAAO,OAAO,CAAC,IAAI,CAAC,IAAI,EAAE,IAAI,EAAE,IAAI,CAAC,CAAC,IAAI,CAAC;YAC1C,IAAI,CAAC,cAAc,EAAE,CAAC;YACtB,OAAO,IAAI,CAAC,UAAU,EAAE,CAAC;SACzB,CAAC,CAAC,IAAI,CAAC;YACP,IAAI,OAAO,CAAC,KAAK,CAAC,UAAU,EAAC;gBAC5B,IAAI,CAAC,GAAG,CAAC,SAAS,EAAE,CAAC,GAAG,CAAC,OAAO,CAAC,KAAK,CAAC,IAAI,EAAE,EAAE,MAAM,EAAE,IAAI,EAAE,CAAC,CAAC;gBAC/D,IAAI,CAAC,GAAG,CAAC,SAAS,CAAC,WAAW,EAAE,CAAC,OAAO,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC,CAAC;aACtD;SACD,CAAC,CAAC;KACH;IAED,IAAI,CAAC,MAAgB,EAAE,EAAW;;KAEjC;IACD,KAAK,CAAC,MAAgB,EAAE,KAAc;;KAErC;IACD,MAAM;QACL,IAAI,CAAC,GAAG,CAAC,KAAK,CAAC,OAAO,CAAC,gCAAgC,CAAC,CAAC;KACzD;IACD,SAAS,CAAC,MAAiB,EAAE,KAAe;;KAE3C;IAED,OAAO;;KAEN;IAED,UAAU;QACT,IAAI,CAAC,OAAO,EAAE,CAAC;QACf,IAAI,CAAC,YAAY,EAAE,CAAC;;QAGpB,IAAI,IAAI,CAAC,KAAK,EAAE;YACf,IAAI,CAAC,KAAK,CAAC,UAAU,EAAE,CAAC;YACxB,KAAK,CAAC,UAAU,EAAE,CAAC;SACnB;KACD;IAED,GAAG,CAAC,MAAM,EAAE,MAAM;QACjB,MAAM,CAAC,IAAI,CAAC,GAAG,EAAE,IAAI,EAAE,MAAM,CAAC,CAAC;KAC/B;IAED,OAAO;QACN,MAAM,GAAG,GAAG,IAAI,CAAC,MAAM,EAAE,CAAC;QAC1B,IAAI,CAAC,OAAO,EAAE,CAAC;QACf,IAAI,CAAC,YAAY,EAAE,CAAC;QACpB,IAAI,CAAC,YAAY,EAAE,CAAC;QACpB,IAAI,CAAC,aAAa,EAAE,CAAC;QAErB,IAAK,IAAI,CAAC,UAAkB,CAAC,OAAO,EAAC;YACpC,IAAI,CAAC,KAAK,CAAC,UAAU,EAAE,CAAC;SACxB;QAED,IAAI,CAAC,QAAQ,CAAC,OAAO,EAAE,CAAC;QACxB,OAAO,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;KACnC;IAED,MAAM,CACL,IAAqC,EACrC,GAAW,EAAE,MAAiB;QAE9B,IAAI,OAAO,GAAG,KAAK,QAAQ,EAAC;YAC3B,GAAG,GAAG,IAAI,KAAK,CAAC,GAAG,EAAE,CAAC,CAAC,CAAC;SACxB;QAED,IAAI,CAAC,QAAQ,GAAG,GAAG,CAAC;QAEpB,IAAI,CAAC,OAAO,GAAG,MAAM,CAAC;QACtB,IAAI,CAAC,cAAc,EAAE,CAAC;QAEtB,IAAI,GAAG,IAAI,IAAI,QAAQ,CAAC,IAAI,CAAC;QAC7B,MAAM,UAAU,GAAG,CAAC,OAAO,IAAI,KAAK,QAAQ,IAAI,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,IAAI,CAAC,GAAG,IAAI,CAAC;QAE/E,IAAI,IAAI,CAAC,UAAU,KAAK,UAAU,EAAE;YACnC,IAAI,CAAC,UAAU,GAAG,UAAU,CAAC;YAC7B,OAAO,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC;SACzB;aAAM;YACN,OAAO,IAAI,CAAC,UAAU,EAAE,CAAC,IAAI,CAAC,MAAM,IAAI,CAAC,OAAO,EAAE,CAAC,CAAC;SACpD;KACD;IAES,OAAO,CAAC,GAAW;QAC5B,MAAM,MAAM,GAAG,IAAI,CAAC,MAAM,EAAE,CAAC;QAC7B,IAAI,MAAM,CAAC,IAAI,EAAC;YACf,OAAO,MAAM,CAAC,IAAI,CAAC,GAAG,IAAI,IAAI,CAAC,aAAa,CAAC,GAAG,EAAE,GAAG,CAAC,CAAC,CAAC;SACxD;aAAM;YACN,OAAO,IAAI,CAAC,aAAa,CAAC,MAAM,EAAE,GAAG,CAAC,CAAC;SACvC;KACD;IAES,aAAa,CAAC,MAAU,EAAE,GAAU;;QAE7C,IAAI,IAAI,GAAY,IAAI,CAAC;QACzB,IAAI,SAAS,GAAgC,IAAI,CAAC;QAClD,IAAI,IAAI,GAAG,KAAK,CAAC;QACjB,IAAI,CAAE,IAAI,CAAC,UAA0B,CAAC,OAAO,EAAC;YAC7C,IAAI,GAAI,IAAI,CAAC,UAAuB,CAAC;YACrC,IAAI,IAAI,CAAC,KAAK,EAAC;gBACd,SAAS,GAAG,QAAQ,CAAC,IAAI,CAAC;gBAC1B,IAAI,GAAG,IAAI,CAAC;aACZ;iBAAM;gBACN,SAAS,GAAG,IAAI,CAAC,KAAK,CAAC,EAAE,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;aACnC;SACD;aAAM;YACN,SAAS,GAAG,IAAI,CAAC,UAAyB,CAAC;SAC3C;;QAGD,IAAI,CAAC,IAAI,CAAC,GAAG,IAAI,CAAC,SAAS,EAAC;YAC3B,OAAO,OAAO,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC;SAC5B;QAED,IAAI,QAAqB,CAAC;QAC1B,MAAM,OAAO,GAAG,IAAI,CAAC,QAAQ,CAAC,OAAO,EAAE,CAAC;;QAGxC,MAAM,MAAM,GAAO,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC;QAC9B,IAAI,CAAC,GAAG,CAAC,UAAU,CAAC,MAAM,EAAE,MAAM,CAAC,EAAE,EAAE,IAAI,CAAC,KAAK,CAAC,CAAC;QACnD,IAAI,CAAC,GAAG,CAAC,SAAS,CAAC,YAAY,EAAE,CAAC,IAAI,EAAE,GAAG,EAAE,MAAM,CAAC,CAAC,CAAC;QACtD,MAAM,CAAC,EAAE,CAAC,MAAM,GAAG,IAAI,CAAC;;QAGxB,IAAI,CAAC,IAAI,IAAI,OAAO,CAAC,KAAK,IAAI,OAAO,CAAC,IAAI,EAAC;YAC1C,OAAO,CAAC,IAAI,CAAC,UAAU,EAAE,CAAC;SAC1B;QAED,IAAI;;YAEH,IAAI,IAAI,IAAI,CAAC,IAAI,EAAC;gBACjB,MAAM,KAAK,GAAG,SAAsB,CAAC;gBACrC,MAAM,MAAM,GAAG,KAAK,CAAC,aAAa,EAAE,CAAC;gBACrC,IAAI,MAAM,IAAI,MAAM,CAAC,IAAI,KAAK,WAAW,IAAI,CAAC,MAAM,CAAC,EAAE,CAAC,EAAE,EAAC;oBAC1D,MAAM,CAAC,EAAE,CAAC,EAAE,GAAG,KAAK,CAAC,MAAM,CAAC,EAAE,CAAC;iBAC/B;aACD;YAED,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,GAAG,CAAC,KAAK,CAAC,EAAE,CAAC,MAAM,CAAC,EAAE,EAAE,SAAS,CAAC,CAAC;YACrD,MAAM,KAAK,GAAG,IAAI,CAAC,KAAY,CAAC;;YAEhC,IAAI,IAAI,IAAI,KAAK,CAAC,WAAW,IAAI,CAAC,KAAK,CAAC,SAAS,EAAE,EAAC;gBACnD,KAAK,CAAC,IAAI,EAAE,CAAC;aACb;;YAGD,IAAI,IAAI,EAAC;gBACR,IAAI,IAAI,CAAC,IAAI,IAAI,IAAI,CAAC,IAAI,KAAK,IAAI,IAAI,IAAI,CAAC,IAAI,KAAK,IAAI,CAAC,GAAG,EAAC;oBAC7D,IAAI,CAAC,IAAI,CAAC,UAAU,EAAE,CAAC;iBACvB;gBAED,IAAI,CAAC,EAAE,GAAG,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,EAAY,CAAC;gBACzC,IAAI,IAAI,CAAC,aAAa,EAAE,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,GAAG;oBACxC,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC;qBACb;;;oBAGJ,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC,GAAU,CAAC;iBAC5B;aACD;YAED,IAAI,OAAO,CAAC,KAAK,EAAC;gBACjB,OAAO,CAAC,IAAI,GAAG,IAAI,CAAC;gBACpB,OAAO,CAAC,KAAK,GAAG,KAAK,CAAC;aACtB;YAED,QAAQ,GAAG,OAAO,CAAC,OAAO,CAAC,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,KAAK,EAAE,GAAG,CAAC,CAAC,CAAC,IAAI,CAAC;gBAC5D,OAAO,IAAI,CAAC,UAAU,EAAE,CAAC,IAAI,CAAC;oBAC7B,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC;oBACrB,OAAO,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,KAAK,EAAE,GAAG,CAAC,MAAM,EAAE,CAAC,CAAC;iBAC5C,CAAC,CAAC;aACH,CAAC,CAAC;SACH;QAAC,OAAM,CAAC,EAAC;YACT,QAAQ,GAAG,OAAO,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC;SAC7B;QAED,OAAO,QAAQ,CAAC,KAAK,CAAC,GAAG,IAAI,IAAI,CAAC,UAAU,CAAC,IAAI,EAAE,GAAG,CAAC,CAAC,CAAC;KACzD;IAES,KAAK,CAAC,IAAc,EAAE,GAAW;QAC1C,OAAO,IAAI,CAAC,IAAI,CAAC,IAAI,EAAE,GAAG,CAAC,MAAM,EAAE,CAAC,CAAC;KACrC;IAES,UAAU;QACnB,IAAI,CAAC,GAAG,CAAC,SAAS,CAAC,eAAe,EAAE,CAAC,IAAI,EAAE,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAC;QAE3D,MAAM,KAAK,GAAG,EAAE,CAAC;QACjB,KAAK,MAAM,GAAG,IAAI,IAAI,CAAC,KAAK,EAAC;YAC5B,MAAM,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;YAC9B,MAAM,IAAI,GAAG,IAAI,CAAC,gBAAgB,CAAC,GAAG,EAAE,KAAK,EAAE,IAAI,CAAC,CAAC;YACrD,IAAI,IAAI,EAAC;gBACR,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;aACjB;SACD;QAED,OAAO,OAAO,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC,IAAI,CAAC;YAC9B,OAAO,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,KAAK,EAAE,IAAI,CAAC,QAAQ,CAAC,MAAM,EAAE,CAAC,CAAC;SAC1D,CAAC,CAAC;KACH;IAEU,gBAAgB,CAAC,GAAU,EAAE,KAAc,EAAE,IAAmB;;QAE1E,IAAI,CAAC,KAAK,CAAC,IAAI,EAAE;;YAEhB,MAAM,IAAI,GAAI,IAAI,CAAC,YAAY,CAAC,GAAG,EAAE,KAAK,EAAE,IAAI,CAAC,CAAC;YAClD,IAAI,IAAI,EAAC;;;;gBAIR,KAAK,CAAC,IAAI,GAAG,IAAI,CAAC,IAAI,CAAC,MAAM,KAAK,CAAC,IAAI,GAAG,IAAI,EAAE,MAAM,KAAK,CAAC,IAAI,GAAG,IAAI,CAAC,CAAA;aACxE;SACD;;QAGD,OAAO,KAAK,CAAC,IAAI,CAAC;KAClB;IAES,YAAY,CAAC,GAAU,EAAE,KAAc,EAAE,IAAmB;;QAErE,IAAI,GAAG,KAAK,SAAS,EAAC;YACrB,IAAI,IAAI,CAAC,QAAQ,CAAC,IAAI,EAAE,EAAC;;gBAExB,IAAI,MAAM,GAAG,IAAI,GAAG,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC;gBACvC,IAAI,KAAK,CAAC,MAAM,EAAE;oBACjB,MAAM,GAAG,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,MAAM,IAAI,EAAE,EAAE,KAAK,CAAC,MAAM,CAAC,CAAC;iBACvD;gBACD,OAAO,IAAI,CAAC,cAAc,CAAC,KAAK,EAAE,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC,CAAC;aAC/D;iBAAM,IAAI,KAAK,CAAC,IAAI,IAAI,KAAK,CAAC,KAAK,EAAE;;gBAErC,KAAK,CAAC,IAAI,CAAC,UAAU,EAAE,CAAC;gBACxB,KAAK,CAAC,IAAI,GAAG,IAAI,CAAC;aAClB;SACD;;QAGD,IAAI,IAAI,KAAK,IAAI,EAAC;YACjB,KAAK,CAAC,GAAG,GAAG,IAAI,CAAC,GAAG,CAAC;YACrB,IAAI,KAAK,CAAC,MAAM,EAAE;gBACjB,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,IAAI,CAAC,MAAM,IAAI,EAAE,EAAE,KAAK,CAAC,MAAM,CAAC,CAAC;aACjE;SACD;;QAGD,IAAI,KAAK,CAAC,KAAK,EAAC;;YAEf,IAAI,IAAI,KAAK,IAAI,EAAC;gBACjB,OAAO,KAAK,CAAC,KAAK,CAAC,IAAI,CAAC,IAAI,EAAE,KAAK,CAAC,IAAI,CAAC,CAAC,IAAI,CAAC;oBAC9C,OAAO,IAAI,CAAC,cAAc,CAAC,KAAK,EAAE,KAAK,CAAC,KAAK,CAAC,CAAC;iBAC/C,CAAC,CAAC;aACH;;YAGD,IAAI,KAAK,CAAC,MAAM,EAAC;gBAChB,OAAO;aACP;SACD;QAED,IAAI,IAAI,GAAG,KAAK,CAAC,IAAI,CAAC;;QAEtB,IAAI,CAAC,IAAI,IAAI,KAAK,CAAC,GAAG,EAAC;YACtB,IAAI,OAAO,KAAK,CAAC,GAAG,KAAK,QAAQ,EAAC;;gBAEjC,KAAK,CAAC,KAAK,GAAG,IAAI,KAAK,CAAC,KAAK,CAAC,GAAG,EAAE,CAAC,CAAC,CAAC;gBACtC,IAAI,IAAI;oBAAE,KAAK,CAAC,KAAK,CAAC,SAAS,CAAC,KAAK,CAAC,KAAK,CAAC,KAAK,CAAC,GAAG,EAAE,IAAI,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC;gBACvE,IAAI,KAAK,CAAC,MAAM;oBACf,KAAK,CAAC,KAAK,CAAC,SAAS,CAAC,KAAK,CAAC,KAAK,CAAC,KAAK,CAAC,GAAG,EAAE,KAAK,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC;gBAC/D,OAAO,IAAI,CAAC,cAAc,CAAC,KAAK,EAAE,KAAK,CAAC,KAAK,CAAC,CAAC;aAC/C;iBAAM;;gBAEN,IAAI,OAAO,KAAK,CAAC,GAAG,KAAK,UAAU,IAAI,EAAE,IAAI,YAAY,KAAK,CAAC,GAAG,CAAC,EAAC;oBACnE,IAAI,GAAG,KAAM,IAAI,CAAC,GAAW,CAAC,SAAS,CAAC,KAAK,CAAC,GAAG,CAAC,EAAE,IAAI,CAAC,GAAG,EAAE,EAAE,CAAC,CAAC;iBAClE;gBACD,IAAI,CAAC,IAAI,EAAC;oBACT,IAAI,GAAG,KAAK,CAAC,GAAU,CAAC;iBACxB;aACD;SACD;;QAGD,IAAI,IAAI,EAAC;YACR,OAAO,IAAI,CAAC,MAAM,CAAC,KAAK,GAAG,KAAK,CAAC,KAAK,IAAI,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC,CAAC;SAChE;KACD;IAEO,UAAU,CAAC,IAAS,EAAE,GAAQ;;;;QAIrC,IAAI,IAAI,CAAC,GAAG,EAAC;YACZ,IAAI,CAAC,GAAG,CAAC,KAAK,CAAC,oBAAoB,EAAE,CAAC,GAAG,EAAE,IAAI,CAAC,CAAC,CAAC;SAClD;QACD,OAAO,IAAI,CAAC;KACZ;IAEO,cAAc,CAClB,GAAY,EACZ,MAAa;QAChB,OAAO,IAAI,CAAC,GAAG,CAAC,aAAa,CAAC,MAAM,CAAC,OAAO,EAAE,CAAC,CAAC,IAAI,CAAC,IAAI;YACxD,OAAO,IAAI,CAAC,MAAM,CAAC,GAAG,EAAE,MAAM,EAAE,IAAI,CAAC,CAAC;SACtC,CAAC,CAAC;KACH;IAEO,YAAY;;QAEnB,MAAM,GAAG,GAAG,IAAI,CAAC,SAAS,CAAC;QAC3B,KAAK,IAAI,CAAC,GAAG,GAAG,CAAC,MAAM,GAAG,CAAC,EAAE,CAAC,IAAI,CAAC,EAAE,CAAC,EAAE,EAAC;YACxC,IAAI,GAAG,CAAC,CAAC,CAAC,IAAI,GAAG,CAAC,CAAC,CAAC,CAAC,UAAU,EAAC;gBAC/B,GAAG,CAAC,CAAC,CAAC,CAAC,UAAU,EAAE,CAAC;aACpB;SACD;;QAGD,IAAI,CAAC,SAAS,GAAG,EAAE,CAAC;KACpB;CACD;;ACtZD;AACA,MAAa,UAAW,SAAQ,OAAO;IAGtC,YAAY,GAAW,EAAE,MAAU;QAClC,KAAK,CAAC,GAAG,EAAE,MAAM,CAAC,CAAC;QACnB,IAAI,CAAC,GAAG,GAAG,MAAM,CAAC,EAAE,CAAC;KACrB;IAED,MAAM;QACL,OAAO,IAAI,CAAC,GAAG,CAAC;KAChB;CACD;;MCZY,SAAS;IAKrB,YAAY,EAAsB,EAAE,MAAU,EAAE,GAAW;QAC1D,IAAI,CAAC,IAAI,GAAG,EAAE,CAAC;QACf,IAAI,CAAC,GAAG,GAAG,GAAG,CAAC;KACf;IACD,GAAG,CAAC,IAAW,EAAE,MAAyB;QACzC,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC;QACjB,MAAM,CAAC,GAAG,IAAI,CAAC,GAAU,CAAC;QAC1B,CAAC,CAAC,GAAG,CAAC,SAAS,EAAE,CAAC,GAAG,CAAC,CAAC,CAAC,QAAQ,CAAC,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE,EAAE,MAAM,EAAC,IAAI,EAAE,CAAC,CAAC;KACrE;IACD,GAAG;QACF,OAAO,IAAI,CAAC,IAAI,CAAC;KACjB;CACD;;ACRD,IAAI,KAAK,GAAG,IAAI,CAAC;AAEjB,MAAa,UAAW,SAAQ,OAAO;IAYtC,YAAY,MAAY;QACvB,MAAM,KAAK,GAAG,CAAC,MAAM,IAAI,EAAE,EAAE,KAAK,IAAK,MAAc,CAAC,KAAK,CAAC;QAC5D,MAAM,GAAG,KAAK,CAAC,MAAM,CAAC;YACrB,IAAI,EAAE,KAAK;YACX,OAAO,EAAE,KAAK;YACd,KAAK,EAAE,OAAO;SACd,EAAE,MAAM,EAAE,IAAI,CAAC,CAAC;QAEjB,KAAK,CAAC,KAAK,EAAE,MAAM,CAAC,CAAC;QAErB,IAAI,CAAC,MAAM,GAAG,MAAM,CAAC;QACrB,IAAI,CAAC,GAAG,GAAG,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC;QAC3B,IAAI,CAAC,KAAK,GAAG,OAAO,CAAC,OAAO,EAAE,CAAC;QAC/B,IAAI,CAAC,SAAS,GAAG,EAAE,CAAC;QAEpB,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,IAAI,EAAE,IAAI,CAAC,KAAK,CAAC,WAAW,CAAC,CAAC;KAChD;IACD,MAAM;QACL,OAAO,IAAI,CAAC,WAAW,CAAC,MAAM,EAAE,CAAC;KACjC;IACD,YAAY;QACX,OAAO,IAAI,CAAC,WAAW,CAAC,QAAQ,EAAE,CAAC;KACnC;IACD,UAAU,CAAC,IAAY;QACtB,IAAI,GAAG,GAAG,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC;QAC/B,IAAI,OAAO,GAAG,KAAK,UAAU,EAAE;YAC9B,GAAG,GAAG,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,GAAG,GAAG,CAAC,IAAI,CAAC,CAAC;SACvC;QACD,OAAO,GAAG,CAAC;KACX;IACD,UAAU,CAAC,IAAY,EAAE,OAAY;QACpC,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,GAAG,OAAO,CAAC;KAC/B;IACD,UAAU;QACT,IAAI,CAAC,UAAU,EAAE,CAAC,UAAU,EAAE,CAAC;QAC/B,KAAK,CAAC,UAAU,EAAE,CAAC;KACnB;;IAED,UAAU,CAAC,GAAQ,EAAE,MAAW,EAAE,MAAmB;;QAEpD,IAAI,GAAG,YAAY,OAAO;aACxB,OAAO,GAAG,KAAK,UAAU,IAAI,GAAG,CAAC,SAAS,YAAY,OAAO,CAAC,EAAC;YAChE,GAAG,GAAG,EAAE,QAAQ,EAAE,GAAG,EAAE,CAAC;SACxB;;QAGD,IAAI,OAAO,GAAG,CAAC,QAAQ,IAAI,WAAW,EAAE;YACvC,OAAO,IAAI,CAAC,UAAU,CAAC,GAAG,EAAE,MAAM,EAAE,MAAM,CAAC,CAAC;SAC5C;;QAGD,MAAM,OAAO,GAAG,GAAG,YAAY,KAAK,CAAC;QACrC,MAAM,GAAG,MAAM,KAAK,OAAO,GAAG,EAAE,GAAG,EAAE,CAAC,CAAC;QACvC,KAAK,MAAM,MAAM,IAAI,GAAG,EAAE;YACzB,IAAI,KAAK,GAAG,GAAG,CAAC,MAAM,CAAC,CAAC;;YAGxB,IAAI,OAAO,KAAK,KAAK,UAAU,IAAI,KAAK,CAAC,SAAS,YAAY,OAAO,EAAE;gBACtE,KAAK,GAAG,EAAE,QAAQ,EAAG,KAAK,EAAE,CAAC;aAC7B;YAED,IAAI,KAAK,IAAI,OAAO,KAAK,KAAK,QAAQ;gBACrC,EAAE,KAAK,YAAY,IAAI,CAAC,KAAK,CAAC,cAAc,CAAC,IAAI,EAAE,KAAK,YAAY,MAAM,CAAC,IAAI,EAAE,KAAK,YAAY,GAAG,CAAC,EAAE;gBACxG,IAAI,KAAK,YAAY,IAAI,EAAE;oBAC1B,MAAM,CAAC,MAAM,CAAC,GAAG,IAAI,IAAI,CAAC,KAAK,CAAC,CAAC;iBACjC;qBAAM;oBACN,MAAM,IAAI,GAAG,IAAI,CAAC,UAAU,CAC3B,KAAK,GACJ,KAAK,YAAY,KAAK,GAAG,EAAE,GAAG,EAAE,GACjC,MAAM,CAAC,CAAC;oBACT,IAAI,IAAI,KAAK,IAAI,EAAC;wBACjB,IAAI,OAAO;4BAAE,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;;4BAC1B,MAAM,CAAC,MAAM,CAAC,GAAG,IAAI,CAAC;qBAC3B;iBACD;aACD;iBAAM;gBACN,MAAM,CAAC,MAAM,CAAC,GAAG,KAAK,CAAC;aACvB;SACD;QAED,OAAO,MAAM,CAAC;KACd;IAED,SAAS;QACR,OAAO,IAAI,CAAC,OAAO,CAAC;KACpB;IAED,YAAY,CAAC,CAAQ,EAAE,MAAoB;QAC1C,IAAI,CAAC,EAAE;YACN,MAAM,GAAG,MAAM,KAAK,CAAC,CAAC,MAAM,IAAI,CAAC,CAAC,UAAU,CAAgB,CAAC;YAC7D,IAAI,MAAM,IAAI,MAAM,CAAC,YAAY,EAAE;gBAClC,MAAM,OAAO,GAAW,MAAM,CAAC,YAAY,CAAC,SAAS,CAAC,CAAC;gBACvD,IAAI,OAAO,EAAE;oBACZ,IAAI,CAAC,QAAQ,CAAC,MAAM,EAAE,IAAI,IAAI,IAAI,CAAC,GAAG,CAAC,OAAO,CAAC,OAAO,CAAC,CAAC,CAAC;oBACzD,CAAC,CAAC,YAAY,GAAG,IAAI,CAAC;oBACtB,OAAO,CAAC,CAAC,cAAc,EAAE,CAAC;iBAC1B;gBACD,MAAM,KAAK,GAAW,MAAM,CAAC,YAAY,CAAC,OAAO,CAAC,CAAC;gBACnD,IAAI,KAAK,EAAE;oBACV,IAAI,CAAC,QAAQ,CAAC,MAAM,EAAE,IAAI,IAAI,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC;oBAChD,CAAC,CAAC,YAAY,GAAG,IAAI,CAAC;oBACtB,OAAO,CAAC,CAAC,cAAc,EAAE,CAAC;iBAC1B;aACD;SACD;QAED,MAAM,MAAM,GAAG,MAAM,CAAC,UAAyB,CAAC;QAChD,IAAI,MAAM,EAAC;YACV,IAAI,CAAC,YAAY,CAAC,CAAC,EAAE,MAAM,CAAC,CAAC;SAC7B;KACD;IAED,OAAO;QACN,OAAO,IAAI,CAAC,UAAU,EAAE,CAAC,OAAO,EAAE,CAAC;KACnC;IAED,OAAO;QACN,IAAI,CAAC,IAAI,CAAC,WAAW,EAAC;YACrB,OAAO,OAAO,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC;SAC7B;QAED,OAAO,IAAI,CAAC,UAAU,EAAE,CAAC,OAAO,EAAE,CAAC,IAAI,CAAC,IAAI;YAC3C,IAAI,CAAC,SAAS,CAAC,WAAW,EAAE,CAAC,IAAI,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC;YAC7C,OAAO,IAAI,CAAC;SACZ,CAAC,CAAC;KACH;IAED,QAAQ,CAAC,GAAU;QAClB,MAAM,KAAK,GAAG,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC;QAChC,IAAI,MAAM,GAAG,IAAI,CAAC;QAElB,IAAI,GAAG,KAAK,EAAE,EAAC;YACd,OAAO,OAAO,CAAC,OAAO,CACrB,IAAI,CAAC,UAAU,CAAC,EAAE,EAAE,IAAI,KAAK,CAAC,8BAA8B,CAAC,CAAC,CAC9D,CAAC;SACF;QAED,IAAI;YACH,IAAI,KAAK,EAAE;gBACV,IAAI,OAAO,KAAK,KAAK,UAAU,EAAE;;oBAEhC,MAAM,GAAG,KAAK,CAAC,GAAG,CAAC,CAAC;iBACpB;qBAAM;;oBAEN,MAAM,GAAG,KAAK,CAAC,GAAG,CAAC,CAAC;iBACpB;gBACD,IAAI,OAAO,MAAM,KAAK,QAAQ,EAAC;oBAC9B,GAAG,GAAG,MAAM,CAAC;oBACb,MAAM,GAAG,IAAI,CAAC;iBACd;aACD;YAED,IAAI,CAAC,MAAM,EAAC;gBACX,IAAI,GAAG,KAAK,SAAS,EAAC;oBACrB,MAAM,GAAG,EAAE,MAAM,EAAC,IAAI,EAAE,CAAC;iBACzB;qBAAM,IAAI,GAAG,KAAK,QAAQ,EAAC;oBAC3B,MAAM,GAAG,EAAE,CAAC;iBACZ;qBAAM;oBACN,GAAG,GAAG,GAAG,CAAC,OAAO,CAAC,KAAK,EAAE,GAAG,CAAC,CAAC;oBAC9B,MAAM,GAAG,IAAI,CAAC,OAAO,CAAC,WAAW,EAAE,GAAG,CAAC,CAAC;iBACxC;aACD;SACD;QAAC,OAAM,CAAC,EAAC;YACT,MAAM,GAAG,IAAI,CAAC,UAAU,CAAC,GAAG,EAAE,CAAC,CAAC,CAAC;SACjC;;QAGD,IAAI,CAAC,MAAM,CAAC,IAAI,EAAC;YAChB,MAAM,GAAG,OAAO,CAAC,OAAO,CAAC,MAAM,CAAC,CAAC;SACjC;;QAGD,MAAM,GAAG,MAAM;aACb,IAAI,CAAC,MAAM,IAAI,MAAM,CAAC,UAAU,GAAG,MAAM,CAAC,OAAO,GAAG,MAAM,CAAC;aAC3D,KAAK,CAAC,GAAG,IAAI,IAAI,CAAC,UAAU,CAAC,GAAG,EAAE,GAAG,CAAC,CAAC,CAAC;QAE1C,OAAO,MAAM,CAAC;KACd;IAED,QAAQ,CAAC,MAAmB,EAAE,OAAO;QACpC,MAAM,IAAI,GAAG,IAAI,CAAC,KAAK,CAAC,EAAE,CAAC,MAAa,CAAC,CAAC;QAC1C,IAAI,IAAI,EAAE;YACT,OAAO,CAAE,IAAY,CAAC,MAAM,CAAC,CAAA;SAC7B;KACD;IAED,gBAAgB,CAAC,GAAG;QACnB,OAAO,IAAI,CAAC;KACZ;IAED,aAAa,CAAC,KAAmB;QAChC,IAAI,IAAsB,CAAC;QAE3B,IAAI,KAAK,CAAC,KAAK,IAAI,CAAC,KAAK,CAAC,IAAI,EAAE;YAC/B,IAAI,GAAG,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,IAAI,CAAC;iBAC9B,IAAI,CAAC,EAAE,IAAI,IAAI,CAAC,UAAU,CAAC,EAAE,EAAE,IAAI,EAAE,KAAK,CAAC,MAAM,CAAC,CAAC,CAAC;SACtD;aAAM;YACN,IAAI,GAAG,OAAO,CAAC,OAAO,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;SACnC;QAED,OAAO,IAAI,CAAC;KACZ;IAED,SAAS,CAAC,EAAE;QACX,MAAM,IAAI,GAAG,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC;QAClC,IAAI,IAAI,EAAC;YACR,IAAI,EAAE,CAAC;YACP,OAAM,EAAE,EAAC;gBACR,EAAE,GAAG,EAAE,CAAC;gBACR,EAAE,GAAG,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC;aAClB;YACD,OAAO,EAAE,CAAC;SACV;QACD,OAAO,EAAE,CAAC;KACV;IACD,UAAU,CAAC,EAAM,EAAE,IAAY,EAAE,MAAa;QAC7C,EAAE,GAAG,IAAI,CAAC,SAAS,CAAC,EAAE,CAAC,CAAC;QAExB,IAAI,GAAG,CAAC;QACR,IAAI,OAAO,EAAE,KAAK,UAAU,EAAE;YAC7B,IAAI,EAAE,CAAC,SAAS,YAAY,UAAU,EAAE;;gBAEvC,OAAO,IAAI,EAAE,CAAC,EAAE,GAAG,EAAE,IAAI,EAAE,IAAI,EAAE,MAAM,EAAE,MAAM,EAAC,SAAS,EAAE,CAAC,CAAC;aAC7D;iBAAM,IAAI,EAAE,CAAC,SAAS,YAAY,OAAO,EAAE;;gBAE3C,OAAO,IAAI,EAAE,CAAC,IAAI,EAAE,EAAE,IAAI,EAAE,MAAM,EAAE,CAAC,CAAC;aACtC;iBAAM;;gBAEN,EAAE,GAAG,EAAE,CAAC,IAAI,CAAC,CAAC;aACd;SACD;QAED,IAAI,EAAE,YAAY,OAAO,EAAC;YACzB,GAAG,GAAG,EAAE,CAAC;SACT;aAAM;;YAEN,GAAG,GAAG,IAAI,UAAU,CAAC,IAAI,EAAE,EAAE,IAAI,EAAE,EAAE,EAAE,CAAC,CAAC;SACzC;QACD,OAAO,GAAG,CAAC;KACX;;IAGD,IAAI,CAAC,GAAW,EAAE,MAAW;QAC5B,IAAI,GAAG,IAAI,IAAI,CAAC,GAAG,IAAI,GAAG,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC;YAC5C,OAAO,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC,CAAC,EAAE,MAAM,CAAC,CAAC;QAE7C,OAAO,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,UAAU,EAAE,GAAG,IAAI,IAAI,CAAC,MAAM,CAAC,KAAK,EAAE,MAAM,CAAC,CAAC;KACtE;;IAGD,OAAO,CAAC,IAAY,EAAE,GAAG,IAAW;QACnC,IAAI,CAAC,KAAK,CAAC,IAAI,EAAE,IAAI,CAAC,CAAC;KACvB;IACD,KAAK,CAAC,IAAY,EAAE,IAAW;QAC9B,IAAI,CAAC,SAAS,CAAC,IAAI,EAAE,IAAI,CAAC,CAAC;KAC3B;IACD,MAAM,CAAC,IAAY;QAClB,OAAO,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,UAAS,GAAG,IAAW;YAC7C,IAAI,CAAC,KAAK,CAAC,IAAI,EAAE,IAAI,CAAC,CAAC;SACvB,EAAE,IAAI,CAAC,CAAC;KACT;IACD,EAAE,CAAC,IAAY,EAAE,OAAO;QACvB,IAAI,CAAC,WAAW,CAAC,IAAI,EAAE,OAAO,CAAC,CAAC;KAChC;IAED,GAAG,CAAC,MAAM,EAAE,MAAM;QACjB,MAAM,CAAC,IAAI,EAAE,IAAI,EAAE,MAAM,CAAC,CAAC;KAC3B;IAED,KAAK,CAAC,IAAW,EAAE,EAAQ;QAC1B,IAAI,CAAC,SAAS,CAAC,IAAI,EAAE,EAAE,CAAC,CAAC;QACzB,IAAI,CAAC,SAAS,CAAC,WAAW,EAAE,EAAE,CAAC,CAAC;;QAGhC,IAAI,IAAI,CAAC,MAAM,CAAC,KAAK,EAAC;YACrB,KAAK,IAAI,CAAC,GAAC,CAAC,EAAE,CAAC,GAAC,EAAE,CAAC,MAAM,EAAE,CAAC,EAAE,EAAC;gBAC9B,OAAO,CAAC,KAAK,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC;gBACrB,IAAI,EAAE,CAAC,CAAC,CAAC,YAAY,KAAK,EAAC;oBAC1B,IAAI,IAAI,GAAG,EAAE,CAAC,CAAC,CAAC,CAAC,OAAO,CAAC;oBACzB,IAAI,IAAI,CAAC,OAAO,CAAC,qBAAqB,CAAC,KAAK,CAAC,EAAC;wBAC7C,IAAI,GAAG,IAAI,CAAC,OAAO,CAAC,iBAAiB,EAAC,EAAE,CAAC,CAAC;wBAC1C,QAAQ,CAAC,IAAI,CAAC,SAAS,GAAG,sFAAsF,IAAI,QAAQ,CAAC;qBAC7H;yBAAM;wBACN,IAAI,IAAI,wCAAwC,CAAC;wBACjD,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,EAAE,IAAI,EAAC,OAAO,EAAE,IAAI,EAAC,IAAI,EAAE,MAAM,EAAC,CAAC,CAAC,EAAE,CAAC,CAAC;qBAC3D;iBAED;aACD;YACD,SAAS;SACT;;KAED;;IAGD,MAAM,CACL,IAAsC,EACtC,GAAqB,EACrB,MAAW;QAEX,IAAI,CAAC,UAAU,GAAG,CAAC,OAAO,IAAI,KAAK,QAAQ;YAC1C,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,IAAI,CAAC;aACtB,IAAI,IAAI,QAAQ,CAAC,IAAI,CAAC,CAAC;QAEzB,MAAM,SAAS,GAAG,CAAC,IAAI,CAAC,OAAO,CAAC;QAChC,IAAI,IAAI,GAAU,IAAI,CAAC;QACvB,IAAI,SAAS,EAAC;YACb,IAAI,KAAK,IAAI,SAAS,IAAI,IAAI,CAAC,UAAU,EAAC;gBACzC,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC,QAAQ,CAAC,IAAI,EAAE,OAAO,EAAE,CAAC,IAAI,IAAI,CAAC,YAAY,CAAC,CAAC,CAAC,CAAC,CAAC;gBACpE,KAAK,GAAG,KAAK,CAAC;aACd;YAED,IAAI,OAAO,GAAG,KAAK,QAAQ,EAAC;gBAC3B,GAAG,GAAG,IAAI,KAAK,CAAC,GAAG,EAAE,CAAC,CAAC,CAAC;aACxB;YACD,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,YAAY,CAAC,GAAG,CAAC,CAAC;YAC1C,IAAI,CAAC,WAAW,CAAC,KAAK,CAAC,UAAU,GAAG,IAAI,CAAC;SACzC;aAAM;YACN,IAAI,OAAO,GAAG,KAAK,QAAQ,EAAC;gBAC3B,IAAI,GAAG,GAAG,CAAC;aACX;iBAAM;gBACN,IAAI,IAAI,CAAC,GAAG,EAAC;oBACZ,IAAI,GAAG,GAAG,CAAC,KAAK,EAAE,CAAC,KAAK,CAAC,IAAI,IAAI,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC;iBACnD;qBAAM;oBACN,IAAI,GAAG,GAAG,CAAC,QAAQ,EAAE,CAAC;iBACtB;aACD;SACD;QAED,MAAM,MAAM,GAAG,MAAM,GAAG,MAAM,CAAC,MAAM,GAAG,IAAI,CAAC,MAAM,CAAC,MAAM,IAAI,IAAI,CAAC;QACnE,MAAM,GAAG,GAAG,IAAI,CAAC,UAAU,EAAE,CAAC;QAC9B,MAAM,OAAO,GAAG,IAAI,CAAC,WAAW,CAAC;QACjC,MAAM,KAAK,GAAG,OAAO;aACnB,IAAI,CAAC,EAAE,GAAG,EAAE,IAAI,EAAE,MAAM,EAAE,EAAE,GAAG,CAAC;aAChC,IAAI,CAAC,MAAM,IAAI,CAAC,aAAa,CAAC,OAAO,CAAC,OAAO,EAAE,CAAC,CAAC;aACjD,IAAI,CAAC,IAAI,IAAI,IAAI,CAAC,MAAM,CAAC,IAAI,EAAE,OAAO,CAAC,CAAC;aACxC,IAAI,CAAC,IAAI;YACT,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,OAAO,CAAC,KAAK,CAAC,IAAI,EAAE,EAAE,MAAM,EAAC,IAAI,EAAE,CAAC,CAAC;YACtD,IAAI,CAAC,SAAS,CAAC,WAAW,EAAE,CAAC,IAAI,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC;YAC7C,OAAO,IAAI,CAAC;SACZ,CAAC,CAAC;QAEJ,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,MAAM,KAAK,CAAC,CAAC;QAC1C,OAAO,KAAK,CAAC;KACb;IAED,UAAU;QACT,IAAI,IAAI,CAAC,WAAW,EAAC;YACpB,MAAM,IAAI,GAAG,IAAI,CAAC,WAAW,CAAC,OAAO,EAAE,CAAC,IAAI,CAAC;YAC7C,IAAI,IAAI;gBACP,OAAO,IAAI,CAAC;SACb;QACD,OAAO,IAAI,OAAO,CAAC,IAAI,EAAE,EAAE,CAAC,CAAC;KAC7B;IAED,OAAO,CAAC,IAAW,EAAE,GAAU,IAAO,OAAO,IAAI,CAAC,EAAE;IAE5C,YAAY,CAAC,KAAa;QACjC,IAAI,CAAC,QAAQ,GAAG,KAAK,CAAC;QAEtB,MAAM,EAAE,GAAG,CAAC,CAAQ,KAAK,UAAU,CAAC;YAClC,IAAmB,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC;gBACnC,IAAI,EAAE,CAAC,YAAY,iBAAiB,CAAC;oBACpC,MAAM,CAAC,CAAC;aACT,CAAC,CAAC;SACH,EAAC,CAAC,CAAC,CAAC;QACL,IAAI,CAAC,OAAO,GAAG,KAAK,IAAI,CAAC,MAAM,CAAC,MAAM,EAAE,EAAE,EAAE,IAAI,CAAC,MAAM,EAAE,IAAI,CAAC,CAAC;;QAG/D,IAAI,IAAI,CAAC,UAAU,KAAK,QAAQ,CAAC,IAAI,IAAI,IAAI,CAAC,MAAM,CAAC,SAAS,KAAK,KAAK,EAAE;YACzE,MAAM,IAAI,GAAG,IAAI,CAAC,UAAyB,CAAC;YAC5C,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,MAAM,CAAC,IAAI,EAAE,eAAe,CAAC,CAAC;YAC9C,UAAU,CAAC;gBACV,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,SAAS,CAAC,IAAI,EAAE,eAAe,CAAC,CAAC;gBACjD,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,MAAM,CAAC,IAAI,EAAE,UAAU,CAAC,CAAC;aACzC,EAAE,EAAE,CAAC,CAAC;SACP;QAED,IAAI,CAAC,KAAK,EAAC;;YAEV,IAAI,SAAS,GAAG,IAAI,CAAC,OAAO,CAAC,GAAG,EAAE,CAAC;YACnC,IAAI,CAAC,SAAS,EAAC;gBACd,SAAS,GAAG,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC;gBAC9B,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,SAAS,EAAE,EAAE,MAAM,EAAE,IAAI,EAAE,CAAC,CAAC;aAC9C;YACD,KAAK,GAAG,IAAI,KAAK,CAAC,SAAS,EAAE,CAAC,CAAC,CAAC;SAChC;aAAM,IAAI,IAAI,CAAC,GAAG,EAAE;YACpB,MAAM,GAAG,GAAG,KAAK,CAAC,OAAO,EAAE,CAAC,IAAI,CAAC;YACjC,KAAK,CAAC,OAAO,EAAE,CAAC,IAAI,GAAG,IAAI,CAAC;YAC5B,IAAI,KAAK,CAAC,IAAI,EAAE,EAAC;gBAChB,KAAK,CAAC,OAAO,EAAE,CAAC;gBAChB,KAAK,GAAG,KAAK,CAAC,KAAK,EAAE,CAAC;aACtB;iBAAM;gBACN,KAAK,GAAG,IAAI,KAAK,CAAC,IAAI,CAAC,MAAM,CAAC,KAAK,EAAE,CAAC,CAAC,CAAC;aACxC;YACD,KAAK,CAAC,OAAO,EAAE,CAAC,IAAI,GAAG,GAAG,CAAC;SAC3B;QAED,OAAO,KAAK,CAAC;KACb;;IAGO,UAAU,CAAC,GAAW,EAAE,GAAU;QACzC,IAAI,CAAC,KAAK,CAAC,mBAAmB,EAAE,CAAC,GAAG,EAAE,GAAG,CAAC,CAAC,CAAC;QAC5C,OAAO,EAAE,QAAQ,EAAC,GAAG,EAAE,CAAC;KACxB;IAEO,UAAU,CAAC,GAAG,EAAE,MAAM,EAAE,MAAkB;QACjD,MAAM,GAAG,GAAG,GAAG,CAAC,QAAQ,KAAK,IAAI,GAAG,GAAG,CAAC,QAAQ,GAAG,IAAI,CAAC;QACxD,MAAM,IAAI,GAAW,GAAG,CAAC,IAAI,KAAK,GAAG,GAAG,IAAI,CAAC,KAAK,CAAC,GAAG,EAAE,GAAG,SAAS,CAAC,CAAC;QACtE,MAAM,CAAC,EAAE,GAAG,GAAG,CAAC,EAAE,IAAI,GAAG,GAAG,IAAI,CAAC,KAAK,CAAC,GAAG,EAAE,CAAC;QAE7C,MAAM,IAAI,GAAc,MAAM,CAAC,IAAI,CAAC,GAAG;YACtC,EAAE,EAAE,MAAM,CAAC,EAAE;YACb,GAAG;YACH,MAAM,EAAE,GAAG,CAAC,MAAM;YAClB,KAAK,EAAE,GAAG,CAAC,KAAK;YAChB,MAAM,EAAE,GAAG,CAAC,MAAM;SAClB,CAAC;QAEF,OAAO,IAAI,CAAC,KAAK,GAAG,IAAI,GAAG,MAAM,CAAC;KAClC;CACD;;MC/bY,UAAU;IAMtB,YAAY,EAAsB,EAAE,MAAU;QAC7C,IAAI,CAAC,MAAM,GAAG,MAAM,IAAI,EAAE,CAAC;QAC3B,IAAI,CAAC,aAAa,EAAE,CAAC;QACrB,IAAI,CAAC,EAAE,GAAG,EAAE,CAAC;QACb,MAAM,CAAC,UAAU,GAAG,MAAM,IAAI,CAAC,EAAE,CAAC,IAAI,CAAC,GAAG,EAAE,CAAC,CAAC;KAC9C;IAED,GAAG,CAAC,IAAW,EAAE,MAAyB;QACzC,IAAI,IAAI,CAAC,MAAM,CAAC,MAAM,EAAC;YACtB,MAAM,OAAO,GAAG,IAAI,CAAC,KAAK,CAAC,GAAG,EAAC,CAAC,CAAC,CAAC;YAClC,KAAK,MAAM,GAAG,IAAI,IAAI,CAAC,MAAM,CAAC,MAAM,EAAC;gBACpC,IAAI,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC,GAAG,CAAC,KAAK,OAAO,CAAC,CAAC,CAAC,EAAC;oBAC1C,IAAI,GAAG,GAAG,IAAE,OAAO,CAAC,MAAM,GAAG,CAAC,GAAG,GAAG,GAAC,OAAO,CAAC,CAAC,CAAC,GAAG,EAAE,CAAC,CAAC;oBACtD,MAAM;iBACN;aACD;SACD;QAED,IAAI,IAAI,CAAC,GAAG,EAAE,KAAK,IAAI,EAAC;YACvB,MAAM,CAAC,OAAO,CAAC,SAAS,CAAC,IAAI,EAAE,IAAI,EAAE,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,CAAC;SACtE;QACD,IAAI,CAAC,MAAM,IAAI,CAAC,MAAM,CAAC,MAAM,EAAC;YAC7B,UAAU,CAAC,MAAM,IAAI,CAAC,EAAE,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC,CAAC;SACnC;KACD;IACD,GAAG;QACF,IAAI,IAAI,GAAG,IAAI,CAAC,OAAO,EAAE,CAAC,OAAO,CAAC,IAAI,CAAC,MAAM,EAAE,EAAE,CAAC,CAAC,OAAO,CAAC,IAAI,CAAC,KAAK,EAAE,EAAE,CAAC,CAAC;QAC3E,IAAI,GAAG,CAAC,IAAI,KAAK,GAAG,IAAI,IAAI,KAAK,GAAG,IAAI,IAAI,GAAG,EAAE,CAAC;QAElD,IAAI,IAAI,CAAC,MAAM,CAAC,MAAM,EAAC;YACtB,MAAM,OAAO,GAAG,IAAI,CAAC,KAAK,CAAC,GAAG,EAAC,CAAC,CAAC,CAAC;YAClC,MAAM,GAAG,GAAG,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,CAAC;YAC3C,IAAI,GAAG,EAAC;gBACP,IAAI,GAAG,GAAG,IAAE,OAAO,CAAC,MAAM,GAAG,CAAC,GAAG,GAAG,GAAC,OAAO,CAAC,CAAC,CAAC,GAAG,EAAE,CAAC,CAAC;aACtD;SACD;QACD,OAAO,IAAI,CAAC;KACZ;IACS,aAAa;;QAEtB,MAAM,KAAK,GAAG,IAAI,CAAC,MAAM,CAAC,YAAY,CAAC;QACvC,IAAI,CAAC,KAAK,GAAG,GAAG,IAAI,CAAC,OAAO,KAAK,KAAK,WAAW,IAAI,GAAG,GAAG,KAAK,CAAC,CAAC;QAElE,IAAI,CAAC,MAAM,GAAG,QAAQ,CAAC,QAAQ,CAAC,IAAI,CAAC,KAAK,CAAC,GAAG,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;KACtD;IAES,OAAO;QAChB,OAAO,QAAQ,CAAC,QAAQ,CAAC,IAAI,CAAC;KAC9B;CACD;;ACzDD,IAAI,SAAS,GAAG,KAAK,CAAC;AACtB,SAAwB,KAAK,CAAC,CAAM;IACnC,IAAI,SAAS,IAAI,CAAC,CAAC,EAAC;QAAE,OAAO;KAAE;IAC/B,SAAS,GAAG,IAAI,CAAC;;IAGjB,MAAM,GAAG,GAAG,MAAa,CAAC;IAC1B,IAAI,CAAC,GAAG,CAAC,OAAO,EAAC;QAChB,GAAG,CAAC,OAAO,GAAG,CAAC,CAAC,OAAO,CAAC;KACxB;IAED,MAAM,OAAO,GAAG,CAAC,CAAC,OAAO,CAAC,KAAK,CAAC,GAAG,CAAU,CAAC;;IAG9C,IAAI,OAAO,CAAC,CAAC,CAAC,GAAC,EAAE,GAAC,OAAO,CAAC,CAAC,CAAC,GAAC,CAAC,GAAG,EAAE,EAAE;QACpC,CAAC,CAAC,EAAE,CAAC,MAAM,GAAG,UAAS,OAAO;;;YAG7B,MAAM,GAAG,GAAG,OAAO,EAAE,CAAC;YACtB,IAAI,GAAG,IAAI,GAAG,CAAC,IAAI,EAAC;gBACnB,GAAG,CAAC,IAAI,CAAC,UAAS,IAAI;oBACrB,CAAC,CAAC,EAAE,CAAC,OAAO,GAAG,KAAK,CAAC;oBACrB,CAAC,CAAC,EAAE,CAAC,MAAM,EAAE,CAAC;oBACd,OAAO,IAAI,CAAC;iBACZ,CAAC,CAAC;aACH;iBAAM;gBACN,CAAC,CAAC,EAAE,CAAC,OAAO,GAAG,KAAK,CAAC;gBACrB,CAAC,CAAC,EAAE,CAAC,MAAM,EAAE,CAAC;aACd;YACD,OAAO,GAAG,CAAC;SACX,CAAC;KACF;;IAGD,MAAM,OAAO,GAAG,CAAC,CAAC,EAAE,CAAC,UAAU,CAAC,SAAS,CAAC,OAAc,CAAC;IACzD,MAAM,UAAU,GAAG,CAAC,CAAC,EAAE,CAAC,UAAU,CAAC,SAAS,CAAC,UAAiB,CAAC;IAE/D,MAAM,MAAM,GAAG;QACd,OAAO,CAAC,IAAI,EAAE,KAAK;;;YAGlB,IAAI,IAAI,CAAC,MAAM,IAAI,IAAI,CAAC,MAAM,CAAC,QAAQ,IAAI,CAAC,IAAI,CAAC,SAAS,EAAC;gBAC1D,MAAM,KAAK,GAAG,IAAI,CAAC,MAAM,CAAC;gBAC1B,MAAM,IAAI,GAAG,EAAE,CAAC;gBAEhB,IAAI,GAAG,KAAK,CAAC,GAAG,CAAC,UAAU,CAAC,IAAI,EAAE,EAAE,EAAE,IAAI,CAAC,CAAC;gBAC5C,OAAO,CAAC,KAAK,CAAC,IAAI,EAAE,CAAC,IAAI,EAAE,KAAK,CAAC,CAAC,CAAC;gBAEnC,KAAK,MAAM,GAAG,IAAI,IAAI,EAAC;oBACtB,KAAK,CAAC,YAAY,CAAC,GAAG,EAAE,IAAI,CAAC,GAAG,CAAC,EAAE,IAAI,CAAC,CAAC,IAAI,CAAC;wBAC7C,KAAK,CAAC,KAAK,CAAC,GAAG,CAAC,GAAG,IAAI,CAAC,GAAG,CAAC,CAAC;qBAC7B,CAAC,CAAC;iBACH;gBAED,OAAO,IAAI,CAAC,EAAE,CAAC;aACf;iBAAM;gBACN,OAAO,OAAO,CAAC,KAAK,CAAC,IAAI,EAAE,SAAS,CAAC,CAAC;aACtC;SACD;QACD,UAAU;YACT,UAAU,CAAC,KAAK,CAAC,IAAI,EAAE,SAAS,CAAC,CAAC;YAClC,IAAI,IAAI,CAAC,MAAM,IAAI,IAAI,CAAC,MAAM,CAAC,QAAQ,EAAC;gBACvC,MAAM,IAAI,GAAG,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC;;gBAE/B,KAAI,MAAM,GAAG,IAAI,IAAI,EAAC;oBACrB,MAAM,IAAI,GAAG,IAAI,CAAC,GAAG,CAAC,CAAC;oBACvB,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC,IAAI,CAAC,EAAE,CAAC,EAAC;wBAClB,IAAI,CAAC,IAAI,CAAC,UAAU,EAAE,CAAC;wBACvB,OAAO,IAAI,CAAC,GAAG,CAAC,CAAC;qBACjB;iBACD;aACD;SACD;KACD,CAAC;IAEF,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC,EAAE,CAAC,MAAM,CAAC,SAAS,EAAE,MAAM,EAAE,IAAI,CAAC,CAAC;IAC9C,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC,EAAE,CAAC,UAAU,CAAC,SAAS,EAAE,MAAM,EAAE,IAAI,CAAC,CAAC;;IAIlD,CAAC,CAAC,OAAO,CAAC;QACT,IAAI,EAAC,QAAQ;QACb,KAAK,CAAC,GAAG;YACR,IAAI,CAAC,IAAI,GAAG,IAAI,IAAI,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC;YAE9B,MAAM,EAAE,GAAG,CAAC,CAAC,GAAG,EAAE,CAAC,QAAQ,EAAE,CAAC;YAC9B,GAAG,CAAC,IAAI,GAAG,EAAE,EAAE,EAAE,CAAC;YAElB,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC;gBAChB,IAAI,CAAC,SAAS,CAAC,QAAQ,EAAE,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;gBACtC,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,EAAE,EAAE,EAAE,CAAC,CAAC;aACzB,CAAC,CAAC;SACH;KACD,EAAG,CAAC,CAAC,EAAU,CAAC,KAAK,EAAE,CAAC,CAAC,WAAW,CAAC,CAAC;CACvC;;MClFY,MAAO,SAAQ,UAAU;IACrC,YAAY,MAAW;QACtB,MAAM,CAAC,MAAM,GAAG,MAAM,CAAC,MAAM,IAAI,UAAU,CAAC;QAC5C,KAAK,CAAC,MAAM,CAAC,CAAC;QACd,KAAK,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;KAClB;IACD,OAAO,CAAC,IAAW,EAAE,GAAU;QAC9B,OAAO,OAAO,CAAC,IAAI,GAAC,GAAG,GAAC,GAAG,CAAC,CAAC;KAC7B;CACD;;MCnBY,WAAW;IAKvB,YAAY,EAAsB,EAAE,MAAU,EAAE,GAAY;QAC3D,IAAI,CAAC,OAAO,GAAG,MAAM,CAAC,OAAO,IAAI,GAAG,CAAC,KAAK,CAAC,OAAO,CAAC,OAAO,CAAC;QAC3D,IAAI,CAAC,IAAI,IAAI,MAAM,CAAC,SAAS,IAAI,MAAM,CAAC,EAAE,GAAC,QAAQ,CAAC,CAAC;QACrD,IAAI,CAAC,EAAE,GAAG,EAAE,CAAC;KACb;IACD,GAAG,CAAC,IAAW,EAAE,MAAyB;QACzC,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,IAAI,CAAC,IAAI,EAAE,IAAI,CAAC,CAAC;QAClC,IAAI,CAAC,MAAM,IAAI,CAAC,MAAM,CAAC,MAAM,EAAC;YAC7B,UAAU,CAAC,MAAM,IAAI,CAAC,EAAE,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC,CAAC;SACnC;KACD;IACD,GAAG;QACF,OAAO,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;KACnC;CACD;;MClBY,SAAU,SAAQ,UAAU;IAC9B,aAAa;QACtB,IAAI,CAAC,MAAM,GAAG,EAAE,CAAC;QACjB,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,MAAM,CAAC,YAAY,IAAI,EAAE,CAAC;KAC5C;IACS,OAAO;QAChB,OAAO,QAAQ,CAAC,QAAQ,CAAC,QAAQ,IAAI,QAAQ,CAAC,QAAQ,CAAC,MAAM,IAAE,EAAE,CAAC,CAAC;KACnE;CACD;;MCTY,WAAW;IAIvB,YAAY,EAAsB,EAAE,QAAY;QAC/C,IAAI,CAAC,IAAI,GAAG,EAAE,CAAC;QACf,IAAI,CAAC,EAAE,GAAG,EAAE,CAAC;KACb;IACD,GAAG,CAAC,IAAW,EAAE,MAAyB;QACzC,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC;QACjB,IAAI,CAAC,MAAM,IAAI,CAAC,MAAM,CAAC,MAAM,EAAC;YAC7B,UAAU,CAAC,MAAM,IAAI,CAAC,EAAE,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC,CAAC;SACnC;KACD;IACD,GAAG;QACF,OAAO,IAAI,CAAC,IAAI,CAAC;KACjB;CACD;;SChBe,WAAW,CAAC,GAAY,EAAE,IAAc,EAAE,MAAW;IACpE,IAAI,CAAC,EAAE,CAAC,GAAG,EAAE,WAAW,EAAE,UAAS,KAAa,EAAE,KAAc,EAAE,OAAW;QAC5E,IAAI,KAAK,KAAK,IAAI,IAAI,KAAK,CAAC,QAAQ,CAAC,IAAI,CAAC,EAAC;YAC1C,MAAM,GAAG,GAAG,MAAM,EAAE,CAAC;YACrB,IAAI,GAAG,KAAK,KAAK,EAAC;gBACjB,OAAO,CAAC,OAAO,GAAG,OAAO,CAAC,MAAM,CAAC,IAAI,iBAAiB,EAAE,CAAC,CAAC;aAC1D;iBAAM;gBACN,OAAO,CAAC,OAAO,GAAG,OAAO,CAAC,OAAO,CAAC,IAAI,CAAC,MAAM,GAAG,CAAC,CAAC;aAClD;SACD;KACD,CAAC,CAAC;CACH;;ACdD;;;AAoBA,SAAS,GAAG,CAAC,KAAK,EAAE,GAAG,EAAE;EACvB,OAAO,MAAM,CAAC,SAAS,CAAC,cAAc,CAAC,IAAI,CAAC,KAAK,EAAE,GAAG,CAAC,CAAC;CACzD;;AAED,SAAS,OAAO,CAAC,GAAG,EAAE,OAAO,EAAE,OAAO,EAAE;EACtC,KAAK,IAAI,GAAG,IAAI,GAAG,EAAE;IACnB,IAAI,GAAG,CAAC,GAAG,EAAE,GAAG,CAAC,EAAE;MACjB,OAAO,CAAC,IAAI,EAAE,OAAO,IAAI,GAAG,GAAG,GAAG,CAAC,GAAG,CAAC,EAAE,GAAG,EAAE,GAAG,CAAC,CAAC;KACpD;GACF;CACF;;AAED,SAAS,IAAI,CAAC,GAAG,EAAE;EACjB,OAAO,GAAG,CAAC,OAAO,CAAC,oCAAoC,EAAE,EAAE,CAAC,CAAC;CAC9D;;AAED,SAAS,IAAI,CAAC,OAAO,EAAE;EACrB,OAAO,GAAG,WAAW,GAAG,OAAO,CAAC;EAChC,IAAI,OAAO,OAAO,KAAK,WAAW,EAAE;IAClC,OAAO,CAAC,KAAK,CAAC,OAAO,CAAC,CAAC;GACxB;;EAED,IAAI,EAAE,MAAM,IAAI,KAAK,CAAC,OAAO,CAAC,CAAC,EAAE,CAAC,OAAO,CAAC,EAAE,EAAE;CAC/C;;AAED,IAAI,OAAO,GAAG,MAAM,CAAC,SAAS,CAAC,OAAO,CAAC;AACvC,IAAI,KAAK,GAAG,MAAM,CAAC,SAAS,CAAC,KAAK,CAAC;;;;AAInC,IAAI,SAAS,GAAG,MAAM,CAAC;;AAEvB,IAAI,mBAAmB,GAAG,UAAU,CAAC,EAAE;EACrC,IAAI,GAAG,GAAG,CAAC,GAAG,EAAE,CAAC;EACjB,IAAI,CAAC,KAAK,EAAE,IAAI,GAAG,KAAK,CAAC,EAAE;IACzB,OAAO,CAAC,CAAC;GACV;EACD,IAAI,CAAC,IAAI,GAAG,IAAI,GAAG,IAAI,CAAC,IAAI,EAAE,CAAC,IAAI,EAAE,IAAI,CAAC,IAAI,EAAE,CAAC,EAAE;IACjD,OAAO,CAAC,CAAC;GACV;EACD,OAAO,CAAC,CAAC;CACV,CAAC;;;AAGF,IAAI,WAAW,GAAG;EAChB,MAAM,EAAE,UAAU,CAAC,EAAE;;IAEnB,IAAI,CAAC,GAAG,CAAC,EAAE,EAAE,OAAO,CAAC,CAAC,EAAE;IACxB,IAAI,OAAO,GAAG,CAAC,GAAG,GAAG,CAAC;IACtB,IAAI,OAAO,IAAI,CAAC,IAAI,OAAO,IAAI,EAAE,EAAE,OAAO,CAAC,CAAC;IAC5C,OAAO,OAAO,IAAI,EAAE,GAAG,CAAC,GAAG,CAAC,CAAC;GAC9B;EACD,eAAe,EAAE,mBAAmB;EACpC,OAAO,EAAE,YAAY,EAAE,OAAO,CAAC,CAAC,EAAE;EAClC,QAAQ,EAAE,mBAAmB;EAC7B,MAAM,EAAE,UAAU,CAAC,EAAE,EAAE,OAAO,CAAC,GAAG,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,EAAE;EAC9C,MAAM,EAAE,UAAU,CAAC,EAAE,EAAE,OAAO,CAAC,KAAK,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,EAAE;EAChD,OAAO,EAAE,mBAAmB;EAC5B,UAAU,EAAE,UAAU,CAAC,EAAE;IACvB,IAAI,CAAC,GAAG,EAAE,KAAK,CAAC,IAAI,CAAC,GAAG,GAAG,KAAK,EAAE,EAAE,EAAE,OAAO,CAAC,CAAC,EAAE;IACjD,OAAO,CAAC,GAAG,EAAE,IAAI,CAAC,IAAI,CAAC,GAAG,EAAE,IAAI,CAAC,KAAK,CAAC,GAAG,GAAG,GAAG,EAAE,IAAI,CAAC,GAAG,GAAG,GAAG,EAAE,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC;GAC7E;EACD,KAAK,EAAE,UAAU,CAAC,EAAE;IAClB,IAAI,CAAC,KAAK,CAAC,EAAE,EAAE,OAAO,CAAC,CAAC,EAAE;IAC1B,OAAO,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;GACnC;EACD,MAAM,EAAE,UAAU,CAAC,EAAE;IACnB,IAAI,CAAC,KAAK,CAAC,EAAE,EAAE,OAAO,CAAC,CAAC,EAAE;IAC1B,IAAI,GAAG,GAAG,CAAC,GAAG,EAAE,CAAC;IACjB,OAAO,CAAC,IAAI,GAAG,IAAI,GAAG,IAAI,CAAC,KAAK,CAAC,GAAG,GAAG,GAAG,EAAE,IAAI,CAAC,GAAG,GAAG,IAAI,EAAE,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC;GACxE;EACD,SAAS,EAAE,UAAU,CAAC,EAAE,EAAE,OAAO,CAAC,CAAC,GAAG,EAAE,KAAK,CAAC,IAAI,CAAC,GAAG,GAAG,KAAK,EAAE,IAAI,CAAC,GAAG,CAAC,CAAC,EAAE;EAC5E,SAAS,EAAE,UAAU,CAAC,EAAE;IACtB,IAAI,OAAO,GAAG,CAAC,GAAG,GAAG,CAAC;IACtB,IAAI,OAAO,KAAK,CAAC,EAAE;MACjB,OAAO,CAAC,CAAC;KACV;IACD,IAAI,OAAO,KAAK,CAAC,EAAE;MACjB,OAAO,CAAC,CAAC;KACV;IACD,IAAI,OAAO,KAAK,CAAC,IAAI,OAAO,KAAK,CAAC,EAAE;MAClC,OAAO,CAAC,CAAC;KACV;IACD,OAAO,CAAC,CAAC;GACV;CACF,CAAC;;;;;;AAMF,IAAI,qBAAqB,GAAG;EAC1B,MAAM,EAAE,CAAC,IAAI,CAAC;EACd,eAAe,EAAE,CAAC,YAAY,EAAE,YAAY,EAAE,QAAQ,EAAE,OAAO,CAAC;EAChE,OAAO,EAAE,CAAC,IAAI,EAAE,OAAO,EAAE,IAAI,EAAE,IAAI,EAAE,OAAO,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,OAAO,EAAE,IAAI,CAAC;EAC9E,QAAQ,EAAE,CAAC,IAAI,EAAE,OAAO,CAAC;EACzB,MAAM,EAAE,CAAC,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,OAAO,EAAE,IAAI,EAAE,OAAO,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,CAAC;EACpH,MAAM,EAAE,CAAC,IAAI,EAAE,IAAI,EAAE,OAAO,CAAC;EAC7B,OAAO,EAAE,CAAC,IAAI,EAAE,OAAO,CAAC;EACxB,UAAU,EAAE,CAAC,IAAI,CAAC;EAClB,KAAK,EAAE,CAAC,IAAI,EAAE,OAAO,EAAE,IAAI,CAAC;EAC5B,MAAM,EAAE,CAAC,IAAI,CAAC;EACd,SAAS,EAAE,CAAC,IAAI,CAAC;EACjB,SAAS,EAAE,CAAC,OAAO,CAAC;CACrB,CAAC;;AAEF,SAAS,aAAa,CAAC,OAAO,EAAE;EAC9B,IAAI,GAAG,GAAG,EAAE,CAAC;EACb,OAAO,CAAC,OAAO,EAAE,UAAU,KAAK,EAAE,IAAI,EAAE;IACtC,OAAO,CAAC,KAAK,EAAE,UAAU,IAAI,EAAE;MAC7B,GAAG,CAAC,IAAI,CAAC,GAAG,IAAI,CAAC;KAClB,CAAC,CAAC;GACJ,CAAC,CAAC;EACH,OAAO,GAAG,CAAC;CACZ;;AAED,SAAS,cAAc,CAAC,MAAM,EAAE;EAC9B,IAAI,gBAAgB,GAAG,aAAa,CAAC,qBAAqB,CAAC,CAAC;EAC5D,OAAO,gBAAgB,CAAC,MAAM,CAAC;OAC1B,gBAAgB,CAAC,KAAK,CAAC,IAAI,CAAC,MAAM,EAAE,GAAG,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;OAC/C,gBAAgB,CAAC,EAAE,CAAC;CAC1B;;AAED,SAAS,eAAe,CAAC,MAAM,EAAE,KAAK,EAAE;EACtC,OAAO,WAAW,CAAC,cAAc,CAAC,MAAM,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC;CACnD;;AAED,SAAS,MAAM,CAAC,KAAK,EAAE;EACrB,OAAO,KAAK,CAAC,OAAO,CAAC,qBAAqB,EAAE,MAAM,CAAC,CAAC;CACrD;;AAED,SAAS,mBAAmB,CAAC,IAAI,EAAE;EACjC,IAAI,MAAM,GAAG,CAAC,IAAI,IAAI,IAAI,CAAC,MAAM,KAAK,IAAI,CAAC;EAC3C,IAAI,MAAM,GAAG,CAAC,IAAI,IAAI,IAAI,CAAC,MAAM,KAAK,GAAG,CAAC;;EAE1C,IAAI,MAAM,KAAK,SAAS,IAAI,MAAM,KAAK,SAAS,EAAE;IAChD,MAAM,IAAI,UAAU,CAAC,GAAG,GAAG,SAAS,GAAG,uCAAuC,CAAC,CAAC;GACjF;;EAED,OAAO,IAAI,MAAM,CAAC,MAAM,CAAC,MAAM,CAAC,GAAG,OAAO,GAAG,MAAM,CAAC,MAAM,CAAC,EAAE,GAAG,CAAC,CAAC;CACnE;;AAED,IAAI,WAAW,GAAG,KAAK,CAAC;AACxB,IAAI,eAAe,GAAG,IAAI,CAAC;AAC3B,IAAI,iBAAiB,GAAG,aAAa,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;AAyBtC,SAAS,eAAe,CAAC,MAAM,EAAE,aAAa,EAAE,MAAM,EAAE,UAAU,EAAE;EAClE,IAAI,OAAO,MAAM,KAAK,QAAQ,EAAE;IAC9B,MAAM,IAAI,SAAS,CAAC,2DAA2D,CAAC,CAAC;GAClF;;EAED,IAAI,aAAa,IAAI,IAAI,EAAE;IACzB,OAAO,MAAM,CAAC;GACf;;EAED,IAAI,MAAM,GAAG,MAAM,CAAC;EACpB,IAAI,kBAAkB,GAAG,UAAU,IAAI,iBAAiB,CAAC;;;EAGzD,IAAI,OAAO,GAAG,OAAO,aAAa,KAAK,QAAQ,GAAG,EAAE,WAAW,EAAE,aAAa,EAAE,GAAG,aAAa,CAAC;;;;;EAKjG,IAAI,OAAO,CAAC,WAAW,IAAI,IAAI,IAAI,MAAM,EAAE;IACzC,IAAI,KAAK,GAAG,KAAK,CAAC,IAAI,CAAC,MAAM,EAAE,SAAS,CAAC,CAAC;IAC1C,MAAM,GAAG,IAAI,CAAC,KAAK,CAAC,eAAe,CAAC,MAAM,IAAI,IAAI,EAAE,OAAO,CAAC,WAAW,CAAC,CAAC,IAAI,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC;GACxF;;;EAGD,MAAM,GAAG,OAAO,CAAC,IAAI,CAAC,MAAM,EAAE,kBAAkB,EAAE,UAAU,UAAU,EAAE,QAAQ,EAAE;IAChF,IAAI,CAAC,GAAG,CAAC,OAAO,EAAE,QAAQ,CAAC,IAAI,OAAO,CAAC,QAAQ,CAAC,IAAI,IAAI,EAAE,EAAE,OAAO,UAAU,CAAC,EAAE;;IAEhF,OAAO,OAAO,CAAC,IAAI,CAAC,OAAO,CAAC,QAAQ,CAAC,EAAE,WAAW,EAAE,eAAe,CAAC,CAAC;GACtE,CAAC,CAAC;;EAEH,OAAO,MAAM,CAAC;CACf;;;AAGD,SAAS,QAAQ,CAAC,OAAO,EAAE;EACzB,IAAI,IAAI,GAAG,OAAO,IAAI,EAAE,CAAC;EACzB,IAAI,CAAC,OAAO,GAAG,EAAE,CAAC;EAClB,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,OAAO,IAAI,EAAE,CAAC,CAAC;EAChC,IAAI,CAAC,aAAa,GAAG,IAAI,CAAC,MAAM,IAAI,IAAI,CAAC;EACzC,IAAI,YAAY,GAAG,IAAI,CAAC,YAAY,GAAG,eAAe,GAAG,IAAI,CAAC;EAC9D,IAAI,CAAC,YAAY,GAAG,OAAO,IAAI,CAAC,YAAY,KAAK,UAAU,GAAG,IAAI,CAAC,YAAY,GAAG,YAAY,CAAC;EAC/F,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC,IAAI,IAAI,IAAI,CAAC;EAC9B,IAAI,CAAC,UAAU,GAAG,mBAAmB,CAAC,IAAI,CAAC,aAAa,CAAC,CAAC;CAC3D;;;;;AAKD,QAAQ,CAAC,SAAS,CAAC,MAAM,GAAG,UAAU,SAAS,EAAE;EAC/C,IAAI,SAAS,EAAE,IAAI,CAAC,aAAa,GAAG,SAAS,CAAC;EAC9C,OAAO,IAAI,CAAC,aAAa,CAAC;CAC3B,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAmDF,QAAQ,CAAC,SAAS,CAAC,MAAM,GAAG,UAAU,WAAW,EAAE,MAAM,EAAE;EACzD,OAAO,CAAC,WAAW,EAAE,UAAU,MAAM,EAAE,GAAG,EAAE;IAC1C,IAAI,WAAW,GAAG,MAAM,GAAG,MAAM,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,CAAC;IACpD,IAAI,OAAO,MAAM,KAAK,QAAQ,EAAE;MAC9B,IAAI,CAAC,MAAM,CAAC,MAAM,EAAE,WAAW,CAAC,CAAC;KAClC,MAAM;MACL,IAAI,CAAC,OAAO,CAAC,WAAW,CAAC,GAAG,MAAM,CAAC;KACpC;GACF,EAAE,IAAI,CAAC,CAAC;CACV,CAAC;;;;;;;;;;;;;AAaF,QAAQ,CAAC,SAAS,CAAC,KAAK,GAAG,UAAU,WAAW,EAAE,MAAM,EAAE;EACxD,IAAI,OAAO,WAAW,KAAK,QAAQ,EAAE;IACnC,OAAO,IAAI,CAAC,OAAO,CAAC,WAAW,CAAC,CAAC;GAClC,MAAM;IACL,OAAO,CAAC,WAAW,EAAE,UAAU,MAAM,EAAE,GAAG,EAAE;MAC1C,IAAI,WAAW,GAAG,MAAM,GAAG,MAAM,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,CAAC;MACpD,IAAI,OAAO,MAAM,KAAK,QAAQ,EAAE;QAC9B,IAAI,CAAC,KAAK,CAAC,MAAM,EAAE,WAAW,CAAC,CAAC;OACjC,MAAM;QACL,OAAO,IAAI,CAAC,OAAO,CAAC,WAAW,CAAC,CAAC;OAClC;KACF,EAAE,IAAI,CAAC,CAAC;GACV;CACF,CAAC;;;;;;;AAOF,QAAQ,CAAC,SAAS,CAAC,KAAK,GAAG,YAAY;EACrC,IAAI,CAAC,OAAO,GAAG,EAAE,CAAC;CACnB,CAAC;;;;;;;AAOF,QAAQ,CAAC,SAAS,CAAC,OAAO,GAAG,UAAU,UAAU,EAAE;EACjD,IAAI,CAAC,KAAK,EAAE,CAAC;EACb,IAAI,CAAC,MAAM,CAAC,UAAU,CAAC,CAAC;CACzB,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA4BF,QAAQ,CAAC,SAAS,CAAC,CAAC,GAAG,UAAU,GAAG,EAAE,OAAO,EAAE;EAC7C,IAAI,MAAM,EAAE,MAAM,CAAC;EACnB,IAAI,IAAI,GAAG,OAAO,IAAI,IAAI,GAAG,EAAE,GAAG,OAAO,CAAC;EAC1C,IAAI,OAAO,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,KAAK,QAAQ,EAAE;IACzC,MAAM,GAAG,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC;GAC5B,MAAM,IAAI,OAAO,IAAI,CAAC,CAAC,KAAK,QAAQ,EAAE;IACrC,MAAM,GAAG,IAAI,CAAC,CAAC,CAAC;GACjB,MAAM,IAAI,IAAI,CAAC,YAAY,EAAE;IAC5B,IAAI,YAAY,GAAG,IAAI,CAAC,YAAY,CAAC;IACrC,MAAM,GAAG,YAAY,CAAC,GAAG,EAAE,IAAI,EAAE,IAAI,CAAC,aAAa,EAAE,IAAI,CAAC,UAAU,CAAC,CAAC;GACvE,MAAM;IACL,IAAI,CAAC,IAAI,CAAC,gCAAgC,GAAG,GAAG,GAAG,GAAG,CAAC,CAAC;IACxD,MAAM,GAAG,GAAG,CAAC;GACd;EACD,IAAI,OAAO,MAAM,KAAK,QAAQ,EAAE;IAC9B,MAAM,GAAG,eAAe,CAAC,MAAM,EAAE,IAAI,EAAE,IAAI,CAAC,aAAa,EAAE,IAAI,CAAC,UAAU,CAAC,CAAC;GAC7E;EACD,OAAO,MAAM,CAAC;CACf,CAAC;;;;;;AAMF,QAAQ,CAAC,SAAS,CAAC,GAAG,GAAG,UAAU,GAAG,EAAE;EACtC,OAAO,GAAG,CAAC,IAAI,CAAC,OAAO,EAAE,GAAG,CAAC,CAAC;CAC/B,CAAC;;;AAGF,QAAQ,CAAC,eAAe,GAAG,SAAS,SAAS,CAAC,MAAM,EAAE,aAAa,EAAE,MAAM,EAAE;EAC3E,OAAO,eAAe,CAAC,MAAM,EAAE,aAAa,EAAE,MAAM,CAAC,CAAC;CACvD,CAAC;;AAEF,iBAAc,GAAG,QAAQ,CAAC;;SCnZV,MAAM,CAAC,GAAY,EAAE,KAAe,EAAE,MAAW;IAChE,MAAM,GAAG,MAAM,IAAI,EAAE,CAAC;IACtB,MAAM,OAAO,GAAG,MAAM,CAAC,OAAO,CAAC;IAC/B,IAAI,IAAI,GAAG,OAAO,IAAI,OAAO,CAAC,GAAG,CAAC,MAAM,CAAC,IAAI,IAAI,KAAK,MAAM,CAAC,IAAI,IAAI,IAAI,CAAC,CAAC;IAE3E,SAAS,WAAW,CAAC,IAAI,EAAE,IAAS,EAAE,MAAgB;QACrD,IAAI,IAAI,CAAC,UAAU,EAAE;YACpB,IAAI,GAAG,IAAI,CAAC,OAAO,CAAC;SACpB;QAED,MAAM,OAAO,GAAG,EAAE,OAAO,EAAC,IAAI,EAAE,CAAC;QACjC,IAAI,MAAM,CAAC,QAAQ,EAAC;YACnB,GAAG,CAAC,KAAK,CAAC,MAAM,CAAC,OAAO,EAAE,MAAM,CAAC,QAAQ,CAAC,CAAC;SAC3C;QAED,MAAM,IAAI,GAAG,OAAO,CAAC,QAAQ,GAAG,IAAIA,aAAQ,CAAC,OAAO,CAAC,CAAC;QACtD,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC;QAElB,OAAO,CAAC,CAAC,GAAG,GAAG,CAAC,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,EAAE,IAAI,CAAC,CAAC;QACzC,IAAI,GAAG,IAAI,CAAC;QAEZ,IAAI,OAAO,EAAC;YACX,OAAO,CAAC,GAAG,CAAC,MAAM,EAAE,IAAI,CAAC,CAAC;SAC1B;QAED,IAAI,MAAM,CAAC,KAAK,EAAC;YAChB,MAAM,OAAO,GAAG,MAAM,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;YACnC,IAAI,OAAO,EAAC;gBACX,GAAG,CAAC,KAAK,CAAC,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,CAAC;aAClC;SACD;QAED,IAAI,CAAC,MAAM,EAAC;YACX,OAAO,GAAG,CAAC,OAAO,EAAE,CAAC;SACrB;QAED,OAAO,OAAO,CAAC,OAAO,EAAE,CAAC;KACzB;IACD,SAAS,OAAO,KAAI,OAAO,IAAI,CAAC,EAAE;IAClC,SAAS,OAAO,CAAC,IAAW,EAAE,MAAiB;;QAE9C,IAAI,MAAM,CAAC,IAAI,KAAK,KAAK,EAAC;YACzB,OAAO;SACP;QAED,MAAM,IAAI,GAAG,CAAC,MAAM,CAAC,IAAI,GAAG,MAAM,CAAC,IAAI,GAAG,GAAG,GAAG,EAAE,IAAI,IAAI,CAAC;QAC3D,MAAM,IAAI,GAAG,GAAG,CAAC,OAAO,CAAC,aAAa,EAAC,IAAI,CAAC,CAAC;QAE7C,WAAW,CAAC,IAAI,EAAE,IAAI,EAAE,MAAM,CAAC,CAAC;KAChC;IAED,MAAM,OAAO,GAAG;QACf,OAAO,EAAE,OAAO,EAAE,WAAW,EAAE,CAAC,EAAC,IAAI,EAAE,QAAQ,EAAC,IAAI;KACpD,CAAC;IAEF,GAAG,CAAC,UAAU,CAAC,QAAQ,EAAE,OAAO,CAAC,CAAC;IAClC,OAAO,CAAC,IAAI,EAAE,IAAI,CAAC,CAAC;CACpB;;AC1DD,SAAS,IAAI,CAAC,IAAI,EAAE,MAAM,EAAE,KAAK;IAChC,IAAI,MAAM,CAAC,IAAI,EAAC;QACf,KAAK,GAAG,MAAM,CAAC,IAAI,CAAC,KAAK,CAAC,IAAI,KAAK,CAAC;KACpC;SAAM,IAAI,MAAM,CAAC,KAAK,EAAC;QACvB,KAAK,GAAG,EAAE,CAAC,MAAM,CAAC,KAAK,GAAE,KAAK,EAAE,CAAC;KACjC;IAED,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;CACjB;AACD,SAAgB,IAAI,CAAC,GAAY,EAAE,IAAc,EAAE,MAAW;IAC7D,MAAM,KAAK,GAAG,IAAI,CAAC,cAAc,EAAE,CAAC,MAAM,CAAC;IAC3C,MAAM,EAAE,GAAG,IAAI,CAAC,EAAE,CAAC,MAAM,CAAC,EAAE,IAAI,MAAM,CAAQ,CAAC;IAC/C,IAAI,MAAM,GAAG,KAAK,CAAC;IAEnB,EAAE,CAAC,WAAW,CAAC,UAAU,EAAE;QAC1B,IAAI,CAAC,MAAM,EAAC;YACX,IAAI,CAAC,KAAK,EAAE,MAAM,EAAE,IAAI,CAAC,QAAQ,EAAE,CAAC,CAAC;SACrC;KACD,CAAC,CAAC;IACH,EAAE,CAAC,WAAW,CAAC,eAAe,EAAE;QAC/B,IAAI,CAAC,MAAM,EAAC;YACX,IAAI,EAAE,GAAG,IAAI,CAAC;YACd,IAAI,EAAE,CAAC,QAAQ,EAAC;gBACf,EAAE,GAAG,IAAI,CAAC,QAAQ,EAAE,CAAC;aACrB;iBAAM,IAAI,EAAE,CAAC,aAAa,EAAC;gBAC3B,EAAE,GAAG,EAAE,CAAC,aAAa,EAAE,CAAC;aACxB;YACD,IAAI,CAAC,KAAK,EAAE,MAAM,EAAE,EAAE,CAAC,CAAC;SACxB;KACD,CAAC,CAAC;IAEH,IAAI,CAAC,EAAE,CAAC,GAAG,EAAE,WAAW,EAAE;QACzB,IAAI,IAAI,GAAG,EAAE,CAAC;QACd,IAAI,MAAM,CAAC,KAAK,EAAC;YAChB,IAAI,GAAG,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,KAAK,EAAE,IAAI,CAAC,CAAC;SACzC;aAAM;YACN,MAAM,OAAO,GAAG,KAAK,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC,CAAC;YAClC,IAAI,OAAO,EAAC;gBACX,IAAI,GAAG,OAAO,CAAC,IAAI,CAAC;aACpB;SACD;QAED,IAAI,IAAI,EAAC;YACR,MAAM,GAAG,IAAI,CAAC;YACd,IAAI,EAAE,CAAC,QAAQ,IAAI,EAAE,CAAC,QAAQ,EAAE,KAAK,IAAI,EAAC;gBACzC,EAAE,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC;aAClB;iBAAM,IAAI,EAAE,CAAC,MAAM,IAAI,EAAE,CAAC,MAAM,CAAC,IAAI,CAAC,IAAI,EAAE,CAAC,aAAa,EAAE,KAAK,IAAI,EAAC;gBACtE,EAAE,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC;aAChB;YACD,MAAM,GAAG,KAAK,CAAC;SACf;KACD,CAAC,CAAC;CACH;;ACpDD,MAAM,SAAS,GAAG;IACjB,IAAI,EAAE,OAAO;IACb,KAAK,EAAE,SAAS;IAChB,MAAM,EAAE,iBAAiB;CACzB,CAAC;AAEF,MAAM,QAAQ,GAAG;IAChB,IAAI,EAAE,IAAI;IACV,KAAK,EAAE,OAAO;IACd,MAAM,EAAE,eAAe;CACvB,CAAC;AAEF,SAAgB,MAAM,CAAC,GAAY,EAAE,IAAc,EAAE,MAAW;IAE/D,IAAI,MAAM,GAAG,MAAM,CAAC;IACpB,IAAI,KAAK,GAAG,CAAC,CAAC;IACd,IAAI,OAAO,GAAG,KAAK,CAAC;IACpB,IAAI,WAAW,GAAG,MAAM,CAAC,MAAM,CAAC;IAChC,IAAI,CAAC,WAAW,IAAI,WAAW,KAAK,KAAK,EAAC;QACzC,WAAW,GAAG,IAAI,CAAC;KACnB;IACD,MAAM,KAAK,GAAG,MAAM,CAAC,KAAK,IAAI,QAAQ,CAAC;IACvC,MAAM,KAAK,GAAG,MAAM,CAAC,KAAK,IAAI,SAAS,CAAC;IAExC,IAAI,OAAO,MAAM,KAAK,QAAQ,EAAC;QAC9B,MAAM,GAAG,EAAE,MAAM,EAAC,MAAM,EAAE,CAAC;KAC3B;IAED,SAAS,OAAO,CAAC,OAAiB;QACjC,MAAM,IAAI,GAAG,IAAI,CAAC,EAAE,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC;QACpC,IAAI,IAAI,EAAE;YACT,IAAI,CAAC,OAAO,EAAC;gBACZ,OAAO,GAAG,qBAAqB;oBAC9B,MAAM;oBACN,+BAA+B;oBAC/B,KAAK,CAAC,MAAM,CAAC,GAAG,YAAY,GAAG,KAAK,CAAC,MAAM,CAAC,GAAG,QAAQ,CAAC;aACzD;YACA,IAAY,CAAC,OAAO,CAAC,OAAO,CAAC,CAAC;SAC/B;KACD;IACD,SAAS,OAAO;QACf,KAAK,EAAE,CAAC;QACR,SAAS,CAAC,MAAM,CAAC,CAAC;KAClB;IACD,SAAS,IAAI,CAAC,GAAG;QAChB,KAAK,EAAE,CAAC;QACR,SAAS,CAAC,OAAO,EAAE,GAAG,CAAC,CAAC;KACxB;IACD,SAAS,KAAK,CAAC,OAAO;QACrB,KAAK,EAAE,CAAC;QACR,SAAS,CAAC,QAAQ,CAAC,CAAC;QACpB,IAAI,OAAO,IAAI,OAAO,CAAC,IAAI,EAAC;YAC3B,OAAO,CAAC,IAAI,CAAC,OAAO,EAAE,IAAI,CAAC,CAAC;SAC5B;KACD;IACD,SAAS,SAAS;QACjB,OAAO,MAAM,CAAC;KACd;IACD,SAAS,UAAU;QAClB,IAAI,KAAK,KAAK,CAAC,EAAC;YACf,OAAO,CAAC,GAAG,CAAC,CAAC;SACb;KACD;IACD,SAAS,SAAS,CAAC,IAAI,EAAE,GAAI;QAC5B,IAAI,KAAK,GAAG,CAAC,EAAC;YACb,KAAK,GAAG,CAAC,CAAC;SACV;QAED,IAAI,IAAI,KAAK,QAAQ,EAAC;YACrB,MAAM,GAAG,QAAQ,CAAC;YAClB,OAAO,EAAE,CAAC;SACV;aAAM;YACN,OAAO,IAAI,IAAI,KAAK,OAAO,CAAC,CAAC;YAC7B,IAAI,KAAK,KAAK,CAAC,EAAC;gBACf,MAAM,GAAG,OAAO,GAAG,OAAO,GAAG,MAAM,CAAC;gBACpC,IAAI,OAAO,EAAC;oBACX,GAAG,CAAC,KAAK,CAAC,kBAAkB,EAAE,CAAC,GAAG,CAAC,YAAY,IAAI,GAAG,CAAC,CAAC,CAAC;iBACzD;qBAAM;oBACN,IAAI,WAAW,EAAC;wBACf,UAAU,CAAC,UAAU,EAAE,WAAW,CAAC,CAAC;qBACpC;iBACD;gBAED,OAAO,EAAE,CAAC;aACV;SACD;KACD;IACD,SAAS,KAAK,CAAC,IAAI;QAClB,MAAM,EAAE,GAAG,GAAG,CAAC,KAAK,CAAC,EAAE,CAAC,IAAI,CAAC,CAAC;QAC9B,IAAI,EAAE,EAAC;YACN,IAAI,CAAC,EAAE,CAAC,EAAE,EAAE,iBAAiB,EAAE,KAAK,CAAC,CAAC;YACtC,IAAI,CAAC,EAAE,CAAC,EAAE,EAAE,kBAAkB,EAAE,CAAC,GAAG,EAAE,IAAI,EAAE,QAAQ,KAAK,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAC;YACzE,IAAI,CAAC,EAAE,CAAC,EAAE,EAAE,aAAa,EAAE,OAAO,CAAC,CAAC;SACpC;KACD;IAED,GAAG,CAAC,UAAU,CAAC,QAAQ,EAAE;QACxB,SAAS;QACT,SAAS;QACT,KAAK;KACL,CAAC,CAAC;IAEH,IAAI,MAAM,CAAC,MAAM,EAAC;QACjB,IAAI,CAAC,EAAE,CAAC,GAAG,CAAC,KAAK,EAAE,cAAc,EAAE,KAAK,CAAC,CAAC;KAC1C;IAED,IAAI,MAAM,CAAC,IAAI,EAAC;QACf,IAAI,CAAC,EAAE,CAAC,GAAG,CAAC,KAAK,EAAE,cAAc,EAChC,CAAC,KAAK,EAAE,IAAI,EAAE,KAAK,EAAE,QAAQ,EAAE,QAAQ,EAAE,MAAM,EAAE,OAAO;YACvD,KAAK,CAAC,OAAO,CAAC,CAAC;SAChB,CAAC,CAAC;KACH;IAED,IAAI,MAAM,CAAC,IAAI,EAAC;QACf,KAAK,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC;KACnB;CACD;;SCpHe,KAAK,CAAC,GAAY,EAAE,KAAe,EAAE,MAAW;IAC/D,MAAM,GAAG,MAAM,IAAI,EAAE,CAAC;IACtB,MAAM,OAAO,GAAG,MAAM,CAAC,OAAO,CAAC;IAC/B,IAAI,KAAK,GAAG,OAAO;SACjB,OAAO,CAAC,GAAG,CAAC,OAAO,CAAC,IAAE,cAAc;;aAEpC,MAAM,CAAC,KAAK,IAAI,cAAc,CAAC,CAAC;IAElC,MAAM,OAAO,GAAG;QACf,QAAQ,KAAI,OAAO,KAAK,CAAC,EAAE;QAC3B,QAAQ,CAAC,IAAW,EAAE,MAAe;YACpC,MAAM,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;YAC9B,MAAM,KAAK,GAAG,QAAQ,CAAC,oBAAoB,CAAC,MAAM,CAAC,CAAC;YAEpD,KAAK,IAAI,CAAC,GAAC,CAAC,EAAE,CAAC,GAAC,KAAK,CAAC,MAAM,EAAE,CAAC,EAAE,EAAC;gBACjC,MAAM,KAAK,GAAG,KAAK,CAAC,CAAC,CAAC,CAAC,YAAY,CAAC,OAAO,CAAC,CAAC;gBAC7C,IAAI,KAAK,EAAC;oBACT,IAAI,KAAK,KAAK,IAAI,IAAI,KAAK,KAAK,KAAK,CAAC,CAAC,CAAC,EAAC;wBACxC,KAAK,CAAC,CAAC,CAAC,CAAC,QAAQ,GAAG,KAAK,CAAC;qBAC1B;yBAAM;wBACN,KAAK,CAAC,CAAC,CAAC,CAAC,QAAQ,GAAG,IAAI,CAAC;qBACzB;iBACD;aACD;YAEA,GAAG,CAAC,KAAa,CAAC,IAAI,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC;;YAEtC,GAAG,CAAC,KAAK,CAAC,IAAI,CAAC,SAAS,CAAC,QAAQ,CAAC,IAAI,EAAE,QAAQ,GAAC,KAAK,CAAC,CAAC;;YAExD,GAAG,CAAC,KAAK,CAAC,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,IAAI,EAAE,QAAQ,GAAC,IAAI,CAAC,CAAC;YAEpD,KAAK,GAAG,IAAI,CAAC;YACb,IAAI,OAAO,EAAC;gBACX,OAAO,CAAC,GAAG,CAAC,OAAO,EAAE,IAAI,CAAC,CAAC;aAC3B;YACD,IAAI,CAAC,MAAM,EAAC;gBACX,GAAG,CAAC,OAAO,EAAE,CAAC;aACd;SACD;KACD,CAAC;IAEF,GAAG,CAAC,UAAU,CAAC,OAAO,EAAE,OAAO,CAAC,CAAC;IACjC,OAAO,CAAC,QAAQ,CAAC,KAAK,EAAE,IAAI,CAAC,CAAC;CAC9B;;AC3CD,SAAS,UAAU,CAAC,IAAS,EAAE,GAAW,EAAE,KAAc;IACzD,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,KAAK,CAAC,MAAM,EAAE,CAAC,EAAE,EAAC;QACrC,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,GAAG,GAAG,CAAC,CAAC,GAAC,CAAC,CAAC,GAAG,GAAG,CAAC,CAAC,GAAC,CAAC,CAAC,CAAC,IAAI,GAAG,EAAE,CAAC;KAC/C;CACD;AAED,SAAgB,QAAQ,CAAC,GAAY,EAAE,IAAc,EAAE,MAAW;IACjE,MAAM,KAAK,GAAG,MAAM,CAAC,KAAK,IAAI,MAAM,CAAC;IACrC,MAAM,IAAI,GAAG,EAAE,CAAC;IAGhB,IAAI,CAAC,EAAE,CAAC,GAAG,EAAE,eAAe,EAAE,UAAS,OAAO,EAAE,OAAc;QAC7D,IAAI,IAAI,KAAK,OAAO,EAAC;YACpB,UAAU,CAAC,IAAI,EAAE,OAAO,CAAC,MAAM,EAAE,EAAE,KAAK,CAAC,CAAC;YAC1C,OAAO,CAAC,IAAI,CAAC,KAAK,CAAC,MAAM,GAAC,CAAC,CAAC,CAAC;SAC7B;KACD,CAAC,CAAC;IAEH,MAAM,EAAE,GAAG,IAAI,CAAC,QAAQ,CAAC;IACzB,MAAM,EAAE,GAAG,IAAI,CAAC,QAAQ,CAAC;IAEzB,IAAI,CAAC,QAAQ,GAAG,UAAS,IAAI,EAAE,KAAK,EAAE,IAAI;QACzC,MAAM,KAAK,GAAG,KAAK,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC;QAClC,IAAI,KAAK,IAAI,CAAC,EAAC;YACd,IAAI,CAAC,IAAI,CAAC,GAAG,KAAK,CAAC;YACnB,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,EAAE,EAAE,KAAK,EAAE,KAAK,GAAC,CAAC,CAAC,CAAC;YACzC,IAAI,IAAI,EAAC;gBACR,OAAO,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;aACvB;SACD;aAAM;YACN,OAAO,EAAE,CAAC,IAAI,CAAC,IAAI,EAAE,IAAI,EAAE,KAAK,EAAE,IAAI,CAAC,CAAC;SACxC;KACD,CAAC;IAEF,IAAI,CAAC,QAAQ,GAAG,UAAS,GAAG,EAAE,IAAI;QACjC,MAAM,GAAG,GAAG,IAAI,CAAC,GAAG,CAAC,CAAC;QACtB,IAAI,OAAO,GAAG,KAAK,WAAW,EAAE;YAAE,OAAO,GAAG,CAAC;SAAE;QAC/C,OAAO,EAAE,CAAC,IAAI,CAAC,IAAI,EAAE,GAAG,EAAE,IAAI,CAAC,CAAC;KAChC,CAAC;IAEF,UAAU,CAAC,IAAI,EAAE,IAAI,CAAC,MAAM,EAAE,EAAE,KAAK,CAAC,CAAC;CACvC;;SCzCe,IAAI,CAAC,GAAY,EAAE,KAAe,EAAE,MAAW;IAC9D,MAAM,GAAG,MAAM,IAAI,EAAE,CAAC;IAEtB,MAAM,KAAK,GAAG,MAAM,CAAC,KAAK,IAAI,QAAQ,CAAC;IACvC,MAAM,MAAM,GAAG,MAAM,CAAC,MAAM,IAAI,SAAS,CAAC;IAC1C,MAAM,UAAU,GAAG,MAAM,CAAC,UAAU,IAAI,GAAG,CAAC,MAAM,CAAC,KAAK,CAAC;IACzD,MAAM,WAAW,GAAG,MAAM,CAAC,WAAW,IAAI,QAAQ,CAAC;IACnD,MAAM,IAAI,GAAG,MAAM,CAAC,IAAI,IAAI,CAAC,GAAC,EAAE,GAAC,IAAI,CAAC;IACtC,MAAM,KAAK,GAAG,MAAM,CAAC,KAAK,CAAC;IAC3B,IAAI,IAAI,GAAG,MAAM,CAAC,IAAI,CAAC;IAEvB,MAAM,OAAO,GAAG;QACf,OAAO;YACN,OAAO,IAAI,CAAC;SACZ;QACD,SAAS,CAAC,MAAiB;YAC1B,IAAI,CAAC,MAAM,EAAC;gBACX,OAAO,IAAI,KAAK,IAAI,CAAC;aACrB;YAED,OAAO,KAAK,CAAC,MAAM,EAAE,CAAC,KAAK,CAAC,MAAM,IAAI,CAAC,CAAC,IAAI,CAAC,IAAI;gBAChD,IAAI,GAAG,IAAI,CAAC;aACZ,CAAC,CAAC;SACH;QACD,KAAK,CAAC,IAAW,EAAE,IAAW;YAC7B,OAAO,KAAK,CAAC,KAAK,CAAC,IAAI,EAAE,IAAI,CAAC,CAAC,IAAI,CAAC,IAAI;gBACvC,IAAI,GAAG,IAAI,CAAC;gBACZ,IAAI,CAAC,IAAI,EAAC;oBACT,MAAM,IAAI,KAAK,CAAC,eAAe,CAAC,CAAC;iBACjC;gBAED,GAAG,CAAC,SAAS,CAAC,gBAAgB,EAAE,CAAE,IAAI,CAAE,CAAC,CAAC;gBAC1C,GAAG,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;aACrB,CAAC,CAAC;SACH;QACD,MAAM;YACL,IAAI,GAAG,IAAI,CAAC;YACZ,OAAO,KAAK,CAAC,MAAM,EAAE,CAAC,IAAI,CAAC,GAAG;gBAC7B,GAAG,CAAC,SAAS,CAAC,iBAAiB,EAAC,EAAE,CAAC,CAAC;gBACpC,OAAO,GAAG,CAAC;aACX,CAAC,CAAC;SACH;KACD,CAAC;IAEF,SAAS,WAAW,CAAC,GAAG,EAAE,GAAG;QAC5B,IAAI,GAAG,KAAK,MAAM,EAAC;YAClB,OAAO,CAAC,MAAM,EAAE,CAAC;YACjB,GAAG,CAAC,QAAQ,GAAG,WAAW,CAAC;SAC3B;aAAM,IAAI,GAAG,KAAK,KAAK,IAAI,CAAC,OAAO,CAAC,SAAS,EAAE,EAAC;YAChD,GAAG,CAAC,QAAQ,GAAG,KAAK,CAAC;SACrB;KACD;IAED,GAAG,CAAC,UAAU,CAAC,MAAM,EAAE,OAAO,CAAC,CAAC;IAEhC,GAAG,CAAC,WAAW,CAAC,WAAW,EAAE,UAAS,GAAW,EAAE,MAAW,EAAE,GAAO;QACtE,IAAI,MAAM,CAAC,MAAM,IAAI,MAAM,CAAC,MAAM,CAAC,GAAG,CAAC,EAAC;YACvC,OAAO,IAAI,CAAC;SACZ;QAED,IAAI,OAAO,IAAI,KAAK,WAAW,EAAC;YAC/B,GAAG,CAAC,OAAO,GAAG,OAAO,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC,IAAI,CAAC,MAAM,WAAW,CAAC,GAAG,EAAE,GAAG,CAAC,CAAC,CAAC;SACxE;QAED,OAAO,WAAW,CAAC,GAAG,EAAE,GAAG,CAAC,CAAC;KAC7B,CAAC,CAAC;IAEH,IAAI,IAAI,EAAC;QACR,WAAW,CAAC,MAAM,OAAO,CAAC,SAAS,CAAC,IAAI,CAAC,EAAE,IAAI,CAAC,CAAC;KACjD;CACD;;ACxED;;;;AAQA,AAoBA,IAAI,KAAK,GAAI,MAAc,CAAC,KAAK,CAAC;AAClC,IAAI,KAAK,EAAC;IACT,KAAK,CAAC,KAAK,CAAC,CAAC;CACb;AAED,MAAa,OAAO,GAAG;IACtB,WAAW,EAAE,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,IAAI,EAAE,MAAM,EAAE,QAAQ;CACxD,CAAC;AAEF,MAAa,MAAM,GAAG,EAAE,iBAAiB,EAAE,CAAC;AAE5C,MAAM,CAAC,GAAG,MAAa,CAAC;AACxB,IAAI,CAAC,CAAC,CAAC,OAAO,EAAC;IACd,CAAC,CAAC,OAAO,GAAG,CAAC,CAAC,KAAK,CAAC,OAAO,CAAC;CAC5B;;;;"}